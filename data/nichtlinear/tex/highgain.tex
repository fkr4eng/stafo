
\part{Beobachterentwurf\label{part:Beobachterentwurf}}

\chapter{Beobachter mit großer Verstärkung und starke Beobachter\label{chap:High-Gain-Beobachter}}

Die in den Kapiteln~\ref{chap:regler-grundlagen} und~\ref{chap:regler-varianten}
entworfenen Rückführungen setzen in der Regel die Kenntnis des vollständigen
Systemzustands voraus. In der regelungstechnischen Praxis wird dagegen
meist nur ein Teil der Zustände messtechnisch erfasst. Dieses Kapitel
behandelt einige Ansätze für Zustandsbeobachter, mit denen aus aktuellen
Messdaten von Eingang und Ausgang der jeweilige Systemzustand asymptotisch
rekonstruiert wird. Der Hauptteil des Kapitels befasst sich mit Beobachtern,
bei denen die im System auftretenden Nichtlinearitäten durch eine
lineare Aufschaltung dominiert werden. Zusätzlich wird auf starke
Beobachter eingegangen, welche den Zustand ohne Kenntnis des Systemeingangs
schätzen.

\section{Beobachterentwurf in Originalkoordinaten}

Gegeben sei ein nichtlineares System
\begin{equation}
\dot{x}=F(x,u),\quad y=h(x)\label{eq:hg-system-nicht-affin}
\end{equation}
mit einem eingangsabhängigen Vektorfeld $F:\mathcal{M}\times\mathcal{U}\to\R^{n}$,
der offenen Menge $\mathcal{M}\subseteq\R^{n}$ und dem zulässigen
Wertebereich $\mathcal{U}\subseteq\R^{m}$ der Eingangs\-signale.
Die auf der Menge~$\mathcal{M}$ definierte Abbildung~$h$ überführt
den Zustand~$x$ in die Ausgangsgröße~$y$. Wir gehen davon aus,
dass die Zeitverläufe des Eingangs~$u$ und des Ausgangs~$y$ gemessen
werden. Die Regelung von System~(\ref{eq:hg-system-nicht-affin})
mittels Zustandsrückführung erfordert die Kenntnis des Zustands~$x$.
Da der Ausgang in der Regel eine niedrigere Dimension besitzt als
der Zustand, d.\,h. $\dim y<\dim x$, lässt sich der Zustand~$x$
nicht eindeutig durch eine Umkehrung der Abbildung~$h$ ermitteln.
Stattdessen entwirft man in Ergänzung zu der gegebenen Regelstrecke~(\ref{eq:hg-system-nicht-affin})
ein weiteres dynamisches System, den sogenannten \emph{Beobachter}\index{Beobachter}
bzw. \emph{Zustandsbeobachter} (engl. \emph{state observer}), mit
der allgemeinen Struktur
\begin{equation}
\dot{\hat{z}}=\hat{F}(\hat{z},u,y),\quad\hat{x}=\hat{H}(\hat{z},u,y).\label{eq:hg-beobachter-allgemein}
\end{equation}
Abb.~\ref{fig:beobachter-struktur} skizziert die Verknüpfung von
System und Beobachter. Der Beobachter~(\ref{eq:hg-beobachter-allgemein})
ist so zu entwerfen, dass (ggf. unter zusätzlichen Voraussetzungen
an die Anfangswerte) der geschätzte Zustand~$\hat{x}(t)$ gegen den
Systemzustand~$x(t)$ für $t\to\infty$ konvergiert. In Abhängigkeit
von der Dimension des Zustandsraums des Beobachters~(\ref{eq:hg-beobachter-allgemein})
unterscheidet man zwischen einem \emph{Identitätsbeobachter} ($\dim\hat{z}=\dim x$,
insbesondere $\hat{z}=\hat{x}$), einem \emph{reduzierten Beobachter}\index{Beobachter!reduzierter}
($\dim\hat{z}<\dim x$) sowie einem \emph{Einbettungsbeobachter}\index{Beobachter!Einbettungs-}
($\dim\hat{z}>\dim x$).

Dieser Abschnitt widmet sich dem Entwurf von Beobachtern in den Originalkoordinaten
des Systems. Das dabei entwickelte Entwurfskonzept von Beobachtern
mit großer Verstärkung wird in den Abschnitten~\ref{sec:High-Gain-Entwurf-Beobachtbarkeitsnormalform}
und~\ref{sec:High-Gain-Entwurf-Eingangs-Ausgangs-Normalform} auf
den Beobachterentwurf in den Koordinaten verschiedener Normalformen
übertragen.

\begin{figure}
\begin{centering}
\resizebox{0.6\textwidth}{!}{\input{beobachter.pdftex_t}}
\par\end{centering}
\caption{Beobachterbasierte Zustandsschätzung\label{fig:beobachter-struktur}}
\end{figure}


\subsection{High-Gain-Entwurf für unstrukturierte nichtlineare Systeme}

Dieser Abschnitt basiert auf den in~\cite{thau1973,raghavan1994,zak1990,rajamani1998}
vorgestellten Verfahren zum Beobachterentwurf. Es wird vorausgesetzt,
dass der Leser mit den Konzepten der Beobachtbarkeit und der Ermittelbarkeit
für lineare System vertraut ist~\cite{ludyk1995-2,lunze-rt2}.

Angenommen, das nichtlineare System~(\ref{eq:hg-system-nicht-affin})
lässt sich in der Form 
\begin{equation}
\dot{x}=Ax+\widetilde{F}(x,u),\quad y=Cx\label{eq:hg-system-rajamani}
\end{equation}
mit $\mathcal{M}=\R^{n}$ darstellen. Dieses System besteht aus einem
linearen Teil, der durch die Matrizen~$A$ und~$C$ beschrieben
wird, und aus einem nichtlinearen Teil mit der Abbildung~$\widetilde{F}$.
Eine derartige Aufspaltung des Differential\-gleichungs\-systems
in einen linearen und einen nichtlinearen Teil ist praktisch immer
möglich. Eine lineare Ausgangsabbildung ist in vielen Fällen anzutreffen,
insbesondere dann, wenn einige Komponenten des Zustands als Ausgangsgrößen
fungieren.

Der Beobachter besitzt die Struktur eines \emph{Luenberger-Beobachters}
(engl. \emph{Luenberger observer}), vgl.~\cite{luenberger64,luenberger66}.
Er besteht aus einer Kopie des Systems (dem sog. \textit{Simulationsterm})
und einer Aufschaltung des Ausgangsfehlers, der über eine konstante
Matrix~$L$ (der \textit{Beobachterverstärkung}) auf die Systemgleichungen
wirkt (\textit{Korrekturterm}): 
\begin{equation}
\dot{\hat{x}}=A\hat{x}+\widetilde{F}(\hat{x},u)+L(y-C\hat{x}).\label{eq:hg-beobachter-rajamani}
\end{equation}
Zur Beschreibung der Abweichung zwischen den Trajektorien von System~(\ref{eq:hg-system-rajamani})
und dem Beobachter~(\ref{eq:hg-beobachter-rajamani}) führt man den
Beobachtungsfehler $\tilde{x}=x-\hat{x}$ ein, dessen Dynamik der
Fehlerdifferentialgleichung
\begin{equation}
\begin{array}{lcl}
\dot{\tilde{x}} & = & \dot{x}-\dot{\hat{x}}\\
 & = & Ax+\widetilde{F}(x,u)-A\hat{x}-\widetilde{F}(\hat{x},u)-L(y-C\hat{x})\\
 & = & \left(A-LC\right)\tilde{x}+\widetilde{F}(x,u)-\widetilde{F}(\hat{x},u)
\end{array}\label{eq:hg-fehler-dgl-rajamani}
\end{equation}
unterliegt. Wird die Matrix~$A$ in~(\ref{eq:hg-system-rajamani})
aus der Linearisierung in einer Ruhelage $(x^{0},u^{0})$ bestimmt,
d.\,h. $A:=\tfrac{\partial}{\partial x}F(x,u)|_{(x^{0},u^{0})}$,
und die Beobachterverstärkung~$L$ über eine Eigenwertplazierung
bezüglich der Matrix $A-LC$ berechnet, dann liegt ein \emph{Arbeitspunktbeobachter}\index{Beobachter!Arbeitspunkt-}
vor, der nur lokale Konvergenz garantieren kann~\cite{rothfuss93,birk90,adamy2014}.

Bei einer global asymptotisch stabilen Ruhelage $\tilde{x}=0$ der
Fehlerdifferentialgleichung konvergiert der Beobachter global, d~h.
es gilt 
\begin{equation}
\lim_{t\to\infty}\left\Vert \hat{x}(t)-x(t)\right\Vert =0\label{eq:hg-konvergenz-rajamani}
\end{equation}
für alle Anfangswerte $x(0),\hat{x}(0)\in\R^{n}$. Die Idee des auf
Thau~\cite{thau1973} zurückgehenden Entwurfs besteht darin, den
linearen Teil in~(\ref{eq:hg-fehler-dgl-rajamani}) durch passende
Wahl der Beobachterverstärkung~$L$ so auszulegen, dass die in~(\ref{eq:hg-fehler-dgl-rajamani})
auftretenden Nichtlinearitäten von dem linearen Teil $A-LC$ dominiert
werden. Diese Dominanz des linearen Teils führt meist auf große Beobachterverstärkungen.
Daher spricht man von einem \emph{Beobachter mit großer Verstärkung}
(engl. \emph{high gain observer}). Dazu wird angenommen, dass die
Nichtlinearität~$\widetilde{F}$ höchstens einen linearen Zuwachs
aufweist. Formal bedeutet das, dass die Abbildung~$\widetilde{F}$
einer Lipschitz-Bedingung\index{Lipschitz-Bedingung}
\begin{equation}
\forall x,\hat{x}\in\R^{n},\;\forall u\in\mathcal{U}:\quad\left\Vert \widetilde{F}(x,u)-\widetilde{F}(\hat{x},u)\right\Vert \leq\rho\left\Vert x-\hat{x}\right\Vert \label{eq:hg-lipschitz-rajamani}
\end{equation}
mit der Lipschitz-Konstanten $\rho>0$ genügt. Verschiedene hinreichende
Konvergenzbedingungen und Ansätze zur Berechnung der Beobachterverstärkung~$L$
sind in~\cite{thau1973,raghavan1994,zak1990} angegeben. Eine umfassende
Charakterisierung ist in~\cite{rajamani1998} zu finden:
\begin{theorem}
\label{thm:Rajamani-hinreichend}Man betrachte das System~(\ref{eq:hg-system-rajamani})
mit dem Beobachter~(\ref{eq:hg-beobachter-rajamani}). Das lineare
Teilsystem von~(\ref{eq:hg-system-rajamani}), welches durch das
Paar $(A,C)$ beschrieben wird, sei beobachtbar\index{beobachtbar},
d.\,h. es gelte
\[
\forall s\in\C:\quad\rank\left(\begin{array}{c}
sI-A\\
C
\end{array}\right)=n.
\]
Die Nichtlinearität~$\tilde{F}$ genüge der globalen Lipschitz-Bedingung~(\ref{eq:hg-lipschitz-rajamani})
mit der Lipschitz-Konstanten $\rho>0$. Lässt sich die Beobachterverstärkung~$L$
so wählen, dass die Matrix $A-LC$ stabil ist und zusätzlich
\begin{equation}
\left\Vert \left(sI-(A-LC)\right)^{-1}\right\Vert _{\infty}<\frac{1}{\rho}\label{eq:hg-norm-rajamani}
\end{equation}
gilt, dann ist die Ruhelage $\tilde{x}=0$ der Fehlerdifferentialgleichung~(\ref{eq:hg-fehler-dgl-rajamani})
global asymptotisch stabil.
\end{theorem}

In der Bedingung~(\ref{eq:hg-norm-rajamani}) bezeichnet $\|G\|_{\infty}$
die Norm einer Übertragungsfunktion~$G$ im Hardy-Raum~$\mathcal{H}_{\infty}$
der stabilen Übertragungsfunktionen (siehe~\cite{zhou1998} und Anhang~\ref{sec:Stabilitaet-im-geschlossenen-Regelkreis}).
Satz~\ref{thm:Rajamani-hinreichend} wird an dieser Stelle nicht
bewiesen; er ergibt sich später als Folgerung aus Satz~\ref{thm:hg-strukturiert}. 

\begin{example}
\label{exa:hg-inverses-pendel}In Anlehnung an Beispiel~\ref{exa:inverses-pendel-gleichstrommotor}
betrachten wir das in Abb.~\ref{fig:inverses-mathematisches-Pendel}
dargestellte ungedämpfte mathematische Pendel mit der Länge~$\ell$
und der Masse~$m$ der Last. Der Winkel~$\theta$ gibt die Auslenkung
an. Im Aufhängepunkt wird ein zusätzliches Drehmoment~$\tau$ eingeprägt,
so dass sich das System durch die Bewegungsgleichung 
\[
m\ell^{2}\ddot{\theta}-mg\ell\sin\theta=\tau
\]
beschreiben lässt. Mit $x=(x_{1},x_{2})^{T}=(\theta,\dot{\theta})^{T}$,
$u=\tau$, $\kappa_{1}:=g/\ell$ und $\kappa_{2}:=1/(m\ell^{2})$
erhält man das Zustands\-raum\-modell 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & \kappa_{1}\sin x_{1}+\kappa_{2}u\\
y & = & x_{1},
\end{array}\label{eq:hg-inv-math-pendel}
\end{equation}
bei welchem der Winkel~$\theta$ als Ausgangs- bzw. Messgröße verwendet
wird. Das Pendelmodell~(\ref{eq:hg-inv-math-pendel}) lässt sich
in der Form~(\ref{eq:hg-system-rajamani}) mit
\[
A=\left(\begin{array}{cc}
0 & 1\\
0 & 0
\end{array}\right),\quad C=\left(\begin{array}{cc}
1 & 0\end{array}\right),\quad\widetilde{F}(x,u)=\left(\begin{array}{c}
0\\
\kappa_{1}\sin x_{1}+\kappa_{2}u
\end{array}\right)
\]
darstellen. Die Nichtlinearität~$\widetilde{F}$ besitzt die Lipschitz-Konstante
$\rho=\kappa_{1}$. Mit der Beobachterverstärkung $L=(a_{1},a_{0})^{T}$
erhält man das charakteristische Polynom
\[
\det(sI-(A-LC))=s^{2}+a_{1}s+a_{0},
\]
so dass die Matrix $A-LC$ für $a_{0},a_{1}>0$ stabil ist. In der
gebrochen\-rationalen Matrix
\[
\left(sI-(A-LC)\right)^{-1}=\left(\begin{array}{cc}
s+a_{1} & -1\\
a_{0} & s
\end{array}\right)^{-1}=\frac{1}{s^{2}+a_{1}s+a_{0}}\left(\begin{array}{cc}
s & 1\\
-a_{0} & s+a_{1}
\end{array}\right)
\]
geht der linke untere Eintrag für $s\to0$ gegeben der Wert $\tfrac{a_{0}}{a_{0}}=1$.
Für die Verstärkung~(\ref{eq:hg-norm-rajamani}) gilt somit $\|\cdot\|_{\infty}\geq1$,
so dass die strikte Ungleichung~(\ref{eq:hg-norm-rajamani}) für
$\kappa_{1}\geq1$ nicht erfüllt ist. Satz~\ref{thm:Rajamani-hinreichend}
ist dann nicht anwendbar. 
\end{example}
\begin{figure}
\begin{centering}
\scalebox{1.5}[1.5]{\input{inv_pendel.pdftex_t}}
\par\end{centering}
\caption{Inverses mathematisches Pendel\label{fig:inverses-mathematisches-Pendel}}
\end{figure}


\subsection{High-Gain-Entwurf für strukturierte nichtlineare Systeme}

Die in System~(\ref{eq:hg-system-rajamani}) auftretende Nichtlinearität~$\widetilde{F}$
kann von allen Zuständen abhängen und alle Komponenten der Differentialgleichung
beeinflussen. In der Praxis werden die Nichtlinaeritäten nur von bestimmen
Variablen abhängen und nur in einigen Komponenten des Differentialgleichungssytems~(\ref{eq:hg-system-rajamani})
auftreten. Beschreibt man diese Abhängigkeiten durch geeignet gewählte
Matrizen~$B$ und~$D$, dann kann man die nichtlineare Abbildung~$\widetilde{F}$
folgendermaßen darstellen:
\begin{equation}
\widetilde{F}=B\bar{F}(Dx,u).\label{eq:F-strukturiert}
\end{equation}
Setzt man~(\ref{eq:F-strukturiert}) in Gl.~(\ref{eq:hg-fehler-dgl-rajamani})
ein, so erhält man die zugehörige Fehlerdifferentialgleichung
\begin{equation}
\dot{\tilde{x}}=\left(A-LC\right)\tilde{x}+B\left[\bar{F}(Dx,u)-\bar{F}(D\hat{x},u)\right].\label{eq:hg-fehler-dgl-strukturiert}
\end{equation}
Unter der Annahme~(\ref{eq:hg-lipschitz-rajamani}) genügt auch die
Abbildung~$\bar{F}$ einer Lipschitz-Bedingung\index{Lipschitz-Bedingung}
\begin{equation}
\forall z,\hat{z}\in\im\,D,\;\forall u\in\mathcal{U}:\quad\left\Vert \bar{F}(z,u)-\bar{F}(\hat{z},u)\right\Vert \leq\bar{\rho}\left\Vert z-\hat{z}\right\Vert \label{eq:hg-lipschitz-strukturiert}
\end{equation}
mit der Lipschitz-Konstanten $\bar{\rho}>0$. Durch passende Wahl
der Matrizen~$B$ und~$D$ lassen sich auch unterschiedlich stark
ausgeprägte Nichtlinearitäten hinsichtlich der Lipschitz-Konstanten
aufeinander abgleichen. In Analogie zu Satz~\ref{thm:hg-strukturiert}
ist im Fall einer durch Gl.~(\ref{eq:F-strukturiert}) strukturierten
Nichtlinearität folgende Konvergenzaussage möglich~\cite{roebenack2012ssd,roebenack2014pamm,roebenack2016sac}:
\begin{theorem}
\label{thm:hg-strukturiert}Man betrachte das System~(\ref{eq:hg-system-rajamani})
mit dem Beobachter~(\ref{eq:hg-beobachter-rajamani}) und einer Nichtlinearität
in der Form~(\ref{eq:F-strukturiert}). Das lineare Teilsystem von~(\ref{eq:hg-system-rajamani}),
welches durch das Paar $(A,C)$ beschrieben wird, sei ermittelbar\footnote{Ein lineares System ist ermittelbar, wenn es bezüglich der instabilen
Eigenmodi beobachtbar ist. Hinsichtlich einer Kalman-Zerlegung nach
Beobachtbarkeit bedeutet das, dass das nicht beobachtbare Teilsystem
asymptotisch stabil ist~\cite{ludyk1995-2,lunze-rt2}.}\index{ermittelbar} (engl. \emph{detectable}), d.\,h. es gelte
\[
\forall s\in\C,\;\Re(s)\geq0:\quad\rank\left(\begin{array}{c}
sI-A\\
C
\end{array}\right)=n.
\]
Die Nichtlinearität~$\bar{F}$ genüge der globalen Lipschitz-Bedingung~(\ref{eq:hg-lipschitz-strukturiert})
mit der Lipschitz-Konstanten $\bar{\rho}>0$. Lässt sich die Beobachterverstärkung~$L$
so wählen, dass die Matrix $A-LC$ stabil ist und zusätzlich
\begin{equation}
\left\Vert D\left(sI-(A-LC)\right)^{-1}B\right\Vert _{\infty}<\frac{1}{\bar{\rho}}\label{eq:hg-norm-strukturiert}
\end{equation}
gilt, dann ist die Ruhelage $\tilde{x}=0$ der Fehlerdifferentialgleichung~(\ref{eq:hg-fehler-dgl-strukturiert})
global asymptotisch stabil.

\end{theorem}
\begin{proofsketch}Die Annahmen von Satz~\ref{thm:hg-strukturiert}
seien erfüllt. Mit der Ungleichung~(\ref{eq:hg-norm-strukturiert})
besitzt die \emph{algebraische Riccati-Ungleichung}\index{Riccati-Ungleichung}
(engl. \emph{algebraic Riccati inequality})
\begin{equation}
(A-LC)^{T}P+P(A-LC)+\bar{\rho}^{2}PBB^{T}P+D^{T}D\prec0\label{eq:hg-ARI}
\end{equation}
eine positiv definite Lösung $P=P^{T}\succ0$ (siehe Anhang~\ref{sec:Stabilitaet-im-geschlossenen-Regelkreis}).
Für die Stabilitätsuntersuchung setzen wir als mögliche Ljapunov-Funktion
die quadratische Form 
\[
V(\tilde{x})=\tilde{x}^{T}P\tilde{x}
\]
mit der Matrix~$P$ an. Damit ist die Funktion~$V$ global positiv
definit. Unter Beachtung der Lipschitz-Bedingung~(\ref{eq:hg-lipschitz-strukturiert})
und der Ungleichung~(\ref{eq:hg-ARI}) erhält man für die Zeitableitung
entlang~(\ref{eq:hg-fehler-dgl-strukturiert}) die Abschätzung
\[
\dot{V}(\tilde{x})\leq\tilde{x}^{T}\left[(A-LC)^{T}P+P(A-LC)+\bar{\rho}^{2}PBB^{T}P+D^{T}D\right]\tilde{x}<0
\]
für alle $\tilde{x}\neq0$. Damit ist die Ruhelage $\tilde{x}=0$
der Fehlerdifferentialgleichung~(\ref{eq:hg-fehler-dgl-strukturiert})
global asymptotisch stabil.\end{proofsketch}

Das Fehlersystem~(\ref{eq:hg-fehler-dgl-strukturiert}) kann man
auch als Kombination eines linearen Systems mit der Übertragungsfunktion
\begin{equation}
G(s)=D\left(sI-(A-LC)\right)^{-1}B\label{eq:hg-G-strukturiert}
\end{equation}
und einer zeitvarianten Nichtlinearität
\begin{equation}
\Delta\widetilde{F}(\tilde{z},t):=\bar{F}(z,t)-\bar{F}(\hat{z},t)\label{eq:Delta-F-strukturiert}
\end{equation}
auffassen (Abb.~\ref{fig:Strukturierte-Fehlerdynamik}). Bedingt
durch~(\ref{eq:hg-lipschitz-strukturiert}) genügt auch die Nichtlinearität~(\ref{eq:Delta-F-strukturiert})
einer Lipschitz-Bedingung mit der Lipschitz-Konstanten~$\bar{\rho}$.
Mit~(\ref{eq:hg-norm-strukturiert}) ist die Verstärkung des linearen
Teils~(\ref{eq:hg-G-strukturiert}) im Sinne der $\mathcal{H}_{\infty}$-Norm
nicht größer als $1/\bar{\rho}$, so dass die Gesamtverstärkung des
offenen Kreises kleiner als Eins ist. Der Satz von der kleinen Kreisverstärkung\index{Satz!von der kleinen Kreisverstärkung}
garantiert dann die Stabilität des geschlossenen Kreises (siehe Anhang~\ref{sec:Stabilitaet-im-geschlossenen-Regelkreis}).

\begin{figure}
\begin{centering}
\resizebox{0.98\textwidth}{!}{\input{high-gain-struktur.pdftex_t}}
\par\end{centering}
\caption{Struktur der Fehlerdynamik~(\ref{eq:hg-fehler-dgl-strukturiert})\label{fig:Strukturierte-Fehlerdynamik}}
\end{figure}

Ein beobachtbares lineares System ist auch ermittelbar. Mit $D=B=I$
ergibt sich Satz~\ref{thm:Rajamani-hinreichend} als Folgerung aus
Satz~\ref{thm:hg-strukturiert}. Das nachfolgende Beispiel zeigt,
dass man durch eine Berücksichtigung der Struktur entsprechend Gl.~(\ref{eq:F-strukturiert})
in etlichen Fällen die Existenzbedingungen abschwächen kann:

\begin{example}
\label{exa:hg-inverses-pendel-struktur}Beim inversen Pendel aus Beispiel~\ref{exa:hg-inverses-pendel}
hängt die Nichtlinearität $\widetilde{F}(x,u)$ neben~$u$ nur von~$x_{1}$
ab und beeinflusst nur die zweite Komponente der Differentialgleichung~(\ref{eq:hg-inv-math-pendel}).
Daraus ergibt sich die Struktur~(\ref{eq:F-strukturiert}) mit
\[
B=\left(\begin{array}{c}
0\\
1
\end{array}\right),\quad D=\left(\begin{array}{cc}
1 & 0\end{array}\right),\quad\bar{F}(z,u)=\kappa_{1}\sin z+\kappa_{2}u
\]
und der Lipschitz-Konstanten $\bar{\rho}=\kappa_{1}$. Für den linearen
Teil erhält man die Übertragungsfunktion
\[
G(s)=\frac{1}{s^{2}+a_{1}s+a_{0}}
\]
eines $PT_{2}$-Gliedes, welches für $a_{0},a_{1}>0$ stabil ist.
Vermeidet man durch passende Eigenwertvorgabe eine Resonanzerhöhung,
so gilt $\|G\|_{\infty}=\tfrac{1}{a_{0}}.$ Für $a_{0}>\bar{\rho}$
ist die Bedingung~(\ref{eq:hg-norm-strukturiert}) erfüllt. Dieses
Ziel lässt sich beispielsweise mit einem reellen Doppelpol $s_{1,2}<-\sqrt{\kappa_{1}}$
erreichen. Satz~\ref{thm:hg-strukturiert} garantiert dann die globale
Konvergenz des High-Gain-Beobachters.
\end{example}

\begin{remark}
\label{rem:High-Gain-Beobachter-LMI}Beim Beobachterentwurf ist die
Riccati-Ungleichung~(\ref{eq:hg-ARI}) simultan bezüglich der Variablen
$P\succ0$ und~$L$ zu lösen. In der gegebenen Form~(\ref{eq:hg-ARI})
ist die Ungleichung nichtlinear. Die bilinearen Terme $PL$ und $L^{T}P^{T}$
lassen sich mit der Substitution $Y=PL$ beseitigen. Damit erhält
man die Ungleichung 
\[
A^{T}P+PA-C^{T}Y^{T}-YC+\bar{\rho}^{2}PBB^{T}P+D^{T}D\prec0.
\]
Den quadratischen Term $PBB^{T}P$ kann man mit Hilfe des Schur-Komplements\index{Schur-Komplement}
eliminieren~\cite{boyd1994}, so dass man auf die \emph{lineare Matrix\-ungleichung}
(engl. \emph{linear matrix inequality}, kurz \emph{LMI}\index{LMI})
\begin{equation}
\left(\begin{array}{cc}
-A^{T}P-PA+C^{T}Y^{T}+YC-D^{T}D & \bar{\rho}PB\\
\bar{\rho}B^{T}P & I
\end{array}\right)\succ0,\quad P\succ0\label{eq:hg-LMI}
\end{equation}
geführt wird, die bezüglich~$P$ und~$Y$ zu lösen ist. Die gesuchte
Beobachterverstärkung ergibt sich aus $L=P^{-1}Y$. Zum numerischen
Lösen der Ungleichung~(\ref{eq:hg-LMI}) existieren Routinen für
\textsc{Matlab}~\cite{gahinet1995} und \textsc{Scilab}~\cite{nikoukhah1995}.
\end{remark}

\begin{remark}
Anstelle einer konstanten und damit statischen Beobachterverstärkung
kann man auch eine dynamische Beobachterverstärkung einsetzen~\cite{pertew2005ifac,pertew2006}.
Damit erhält man einen Beobachter, dessen Zustandsraum eine höhere
Dimension als das zu beobachtende System aufweist. Eine gegenüber~(\ref{eq:F-strukturiert})
noch detailliertere Berücksichtigung der Struktur der im System auftretenden
Nichtlinearitäten ist mit dem in~\cite{franke2016pamm} beschriebenen
Zugang möglich, der konzeptionell auf dem in der robusten Regelung
verwendeten strukturierten Singulärwert aufbaut~\cite[Kap.~10]{zhou1998}.
\end{remark}

\section{Beobachterentwurf auf Basis der Beobachtbarkeitsnormalform\label{sec:High-Gain-Entwurf-Beobachtbarkeitsnormalform}}

\subsection{Nichtunterscheidbarkeit und Beobachtbarkeit für autonome Systeme\label{subsec:Beobachtbarkeit-autonom}}

Um das Konzept der Beobachtbarkeit für nichtlineare Systeme einzuführen
betrachten wir zunächst das autonome System 
\begin{equation}
\dot{x}=f(x),\quad y=h(x)\label{eq:hg-system-autonom}
\end{equation}
mit einem Vektorfeld $f:\mathcal{M}\to\R^{n}$ und einem Skalarfeld
$h:\mathcal{M}\to\R$. Beide Felder seien hinreichend glatt und auf
einer offenen Menge $\mathcal{M}\subseteq\R^{n}$ definiert. Zusätzlich
bezeichne~$\varphi_{t}$ den Fluss des Vektorfeldes~$f$.

Die nachfolgenden Betrachtungen orientieren sich an~\cite{hermann1977}.
Sei $T>0$. Zwei Zustände $p,\bar{p}\in\mathcal{M}$ heißen \emph{nicht
unterscheidbar}\index{Nichtunterscheidbarkeit} (engl. \emph{indistinguishable})
auf dem Intervall $[0,T]$, wenn die zugehörigen Verläufe der Ausgänge
übereinstimmen, d.\,h.
\begin{equation}
\forall t\in[0,T]:\quad h(\varphi_{t}(p))=h(\varphi_{t}(\bar{p})).\label{eq:Nichtunterscheidbarkeit}
\end{equation}
Andernfalls heißen die Zustände \emph{unterscheidbar} (siehe Abb.~\ref{fig:Unterscheidbarkeit}).

\begin{figure}
\begin{centering}
\resizebox{0.8\textwidth}{!}{\input{unterscheidbarkeit1.pdftex_t}}
\par\end{centering}
\caption{Auf dem Zeitintervall $[0,T]$ unterscheidbare Zustände $p,\bar{p}\in\mathcal{M}$\label{fig:Unterscheidbarkeit}}

\end{figure}

Bedingung~(\ref{eq:Nichtunterscheidbarkeit}) definiert auf der Menge~$\mathcal{M}$
eine Äquivalenzrelation\footnote{Eine \emph{Äquivalenzrelation} auf einer Menge~$\mathcal{M}$ ist
eine Teilmenge $\mathcal{R}\subseteq\mathcal{M}\times\mathcal{M}$
mit $(p,p)\in\mathcal{R}$ (Reflexivität), $(p,\bar{p})\in\mathcal{R}\Rightarrow(\bar{p},p)\in\mathcal{R}$
(Symmetrie) und $(p,\bar{p})\in\mathcal{R}\wedge(\bar{p},v)\in\mathcal{R}\Rightarrow(p,v)\in\mathcal{R}$
(Transitivität) für alle $p,\bar{p},v\in\mathcal{M}$. Zwei Elemente
$p,\bar{p}\in\mathcal{M}$ nennt man \emph{äquivalent}, wenn $(p,\bar{p})\in\mathcal{R}$.
Notation: $p\sim\bar{p}$.} $p\sim\bar{p}$. Die Menge der Punkte, die von~$p$ nicht unterscheidbar
(und damit zu~$p$ äquivalent) sind, sei mit $\mathcal{I}(p):=\left\{ \bar{p}\in\mathcal{M};\,p\sim\bar{p}\right\} $
bezeichnet. Ein System~(\ref{eq:hg-system-autonom}) heißt \emph{global
beobachtbar}\index{beobachtbar} (engl. \emph{globally observable}),
wenn 
\[
\forall p\in\mathcal{M}:\quad\mathcal{I}(p)=\{p\}.
\]
Das bedeutet, dass der einzige Zustand, der von~$p$ nicht unterscheidbar
ist, der Punkt~$p$ selber ist. Anders formuliert: Alle (verschiedenen)
Zustände sind (voneinander) unterscheidbar. Wir nennen das System~(\ref{eq:hg-system-autonom})
\emph{lokal beobachtbar im Punkt $p\in\mathcal{M}$}, wenn es eine
Umgebung $\mathcal{U}\subseteq\mathcal{M}$ von~$p$ mit 
\[
\mathcal{U}\cap\mathcal{I}(p)=\{p\}
\]
gibt. Das System heißt \emph{lokal beobachtbar}\index{beobachtbar}
(engl. \emph{locally observable}), wenn es in allen Punkten $p\in\mathcal{M}$
lokal beobachtbar ist. 

Alle Zustände aus einer Umgebung eines Punktes $p\in\mathcal{M}$
sind genau dann unterscheidbar, wenn die Zuordnung 
\begin{equation}
\Upsilon:p\mapsto\left.h(\varphi_{t}(p))\right|_{[0,T]}\label{eq:hg-unterscheidbarkeit-funktion}
\end{equation}
injektiv\index{Abbildung!injektive} ist. Sind die Felder~$f$ und~$h$
des Systems~(\ref{eq:hg-system-autonom}) analytisch, dann ist die
Ausgangskurve analytisch und kann in eine konvergente Taylorreihe
entwickelt werden
\[
y(t)=h(\varphi_{t}(p))=\sum_{i=0}^{\infty}L_{f}^{i}h(p)\frac{t^{i}}{i!},
\]
die man auch als Lie-Reihe\index{Lie-Reihe} bezeichnet (vgl. Abschnitt~\ref{subsec:Lie-Ableitung-Skalarfeld}).
Bei der Untersuchung der Injektivität geht man dabei von der Abbildung
in einen Funktionenraum nach Gl.~(\ref{eq:hg-unterscheidbarkeit-funktion})
zu einer Abbildung
\begin{equation}
p\mapsto\left(L_{f}^{i}h(p)\right)_{i=0}^{\infty}\label{eq:hg-unterscheidbarkeit-folge}
\end{equation}
in den Folgenraum~$\R^{\infty}$ über. Da der Definitionsbereich~$\mathcal{M}$
eine Teilmenge des Vektorraums~$\R^{n}$ ist, kann der von den Abbildungen~(\ref{eq:hg-unterscheidbarkeit-funktion})
bzw.~(\ref{eq:hg-unterscheidbarkeit-folge}) aufgespannte Bildbereich
topologisch höchstens die Dimension~$n$ besitzen. Damit lässt sich
der Bildbereich von~(\ref{eq:hg-unterscheidbarkeit-folge}) durch
(maximal) $n$ Komponenten $L_{f}^{i}h$ parametrieren. Sind die Gradienten
$\d L_{f}^{i}h$ von $n$ derartigen Komponenten linear unabhängig,
dann ist die Abb.~(\ref{eq:hg-unterscheidbarkeit-folge}) in einer
Umgebung von~$p$ injektiv (Anwendung des Satzes über die implizite
Abbildung bzw. des Satzes über die Umkehrabbildung, vgl. Satz~\ref{thm: Umkehrfunktion}).
Damit sind in einer geeigneten Umgebung von~$p$ verschiedene Zustände
unterscheidbar und das System ist im Punkt~$p$ lokal beobachtbar.
Da im Vorfeld nicht bekannt ist, welche Gradienten linear unabhängig
sind, erfassen wir in der Kodistribution 
\begin{equation}
\Omega(p):=\spann\left\{ \d L_{j}^{i}h(p);\;i=0,1,2,\ldots\right\} \label{eq:Beobachtbarkeit-Kodistribution}
\end{equation}
die lineare Hülle aller Gradienten. Gilt
\begin{equation}
\dim\Omega(p)=n,\label{eq:Beobachtbarkeitsrangbedingung}
\end{equation}
dann ist das System~(\ref{eq:hg-system-autonom}) im Punkt~$p$
lokal beobachtbar. Ist die sog. \emph{Beobachtbarkeitsrangbedingung}\index{Beobachtbarkeitsrangbedingung}~(\ref{eq:Beobachtbarkeitsrangbedingung})
(engl. \emph{observability rank condition}) für alle $p\in\mathcal{M}$
erfüllt, dann ist das System (überall) lokal beobachtbar. 

\begin{example}
\label{exa:Beobachtbarkeit-linear-autonom}Das lineare System
\[
\dot{x}=Ax,\quad y=c^{T}x
\]
stellt wegen $f(x)=Ax$, $h(x)=c^{T}x$ mit $A\in\R^{n\times n}$
und $c\in\R^{n}$ einen Spezialfall von System~(\ref{eq:hg-system-autonom})
dar. Mit $\d L_{f}^{i}h(x)=c^{T}A^{i}$ für $i\in\NN$ (vgl. Beispiel~\ref{exa:Lie-linear-gradient})
besitzt die Kodistribution~(\ref{eq:Beobachtbarkeit-Kodistribution})
die Form 
\begin{equation}
\Omega=\spann\left\{ c^{T},\,c^{T}A,\,c^{T}A^{2},\,\ldots,\,c^{T}A^{i},\,\ldots\right\} .\label{eq:Beobachtbarkeit-Kodistr-Linear1}
\end{equation}
Nach dem Satz von Cayley-Hamilton\index{Satz!von Cayley-Hamilton}
erfüllt jede quadratische Matrix (formal) ihre eigene charakteristische
Gleichung~\cite{gantmacher86,beutelspacher2001}. Daraus folgt unmittelbar,
dass die Matrixpotenzen $A^{n},A^{n+1},\ldots$ von den Matrizen $I,A,\ldots,A^{n-1}$
linear abhängig sind, d.\,h. $A^{i}\in\spann\{I,A,\ldots,A^{n-1}\}$
für $i\geq n$. Als Konsequenz wird die Distribution~(\ref{eq:Beobachtbarkeit-Kodistr-Linear1})
bereits von den ersten $n$ Kovektoren aufgespannt:
\begin{equation}
\Omega=\spann\left\{ c^{T},\,c^{T}A,\,c^{T}A^{2},\,\ldots,\,c^{T}A^{n-1}\right\} .\label{eq:Beobachtbarkeit-Kodistr-Linear2}
\end{equation}
Die Beobachtbarkeitsrangbedingung~(\ref{eq:Beobachtbarkeitsrangbedingung})
lässt sich in diesem Fall durch 
\[
\rank\,Q_{B}\stackrel{!}{=}n\quad\text{mit}\quad Q_{B}:=\left(\begin{array}{c}
c^{T}\\
c^{T}A\\
\vdots\\
c^{T}A^{n-1}
\end{array}\right)
\]
prüfen. Die dabei auftretende Matrix~$Q_{B}$ ist die Beobachtbarkeitsmatrix\index{Beobachtbarkeitsmatrix}
nach Kalman~\cite{lunze-rt2}.
\end{example}

Der Satz von Cayley-Hamilton\index{Satz!von Cayley-Hamilton} kann
nicht unmittelbar auf nichtlineare Systeme übertragen werden. Damit
ist nicht klar, bis zu welcher Ordnung~$N$ die Lie-Ableitungen~$L_{f}^{i}h(x)$
für $0\leq i\leq N-1$ in die Beobachtbarkeitsanalyse einbezogen werden
müssen. Betrachtet man Systeme~(\ref{eq:hg-system-autonom}) mit
analytischen Feldern~$f,h$, dann ist die an~(\ref{eq:hg-unterscheidbarkeit-folge})
angelehnte Abbildung 
\begin{equation}
x\mapsto\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
\cdots\\
L_{f}^{N-1}h(x)
\end{array}\right)\label{eq:Beobachtbarkeitsabbildung-allgemein}
\end{equation}
mit $N=2n+1$ für \textit{fast alle}\footnote{Gilt eine Eigenschaft für alle Elemente einer offenen und dichten
Teilmenge $\mathcal{A}\subseteq\mathbb{M}$ eines metrischen Raumes~$\mathbb{M}$,
so sagt man, die Eigenschaft gilt für \emph{fast alle} Elemente von~$\mathbb{M}$.
Die Teilmenge~$\mathcal{A}$ ist dann von \emph{zweiter Kategorie}
im Sinne von Baire~\cite{goepfert2009}.} analytischen Systeme injektiv~\cite{gauthier91}. In Anlehnung an
den in Beispiel~\ref{exa:Beobachtbarkeit-linear-autonom} beschriebenen
Fall linearer zeitinvarianter Systeme berücksichtigen viele Verfahren
zum Beobachterentwurf die Abb.~(\ref{eq:Beobachtbarkeitsabbildung-allgemein})
nur für $N=n$. Die Abbildung~(\ref{eq:Beobachtbarkeitsabbildung-allgemein})
geht dann in die \emph{Beobachtbarkeitsabbildung}\index{Beobachtbarkeitsabbildung}
(engl. \emph{observability map}) 
\begin{equation}
q(x):=\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
\cdots\\
L_{f}^{n-1}h(x)
\end{array}\right)\label{eq:Beobachtbarkeitsabbildung}
\end{equation}
mit $q:\mathcal{M}\to\R^{n}$ über. Die zugehörige Jacobimatrix 
\begin{equation}
Q_{B}(x):=\d q(x)=\left(\begin{array}{c}
\d h(x)\\
\d L_{f}h(x)\\
\cdots\\
\d L_{f}^{n-1}h(x)
\end{array}\right)\label{eq:Beobachtbarkeitsmatrix}
\end{equation}
nennt man \emph{Beobachtbarkeitsmatrix}\index{Beobachtbarkeitsmatrix}
(engl. \emph{observability matrix}). Alg.~\ref{alg:Berechnung-Beobachtbarkeitsmatrix}
zeigt eine einfache \textsc{Maxima}-Implementierung zur Berechnung
der Beobachtbarkeitsabbildung zusammen mit der Beobachtbarkeitsmatrix.
Dabei wird auf die in Alg.~\ref{alg:Lie-Ableitung-Skalar} angegebene
Routine \texttt{LieScalar} zurückgegriffen.

\begin{algorithm}
\input{Observability_Matrix.tex}

\caption{Berechnung von Beobachtbarkeitsabbildung und -matrix mit \textsc{Maxima}\label{alg:Berechnung-Beobachtbarkeitsmatrix}}
\end{algorithm}

Mit Hilfe der Beobachtbarkeitsmatrix~(\ref{eq:Beobachtbarkeitsmatrix})
lässt sich eine leicht anzuwendende hinreichende Bedingung für lokale
Beobachtbarkeit\footnote{Globale Beobachtbarkeit ist wesentlich schwerer zu prüfen~\cite{tibken2004cdc,bartosiewicz1995local}.}
angeben: 
\begin{lemma}
\label{lem:Beobachtbarkeit-hinreichende-Bedingung}Man betrachte System~(\ref{eq:hg-system-autonom}). 
\begin{enumerate}
\item Gilt $\rank\,Q_{B}(p)=n$ in einem Punkt $p\in\mathcal{M}$, dann
ist das System~(\ref{eq:hg-system-autonom}) lokal beobachtbar im
Punkt~$p$.
\item Gilt $\rank\,Q_{B}(p)=n$ für alle Punkte $p\in\mathcal{M}$, dann
ist das System~(\ref{eq:hg-system-autonom}) lokal beobachtbar.
\end{enumerate}
\end{lemma}
\begin{svmultproof2}
Im Punkt $p\in\mathcal{M}$ gelte $\rank\,Q_{B}(p)=n$, d.\,h. die
Jacobimatrix der Beobachtbarkeitsabbildung ist im Punkt~$p$ regulär.
Nach dem Satz über die Umkehrfunktion ist die Abbildung~$q$ ein
lokaler Diffeomorphismus. In einer geeigneten Umgebung von~$p$ ist~$q$
folglich bijektiv und somit insbesondere injektiv. Damit ist das System~(\ref{eq:hg-system-autonom})
im Punkt~$p$ lokal beobachtbar. Gilt $\rank\,Q_{B}(p)=n$ für alle
$p\in\mathcal{M}$, dann ist das System~(\ref{eq:hg-system-autonom})
lokal beobachtbar.
\end{svmultproof2}


\subsection{Beobachterentwurf für autonome Systeme\label{subsec:Beobachterentwurf-autonom}}

Dieser Abschnitt widmet sich dem Entwurf von High-Gain-Beobachtern
für autonome Systeme der Form~(\ref{eq:hg-system-autonom}). Der
vorgestellte Entwurfsansatz basiert auf~\cite{gauthier92,ciccarella93,dalla-mora1997}.
\begin{theorem}
\label{thm:hg-beobachtbarkeitsnormalform}Man betrachte das System~(\ref{eq:hg-system-autonom})
in einem Punkt $p\in\mathcal{M}$. Gilt $\rank\,Q_{B}(p)=n$, dann
ist die Beobachtbarkeitsabbildung ein lokaler Diffeomorphismus, der
das System~(\ref{eq:hg-system-autonom}) in die \emph{Beobachtbarkeitsnormalform}\index{Beobachtbarkeitsnormalform}\index{Normalform!Beobachtbarkeits-}
(engl. \emph{observability canonical form})
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}\\
\dot{\xi}_{n} & = & \alpha(\xi)\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+b\alpha(\xi)\\
y & = & c^{T}\xi
\end{array}\label{eq:Beobachtbarkeits-NF-autonom}
\end{equation}
überführt.
\end{theorem}
Der Beweis erfolgt ähnlich wie bei der Eingangs-Ausgangs-, der Byrnes-Isidori-
bzw. der Regelungsnormalform (vgl. Kapitel~\ref{chap:regler-grundlagen}).
\begin{svmultproof2}
Es gelte $\rank\,Q_{B}(p)=n$. Nach Lemma~\ref{lem:Beobachtbarkeit-hinreichende-Bedingung}
ist die Beobachtbarkeitsabbildung $\xi=q(x)$ in einer Umgebung des
Punktes~$p$ ein lokaler Diffeomorphismus. Die transformierten Koordinaten
sind durch $\xi_{i}=q_{i}(x)=L_{f}^{i-1}h(x)$ für $i=1,\ldots,n$
definiert. Dadurch gilt
\[
\begin{array}{lcl}
\dot{\xi}_{i} & = & \frac{\d}{\d t}\xi_{i}\\
 & = & \frac{\d}{\d t}q_{i}(x)\\
 & = & \frac{\d}{\d t}L_{f}^{i-1}h(x)\\
 & = & \d L_{f}^{i-1}h(x)\cdot\dot{x}\\
 & = & \d L_{f}^{i-1}h(x)\cdot f(x)\\
 & = & L_{f}^{i}h(x)\\
 & = & \left\{ \begin{array}{lcl}
\xi_{i+1} & \text{für} & i=1,\ldots n-1\\
\alpha(\xi) & \text{für} & i=n
\end{array}\right.
\end{array}
\]
mit $\alpha(\xi):=L_{f}^{n}h(q^{-1}(\xi))$.
\end{svmultproof2}

In den transformierten Koordinaten beinhaltet der Beobachter eine
Kopie des Systems. Zusätzlich wird über die konstante Beobachterverstärkung
$l\in\R^{n}$ der Ausgangsfehler aufgeschaltet:
\begin{equation}
\dot{\hat{\xi}}=A\hat{\xi}+b\alpha(\hat{\xi})+l\cdot(y-\hat{\xi}_{1}).\label{eq:hg-beobachter-autonom-trans}
\end{equation}

Der Beobachtungsfehler $\tilde{\xi}:=\xi-\hat{\xi}$ zwischen dem
System~(\ref{eq:Beobachtbarkeits-NF-autonom}) und dem Beobachter~(\ref{eq:hg-beobachter-autonom-trans})
führt auf die Fehlerdifferentialgleichung
\begin{equation}
\begin{array}{ccl}
\dot{\tilde{\xi}} & = & \dot{\xi}-\dot{\hat{\xi}}\\
 & = & A\xi+b\alpha(\xi)-A\hat{\xi}-b\alpha(\hat{\xi})-l\cdot(\xi_{1}-\hat{\xi}_{1})\\
 & = & \left(A-lc^{T}\right)\tilde{\xi}+b\left(\alpha(\xi)-\alpha(\hat{\xi})\right).
\end{array}\label{eq:hg-fehlerdyn}
\end{equation}
Mit der Beobachterverstärkung $l=(a_{n-1},\ldots,a_{0})^{T}$ erhält
man für den linearen Teil das charakteristische Polynom
\begin{equation}
\begin{array}{crl}
\CP(s) & := & \det(sI-(A-lc^{T}))\\
 & = & a_{0}+a_{1}s+\cdots+a_{n-1}s^{n-1}+s^{n}\\
 & = & (s-s_{1})\cdots(s-s_{n}),
\end{array}\label{eq:hg-cp}
\end{equation}
welches man aus vorgegebenen Eigenwerten $s_{1},\ldots,s_{n}$ mit
jeweils negativem Realteil ermittelt.

Zur Darstellung des Beobachters~(\ref{eq:hg-beobachter-autonom-trans})
in Originalkoordinaten wenden wir die durch die Beobachtbarkeitsabbildung~$q$
gegebene Transformation 
\[
\dot{\hat{\xi}}=\frac{\d}{\d t}\hat{\xi}=\frac{\d}{\d t}q(\hat{x})=\d q(\hat{x})\cdot\dot{\hat{x}}=Q_{B}(\hat{x})\cdot\dot{\hat{x}}
\]
auf den Beobachter an
\begin{equation}
\begin{array}{cll}
\dot{\hat{x}} & = & Q_{B}^{-1}(\hat{x})\cdot\dot{\hat{\xi}}\\
 & = & Q_{B}^{-1}(\hat{x})\cdot\left(A\hat{\xi}+b\alpha(\hat{\xi})+l\cdot(y-\hat{\xi}_{1})\right)\\
 & = & f(\hat{x})+Q_{B}^{-1}(\hat{x})\cdot l\cdot(y-h(\hat{x}))\\
 & =: & f(\hat{x})+k(\hat{x})\cdot(y-h(\hat{x}))
\end{array}\label{eq:hg-beobachter-autonom-orig}
\end{equation}
und erhalten dabei eine zustandsabhängige Beobachterverstärkung $k:\mathcal{M}\to\R^{n}$.
Die Berechnung der Beobachterverstärkung nach Gl.~(\ref{eq:hg-beobachter-autonom-orig})
wird an einigen Beispielen illustriert:

\begin{example}
\label{exa:hg-mathematisches-Pendel-autonom}Wir betrachten das inverse
Pendel aus Beispiel~\ref{exa:hg-inverses-pendel}, allerdings zunächst
ohne Erregung\footnote{Der Beobachterentwurf für das inverse Pendel wird in Abschnitt~\ref{subsec:Beobachterentwurf-mit-eingang}
erneut aufgegriffen und dort in Beispiel~\ref{exa:hg-mathematisches-Pendel-Drehmoment}
für den Fall mit Eingang betrachtet.}, d.\,h. für $u\equiv0$. Nutzt man (abweichend von Beispiel~\ref{exa:hg-inverses-pendel})
als Ausgangs- bzw. Messgröße die Winkelgeschwindigkeit, die z.\,B.
mit einem Tacho erfasst werden kann. Damit erhält man das Zustands\-raum\-modell
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & \kappa_{1}\sin x_{1}\\
y & = & x_{2}.
\end{array}\label{eq:hg-math-pendel-autonom}
\end{equation}
Aus der Beobachtbarkeitsabbildung
\begin{equation}
q(x)=\left(\begin{array}{c}
h(x)\\
L_{f}h(x)
\end{array}\right)=\left(\begin{array}{c}
x_{2}\\
\kappa_{1}\sin x_{1}
\end{array}\right)\label{eq:hg-math-pendel-q}
\end{equation}
ergibt sich die Beobachtbarkeitsmatrix
\[
Q_{B}(x)=\left(\begin{array}{c}
\d h(x)\\
\d L_{f}h(x)
\end{array}\right)=\left(\begin{array}{cc}
0 & 1\\
\kappa_{1}\cos x_{1} & 0
\end{array}\right),
\]
die wegen $\det Q_{B}(x)=-\kappa_{1}\cos x_{1}$ für $|x_{1}|<\pi/2$
regulär ist. Für Auslenkungen, die betragsmäßig kleiner als $90\text{°}$
sind, ist das System somit lokal beobachtbar. Die Beobachterverstärkung
hat die Form 
\begin{equation}
k(\hat{x})=Q_{B}^{-1}(\hat{x})\left(\begin{array}{c}
a_{1}\\
a_{0}
\end{array}\right)=\left(\begin{array}{c}
\frac{a_{0}}{\kappa_{1}\cos\hat{x}_{1}}\\
a_{1}
\end{array}\right)\label{eq:math-pendel-autonom-beobachterverstaerkung-x}
\end{equation}
mit Koeffizienten $a_{0},a_{1}>0$. Entsprechend Gl.~(\ref{eq:hg-beobachter-autonom-orig})
erhält man für System~(\ref{eq:hg-math-pendel-autonom}) den Beobachter
\[
\left(\begin{array}{l}
\dot{\hat{x}}_{1}\\
\dot{\hat{x}}_{2}
\end{array}\right)=\left(\begin{array}{c}
\hat{x}_{2}\\
\kappa_{1}\sin\hat{x}_{1}
\end{array}\right)+\left(\begin{array}{c}
\frac{a_{0}}{\kappa_{1}\cos\hat{x}_{1}}\\
a_{1}
\end{array}\right)\left(y-\hat{x}_{2}\right).
\]
\end{example}

\begin{example}
\label{exa:Kreisel-autonom-high-gain}Man betrachte die Rotation eines
starren Körpers im körper\-festen Hauptachsensystem ohne Einwirkung
äußerer Kräfte. Die Drehbewegung lässt sich durch die \emph{eulerschen
Kreiselgleichungen}\index{eulersche Kreiselgleichungen} 
\[
\begin{array}{lcl}
I_{1}\dot{\omega}_{1} & = & (I_{2}-I_{3})\omega_{2}\omega_{3}\\
I_{2}\dot{\omega}_{2} & = & (I_{3}-I_{1})\omega_{1}\omega_{3}\\
I_{3}\dot{\omega}_{3} & = & (I_{1}-I_{2})\omega_{2}\omega_{3}
\end{array}
\]
mit den Winkelgeschwindigkeiten $\omega_{1},\omega_{2},\omega_{3}$
um die Hauptachsen und den Hauptträgheitsmomenten $I_{1},I_{2},I_{3}>0$
beschreiben~\cite{magnus1971,arnold1989,marsden2001}. Mit dem Zustandsvektor
$x=(x_{1},x_{2},x_{3})^{T}=(\omega_{1},\omega_{2},\omega_{3})^{T}$
und
\[
\lambda_{1}:=\frac{I_{2}-I_{3}}{I_{1}},\;\lambda_{2}:=\frac{I_{3}-I_{1}}{I_{2}},\;\lambda_{3}:=\frac{I_{1}-I_{2}}{I_{3}}
\]
erhält man das Zustandsraummodell 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & \lambda_{1}x_{2}x_{3}\\
\dot{x}_{2} & = & \lambda_{2}x_{1}x_{3}\\
\dot{x}_{3} & = & \lambda_{3}x_{1}x_{2}\\
y & = & x_{1}.
\end{array}\label{eq:hg-kreiselmodell}
\end{equation}
Als Ausgang ist dabei die Winkelgeschwindigkeit~$\omega_{1}$ der
ersten Hauptachse vorgesehen, d.\,h. aus der Messung einer Winkelgeschwindigkeit
sollen die anderen zwei Winkelgeschwindigkeiten durch den Beobachter
geschätzt werden. Die Beobachtbarkeitsmatrix 
\[
Q_{B}(x)=\left(\begin{array}{ccc}
1 & 0 & 0\\
0 & \lambda_{1}x_{3} & \lambda_{1}x_{2}\\
\lambda_{1}\left(\lambda_{3}x_{2}^{2}+\lambda_{2}x_{3}^{2}\right) & 2\lambda_{1}\lambda_{3}x_{1}x_{2} & 2\lambda_{1}\lambda_{2}x_{1}x_{3}
\end{array}\right)
\]
ist wegen $\det Q_{B}(x)=2\lambda_{1}^{2}x_{1}(\lambda_{2}x_{3}^{2}-\lambda_{2}x_{2}^{2})$
für $x_{1}\neq0\wedge\lambda_{2}x_{3}^{2}\neq\lambda_{2}x_{2}^{2}$
mit $\lambda_{1}\neq0$ (d.\,h. $I_{2}\neq I_{3}$) regulär. Mit
Alg.~\ref{alg:Berechnung-Beobachtbarkeitsmatrix} lässt sich die
Verstärkung~$k$ für den Beobachter~(\ref{eq:hg-beobachter-autonom-orig})
berechnen:

\begin{maxima}\input{Kreisel_HG.tex}\end{maxima}

Für die Simulation verwenden wir die (normierten) Hauptträgheitsmomente
$I_{1}=5$, $I_{2}=4$, $I_{3}=3$ und erhalten dadurch die Parameter
$\lambda_{1}=\tfrac{1}{5}$, $\lambda_{2}=-\tfrac{1}{2}$ und $\lambda_{3}=\tfrac{1}{3}$.
Für die Fehlerdynamik des linearen Teils wurde ein dreifache Eigenwert
$s=-0,2$ vorgegeben, womit man die Koeffizienten $a_{0}=0,008$,
$a_{1}=0,12$ und $a_{2}=0,6$ des charakteristischen Polynoms~(\ref{eq:hg-cp})
erhält. Die Anfangswerte des Systems~(\ref{eq:hg-kreiselmodell})
und des zugehörigen Beobachters~(\ref{eq:hg-beobachter-autonom-orig})
lauten 
\[
x(0)=\left(\begin{array}{c}
0,5\\
0,4\\
0,3
\end{array}\right)\quad\text{und}\quad\hat{x}(0)=\left(\begin{array}{c}
0,5\\
0,1\\
0,1
\end{array}\right).
\]
Abb.~\ref{fig:Kreisel-HG} zeigt die numerisch berechneten Trajektorien.
Es ist zu erkennen, dass der Beobachterzustand~$\hat{x}$ gegen den
Systemzustand~$x$ konvergiert.
\end{example}
\begin{figure}
\begin{centering}
\includegraphics[width=0.8\textwidth]{Kreisel_HG}
\par\end{centering}
\caption{Simulation der Kreiselgleichungen und des zugehörigen High-Gain-Beobachters\label{fig:Kreisel-HG}}

\end{figure}

\begin{example}
\label{exa:wagen-pendel-hg1}Man betrachte das Wagen-Pendel-System
aus Abschnitt~\ref{subsec:Wagen-mit-Pendel}, allerdings ohne Eingang
($u=0$) und reibungsfrei ($d_{1}=0,$ $d_{2}=0$). Aus Gl.~(\ref{eq:modell-pendel-mit-wagen})
liest man das Vektorfeld 
\begin{equation}
f(x)=\left(\begin{array}{c}
x_{2}\\
\frac{m_{2}\sin x_{3}\left(g\cos x_{3}+\ell x_{4}^{2}\right)}{m_{1}+m_{2}\sin^{2}x_{3}}\\
x_{4}\\
-\frac{\sin x_{3}\left(g(m_{1}+m_{2})+\ell m_{2}x_{4}^{2}\cos x_{3}\right)}{\ell\left(m_{1}+m_{2}\sin^{2}x_{3}\right)}
\end{array}\right)\label{eq:hg-wagen-pendel-f0}
\end{equation}
ab. Als Ausgang verwenden wir zunächst die Position des Wagens, d.\,h.
$y_{1}=h_{1}(x)=x_{1}$ (siehe Abb.~\ref{fig:Wagen-mit-Pendel-Hig-Gain}).
Die Beobachtbarkeitsmatrix 
\begin{equation}
Q_{B}(x)=\left(\begin{array}{cccc}
1 & 0 & 0 & 0\\
0 & 1 & 0 & 0\\
0 & 0 & * & \frac{2\ell m_{2}x_{4}\sin x_{3}}{m_{1}+m_{2}\sin^{2}x_{3}}\\
0 & 0 & * & *
\end{array}\right)\label{eq:wageh-pendel-hg-Qb1}
\end{equation}
enthält in den letzten zwei Zeilen bzw. Spalten vergleichsweise komplizierte
Ausdrücke. Zur Überprüfung der Regularität der Beobachtbarkeitsmatrix
berechnen wir deren Determinante, für die man auch einen umfangreichen
Ausdruck erhält. Mit $\det Q_{B}(x)=(gm_{2}/m_{1})^{2}$ für $x_{3}=0$,
$x_{4}=0$ ist die Beobachtbarkeitsmatrix zumindest für kleine Auslenkungen
des Pendels und kleine Winkelgeschwindigkeiten regulär. Die Beobachterverstärkung
\[
k(\hat{x})=Q_{B}^{-1}(x)\cdot\left(\begin{array}{c}
a_{3}\\
a_{2}\\
a_{1}\\
a_{0}
\end{array}\right)=\left(\begin{array}{c}
a_{3}\\
a_{2}\\
*\\
*
\end{array}\right)
\]
nach Gl.~(\ref{eq:hg-beobachter-autonom-orig}) enthält in den letzten
zwei Komponenten ebenfalls sehr umfangreiche Ausdrücke, so dass auf
die vollständige Angabe verzichtet wird.
\end{example}
\begin{figure}
\begin{centering}
\resizebox{0.5\textwidth}{!}{\input{wagen_pendel_high_gain.pdftex_t}}
\par\end{centering}
\caption{Wagen mit Pendel\label{fig:Wagen-mit-Pendel-Hig-Gain}}
\end{figure}

\begin{example}
\label{exa:wagen-pendel-hg2}Wir betrachten erneut das Wagen-Pendel-System
aus Beispiel~\ref{exa:wagen-pendel-hg1}, verwenden jetzt aber die
horizontale Position der Last als Ausgang, d.\,h. $y_{2}=h_{2}(x)=x_{1}+\ell\sin x_{3}$
(vgl. Abb.~\ref{fig:Wagen-mit-Pendel-Hig-Gain}). Die zugehörige
Beobachtbarkeitsmatrix hat die Form 
\[
Q_{B}(x)=\left(\begin{array}{cccc}
1 & 0 & \ell\cos x_{3} & 0\\
0 & 1 & -\ell x_{4}\sin x_{3} & \ell\cos x_{3}\\
0 & 0 & * & -\frac{2\ell m_{1}x_{4}\sin x_{3}}{m_{1}+m_{2}\sin^{2}x_{3}}\\
0 & 0 & * & *
\end{array}\right).
\]
Mit $\det Q_{B}(x)=g^{2}$ für $x_{3}=0$, $x_{4}=0$ ist die Beobachtbarkeitsmatrix
auch mit diesem Ausgang für kleine Auslenkungen und kleine Winkelgeschwindigkeiten
regulär. Damit kann man den Beobachter~(\ref{eq:hg-beobachter-autonom-orig})
berechnen, erhält aber wiederum umfangreiche Ausdrücke.
\end{example}

Für die Konvergenzanalyse betrachten wir das System~(\ref{eq:hg-system-autonom})
und den Beobachter~(\ref{eq:hg-beobachter-autonom-trans}) in den
transformierten Koordinaten. Genügt die in der Fehlerdifferentialgleichung~(\ref{eq:hg-fehlerdyn})
auftretende Nichtlinearität~$\alpha$ einer Lipschitz-Bedingung\index{Lipschitz-Bedingung}
\begin{equation}
\forall\xi,\hat{\xi}:\quad\left\Vert \alpha(\xi)-\alpha(\hat{\xi})\right\Vert \leq\rho\left\Vert \xi-\hat{\xi}\right\Vert \label{eq:hg-lipschitz-bedingung}
\end{equation}
mit der Lipschitz-Konstanten $\rho>0$, dann kann über die Wahl der
Beobachterverstärkung~$l$ durch den linearen Teil $A-lc^{T}$ die
Konvergenz des Beobachters gesichert werden. Der folgende Satz trifft
eine globale Konvergenzaussage:
\begin{theorem}
\label{thm:hg-konvergenz-autonom}Gegeben sei System~(\ref{eq:hg-system-autonom})
zusammen mit dem Beobachter~(\ref{eq:hg-beobachter-autonom-orig}).
Das Vektorfeld~$f$ sei auf $\mathcal{M}=\R^{n}$ definiert und vollständig.
Die Beobachtbarkeitsabbildung~$q$ sei ein globaler Diffeomorphismus.
Außerdem genüge die Nichtlinearität~$\alpha$ der globalen Lipschitz-Bedingung~(\ref{eq:hg-lipschitz-bedingung}).
Dann existiert ein Vektor $l\in\R^{n}$ derart, dass 
\begin{equation}
\lim_{t\to\infty}\left\Vert \hat{x}(t)-x(t)\right\Vert =0\label{eq:hg-konvergenz}
\end{equation}
für alle Anfangswerte $x(0),\hat{x}(0)\in\mathcal{M}$ gilt.
\end{theorem}

Die Beweise in~\cite{gauthier92,ciccarella93,dalla-mora1997} basieren
auf sehr speziellen Eigenwertvorgaben. In späteren Arbeiten entfällt
diese Einschränkung. Der folgende Beweis beruht auf~\cite{roebenack2012ssd,roebenack2016sac}:\nocite{derbel2016sac}
\begin{svmultproof2}
Laut Annahme ist die Beobachtbarkeitsabbildung ein globaler Diffeomorphismus.
Wir führen daher die Konvergenzanalyse in den transformierten Koordinaten
durch und zeigen, dass die Ruhelage $\tilde{\xi}=0$ der Fehlerdifferentialgleichung~(\ref{eq:hg-fehlerdyn})
global asymptotisch stabil ist. Definiert man 
\begin{equation}
\Delta\alpha(\tilde{\xi},t):=\alpha(\xi)-\alpha(\hat{\xi}),\label{eq:hg-delta-alpha}
\end{equation}
dann lässt sich die Fehlerdifferentialgleichung~(\ref{eq:hg-fehlerdyn})
als Verknüpfung eines linearen zeitinvarianten Systems mit der Übertragungsfunktion
\[
G(s)=\left(sI-\left(A-lc^{T}\right)\right)^{-1}b=\frac{1}{\CP(s)}\left(\begin{array}{c}
1\\
s+a_{n-1}\\
s^{2}+a_{n-1}s+a_{n-2}\\
\vdots
\end{array}\right)
\]
und der zeitvarianten Nichtlinearität~(\ref{eq:hg-delta-alpha})
darstellen (vgl. Abb.~\ref{fig:Fehlerdynamik-High-Gain}). Wir gehen
davon aus, dass~(\ref{eq:hg-cp}) als Hurwitz-Polynom vorgegeben
wurde. Damit besitzt das lineare Teilsystem eine endliche Verstärkung,
d.\,h. $\|G\|_{\infty}<\infty$.
\begin{figure}
\begin{centering}
\resizebox{0.82\textwidth}{!}{\input{high-gain-nf1.pdftex_t}}
\par\end{centering}
\caption{Struktur der Fehlerdynamik~(\ref{eq:hg-fehlerdyn}) des High-Gain-Beobachters~(\ref{eq:hg-beobachter-autonom-trans})\label{fig:Fehlerdynamik-High-Gain}}
\end{figure}

Führt man bei der Beobachterverstärkung $l^{\epsilon}=(a_{n-1}/\epsilon,\ldots,a_{0}/\epsilon^{n})^{T}$
einen Skalierungsfaktor $\epsilon\in(0,1]$ ein, so erhält man das
in~$\epsilon$ parametrierte charakteristische Polynom
\begin{equation}
\begin{array}{lrl}
\CP^{\epsilon}(s) & := & \det(sI-A+l^{\epsilon}c^{T})\\
 & = & \frac{a_{0}}{\epsilon^{n}}+\frac{a_{1}}{\epsilon^{n-1}}s+\cdots+\frac{a_{n-1}}{\epsilon}s^{n-1}+s^{n}\\
 & = & \left(s-\frac{s_{1}}{\epsilon}\right)\cdots\left(s-\frac{s_{n}}{\epsilon}\right).
\end{array}\label{eq:hg-cp-epsilon}
\end{equation}
Für $\epsilon\to0$ entspricht diese Skalierung einer Streckung der
Eigenwerte nach links. Die zugehörige Übertragungsfunktion hat dann
die Form
\[
G^{\epsilon}(s)=\left(sI-\left(A-l^{\epsilon}c^{T}\right)\right)^{-1}b=\frac{1}{\CP^{\epsilon}(s)}\left(\begin{array}{c}
1\\
s+a_{n-1}\epsilon^{-1}\\
s^{2}+a_{n-1}\epsilon^{-1}s+a_{n-2}\epsilon^{-2}\\
\vdots
\end{array}\right).
\]
Für den Frequenzgang der $i$-ten Komponente gilt
\[
\begin{array}{ccl}
G_{i}^{\epsilon}(j\omega) & = & \frac{(j\omega)^{i-1}+\frac{a_{n-1}}{\epsilon}(j\omega)^{i-2}+\cdots+\frac{a_{n-i+1}}{\epsilon^{i-1}}}{\left(j\omega-\frac{s_{1}}{\epsilon}\right)\cdots\left(j\omega-\frac{s_{n}}{\epsilon}\right)}\\
 & = & \frac{(j\omega\epsilon)^{i-1}+a_{n-1}(j\omega\epsilon)^{i-2}+\cdots+a_{n-i+1}}{\left(j\omega\epsilon-s_{1}\right)\cdots\left(j\omega\epsilon-s_{n}\right)}\epsilon^{n-i+1}\\
 & = & \frac{(j\tilde{\omega})^{i-1}+a_{n-1}(j\tilde{\omega})^{i-2}+\cdots+a_{n-i+1}}{\left(j\tilde{\omega}-s_{1}\right)\cdots\left(j\tilde{\omega}-s_{n}\right)}\epsilon^{n-i+1}\\
 & = & G_{i}(j\tilde{\omega})\epsilon^{n-i+1}
\end{array}
\]
mit $\tilde{\omega}=\omega\epsilon$. Daraus folgt unmittelbar $\|G_{i}^{\epsilon}\|_{\infty}=\|G_{i}\|_{\infty}\epsilon^{n-i+1}\to0$
für $\epsilon\to0$. Somit lassen sich der Parameter~$\epsilon$
und damit die zugehörige Beobachterverstärkung~$l^{\epsilon}$ immer
so wählen, dass $\|G^{\epsilon}\|_{\infty}<1/\rho$. Mit einer derartigen
Wahl der Beobachterverstärkung im linearen Teilsystem ist die Gesamtverstärkung
des offenen Kreises kleiner als Eins. Nach dem Satz über die kleine
Kreisverstärkung ist die Ruhelage $\tilde{\xi}=0$ global asymptotisch
stabil, so dass die Konvergenz~(\ref{eq:hg-konvergenz}) gesichert
ist (siehe Anhang~\ref{sec:Stabilitaet-im-geschlossenen-Regelkreis}).
\end{svmultproof2}

\begin{remark}
Für die korrekte Festlegung der Beobachterverstärkung~$l$ ist die
Kenntnis der Lipschitz-Konstanten~$\rho$ aus Ungl.~(\ref{eq:hg-lipschitz-bedingung})
erforderlich. Die exakte Bestimmung der Lipschitz-Konstanten ist in
der Regel aufwendig. Alternativ könnte man versuchen, über Intervallarithmetik
eine Abschätzung der Lipschitz-Konstanten zu erhalten. Praktisch gibt
man zunächst Eigenwerte $s_{1},\ldots,s_{n}$ für ein stabiles charakteristisches
Polynom~(\ref{eq:hg-cp}) vor. Dann geht man zum charakteristischen
Polynom~(\ref{eq:hg-cp-epsilon}) mit $\epsilon=1$ über und verkleinert
$\epsilon>0$ solange, bis der Boebachter konvergiert. 
\end{remark}

\subsection{Beobachtbarkeit und Beobachterentwurf für eingangsabhängige Systeme\label{subsec:Beobachterentwurf-mit-eingang}}

Im Folgenden wird das in Abschnitt~\ref{subsec:Beobachtbarkeit-autonom}
zunächst für autonome Systeme eingeführte Konzept der Beobachtbarkeit
auf eingangsabhängige Systeme übertragen, um anschließend auch für
diese Systeme den Beobachter aus Abschnitt~\ref{subsec:Beobachterentwurf-autonom}
verwenden zu können.

Für die Beobachtbarkeitsanalyse betrachten wir das System~(\ref{eq:hg-system-nicht-affin})
auf dem Zeit\-inter\-vall $[0,T]$ mit $T>0$. Das Eingangssignal
$u(\cdot)$ sei auf diesem Zeit\-inter\-vall (mindestens) stückweise
stetig. Dann besitzt das System für hinreichend kleine $T>0$ ein
allgemeine Lösung, die wir in leichter Modifikation der bisherigen
Notation mit $\varphi_{t}^{u}$ bezeichnen (vgl. Abschnitt~\ref{sec:Vektorfelder-und-Fluesse}).
Zwei Zustände $p,\bar{p}\in\mathcal{M}$ heißen \emph{nicht unterscheidbar
bezüglich eines (gegebenen) Eingangssignals} $u(\cdot)$\index{Nichtunterscheidbarkeit!bezüglich eines Eingangssignals},
wenn die zugehörigen Verläufe der Ausgänge übereinstimmen, d.\,h.
\[
\forall t\in[0,T]:\quad h(\varphi_{t}^{u}(p))=h(\varphi_{t}^{u}(\bar{p})).
\]
Mit dem Begriff der Unterscheidbarkeit lassen sich in Analogie zu
Abschnitt~\ref{subsec:Beobachtbarkeit-autonom} auch lokale und globale
Beobachtbarkeit für eingangsabhängige Systeme definieren. Das folgende
Beispiel zeigt, dass bei einem nichtlinearen System die Möglichkeit,
den Zustand aus dem Verlauf des Ausgangs und seinen Zeitableitungen
zu rekonstruieren, vom konkreten Eingangssignal abhängen kann:

\begin{example}
\label{exa:Minisystem-nicht-glm-beob}Gegeben sei das System
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & -x_{1}+x_{2}(1+u)\\
\dot{x}_{2} & = & x_{2}\\
y & = & x_{1}.
\end{array}\label{eq:Minisystem-nicht-glm-beob}
\end{equation}
Für $u\neq-1$ erhält man den Zustand~$x$ aus dem Ausgang~$y$
und seiner ersten Zeitableitung:
\[
\left.\begin{array}{lcl}
y & = & x_{1}\\
\dot{y} & = & -x_{1}+x_{2}(1+u)
\end{array}\right\} \quad\Longrightarrow\quad\begin{array}{lcl}
x_{1} & = & y,\\
x_{2} & = & \frac{y+\dot{y}}{1+u}.
\end{array}
\]
Für $u\equiv-1$ wirkt sich dagegen der Zustand~$x_{2}$ nicht auf
den Ausgang aus. In diesem Fall sind alle Anfangszustände, die in
der ersten Komponente übereinstimmen, nicht unterscheidbar.
\end{example}

Das Beispiel verdeutlicht, dass es sinnvoll sein kann, die Beobachtbarkeit
eines eingangsabhängigen Systems derart zu definieren, dass diese
Eigenschaft unabhängig vom gewählten Eingangssignal ist. Wir nennen
ein System~(\ref{eq:hg-system-eingangsaffin}) \emph{gleichmäßig
lokal} bzw. \emph{global beobachtbar}, wenn es für alle zulässigen
Eingangssignale $u(\cdot)$ lokal bzw. global beobachtbar ist. 

Gegeben sei ein eingangsaffines System
\begin{equation}
\dot{x}=f(x)+g(x)u,\quad y=h(x)\label{eq:hg-system-eingangsaffin}
\end{equation}
mit den Vektorfeldern $f,g:\mathcal{M}\to\R^{n}$ und dem Skalarfeld
$h:\mathcal{M}\to\R$. Die Felder seien hinreichend glatt. Erfüllt
der autonome Teil~(\ref{eq:hg-system-autonom}) von System~(\ref{eq:hg-system-eingangsaffin})
die Bedingungen von Lemma~\ref{lem:Beobachtbarkeit-hinreichende-Bedingung},
so ist eine Beurteilung der gleichmäßigen lokalen Beobachtbarkeit
anhand der Beobachtbarkeitsnormalform\index{Beobachtbarkeitsnormalform}\index{Normalform!Beobachtbarkeits-}
möglich~\cite{gauthier81,gauthier92}:
\begin{theorem}
\label{thm:hg-Beobachtbarkeit-nicht-autonom}Man betrachte das System~(\ref{eq:hg-system-eingangsaffin})
im Punkt $p\in\mathcal{M}$. Es gelte $\rank\,Q_{B}(p)=n$. Das System
ist genau dann gleichmäßig lokal beobachtbar im Punkt~$p$, wenn
es zustands\-äquivalent zur Form 
\begin{equation}
\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}+\beta_{1}(\xi_{1})u\\
\dot{\xi}_{2} & = & \xi_{3}+\beta_{2}(\xi_{1},\xi_{2})u\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}+\beta_{n-1}(\xi_{1},\xi_{2},\ldots,\xi_{n-1})u\\
\dot{\xi}_{n} & = & \alpha(\xi)+\beta_{n}(\xi_{1},\xi_{2},\ldots,\xi_{n-1},\xi_{n})u\\
y & = & \xi_{1}
\end{array}\label{eq:Beobachtbarkeits-NF-nicht-autonom}
\end{equation}
ist.
\end{theorem}
\begin{svmultproof2}
Es gelte $\rank\,Q_{B}(p)=n$. Dann ist die in Gl.~(\ref{eq:Beobachtbarkeitsabbildung})
definierte Beobachtbarkeitsabbildung $\xi=q(x)$ ein lokaler Diffeomorphismus,
der das System~(\ref{eq:hg-system-eingangsaffin}) in die Beobachtbarkeitsnormalform\index{Beobachtbarkeitsnormalform}\index{Normalform!Beobachtbarkeits-}
\begin{equation}
\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}+\beta_{1}(\xi)u\\
\dot{\xi}_{2} & = & \xi_{3}+\beta_{2}(\xi)u\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}+\beta_{n-1}(\xi)u\\
\dot{\xi}_{n} & = & \alpha(\xi)+\beta_{n}(\xi)u\\
y & = & \xi_{1}
\end{array}\label{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein}
\end{equation}
mit $\alpha(\xi):=L_{f}^{n}h(q^{-1}(\xi))$ und 
\begin{equation}
\beta_{i}(\xi):=L_{g}L_{f}^{i-1}h(q^{-1}(\xi))\quad\text{für}\quad i=1,\ldots,n\label{eq:beobachtbarkeits-NF-beta-i}
\end{equation}
überführt (vgl. Beweis von Satz~\ref{thm:hg-beobachtbarkeitsnormalform}).
Für die nachfolgenden Untersuchungen betrachten wir zwei Instanzen
des Systems~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein}),
nämlich eine mit dem Zustand~$\xi$ und dem Anfangswert $\xi(0)$
und eine weitere Instanz mit dem Zustand~$\bar{\xi}$ und dem Anfangswert
$\bar{\xi}(0)$. Beide Instanzen werden mit dem gleichen Eingangssignal~$u$
beaufschlagt.

\notwendig\ Wir zeigen die Notwendigkeit der Form~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
indirekt. Wir nehmen also an, dass das System~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein})
nicht der speziellen Struktur~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
genügt. Sei $i_{0}<n$ die kleinste Zahl, so dass eine Zahl $j_{0}>i_{0}$
mit $\partial\beta_{i_{0}}/\partial\xi_{j_{0}}\not\equiv0$ existiert.
(Das bedeutet, dass $\beta_{i_{0}}(\xi)$ nicht nur von $\xi_{1},\ldots,\xi_{i_{0}}$,
sondern auch von $\xi_{j_{0}}$ abhängt.) Die Anfangswerte $\xi(0)\neq\bar{\xi}(0)$
beider Systeminstanzen seien so gewählt, dass sie in den ersten~$i_{0}$
Komponenten übereinstimmen, d.\,h. $\xi_{i}(0)=\bar{\xi}_{i}(0)$
für $i=1,\ldots,i_{0}$. Wegen $\partial\beta_{i_{0}}/\partial\xi_{j_{0}}\not\equiv0$
lassen sich zusätzlich die $j_{0}$-ten Komponenten $\xi_{j_{0}}(0)\neq\bar{\xi}_{j_{o}}(0)$
beider Anfangswerte so wählen, dass $\beta_{i_{0}}(\xi(0))-\beta_{i_{0}}(\bar{\xi}(0))\neq0$
gilt. Die Rückführung 
\begin{equation}
u=-\frac{\xi_{i_{0}+1}-\bar{\xi}_{i_{0}+1}}{\beta_{i_{0}}(\xi)-\beta_{i_{0}}(\bar{\xi})}\label{eq:beweis-struktur-nicht-autonom-u}
\end{equation}
ist damit zumindest für ein gewisses Zeitintervall $[0,T]$ bei hinreichend
kleiner Endzeit $T>0$ definiert. Die Abweichung in der $i_{0}$-ten
Differentialgleichung beider Instanzen verschwindet unter Wirkung
des Eingangssignals~(\ref{eq:beweis-struktur-nicht-autonom-u}) identisch:
\[
\dot{\xi}_{i_{0}}-\dot{\bar{\xi}}_{i_{0}}=\xi_{i_{0}+1}+\bar{\xi}_{i_{0}+1}+\left(\beta_{i_{0}}(\xi)-\beta_{i_{0}}(\bar{\xi})\right)u\equiv0.
\]
Dann stimmen die Zeitverläufe in den ersten $i_{0}$ Komponenten von
$\xi,\bar{\xi}$ auf dem Intervall $[0,T]$ überein und führen somit
unabhängig von den Anfangswerten der letzten $n-i_{0}$ Komponenten
zu dem gleichen Ausgangsverlauf. Damit sind alle Anfangswerte $\xi(0),\bar{\xi}(0)$,
die in den ersten $i_{0}$ Komponenten übereinstimmen, für den Eingangsverlauf~(\ref{eq:beweis-struktur-nicht-autonom-u})
nicht unterscheidbar. Das System ist also nicht gleichmäßig lokal
beobachtbar.

\hinreichend\ Das transformierte System~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein})
besitze die Struktur~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom}).
Für beide Instanzen des Systems~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
betrachten wir beliebige Verläufe von dem Ausgang $y(t)=\xi_{1}(t)=\bar{\xi}_{1}(t)$
und dem Eingang $u(t)$ für alle $t\in[0,T]$ mit $T>0$. Durch Einsetzen
in die erste Differentialgleichung von~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
erhält man übereinstimmende Verläufe $\xi_{2}(t)=\bar{\xi}_{2}(t)$,
aus der zweiten Differentialgleichung folgt $\xi_{3}(t)=\bar{\xi}_{3}(t)$.
Dieses Verfahren setzt man bis zur vorletzen Differentialgleichung
fort, aus der man $\xi_{n}(t)=\bar{\xi}_{n}(t)$ für alle $t\in[0,T]$
erhält. Damit gilt $\xi(t)=\bar{\xi}(t)$ für alle $t\in[0,T]$, so
dass auch die Anfangswerte beider Systeminstanzen übereinstimmen:
$\xi(0)=\bar{\xi}(0)$. Für einen vorgegebenen Ausgangsverlauf ist
unabhängig vom konkreten Eingangsverlauf der Anfangswert eindeutig
festgelegt. Das System~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
ist daher gleichmäßig beobachtbar.
\end{svmultproof2}

Die Argumentation im hinreichenden Teil des Beweises lässt unmittelbar
eine Verallgemeinerung auf nicht eingangsaffine Systeme mit ggf. vektorwertigem
Eingang zu:
\begin{corollary}
\label{cor:Beobachtbarkeit-nicht-affin-MISO}Gegeben sei ein System
\[
\dot{x}=f(x)+\tilde{g}(x,u),\quad y=h(x)
\]
mit hinreichend glatten Feldern $f:\mathcal{M}\to\R^{n}$, $\tilde{g}:\mathcal{M}\times\mathcal{U}\to\R^{n}$,
$h:\mathcal{M}\to\R$ und $\mathcal{U}\subseteq\R^{m}$. Für das zugeordnete
autonome System~(\ref{eq:hg-system-autonom}) gelte $\rank\,Q_{B}(p)=n$
in einem Punkt $p\in\mathcal{M}$. Ist das System in einer Umgebung
von~$p$ zustands\-äquivalent zur Form
\begin{equation}
\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}+\tilde{\beta}_{1}(\xi_{1},u)\\
\dot{\xi}_{2} & = & \xi_{3}+\tilde{\beta}_{2}(\xi_{1},\xi_{2},u)\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}+\tilde{\beta}_{n-1}(\xi_{1},\xi_{2},\ldots,\xi_{n-1},u)\\
\dot{\xi}_{n} & = & \alpha(\xi)+\tilde{\beta}_{n}(\xi_{1},\xi_{2},\ldots,\xi_{n-1},\xi_{n},u)\\
y & = & \xi_{1},
\end{array}\label{eq:Beobachtbarkeits-NF-nicht-affin}
\end{equation}
dann ist es im Punkt~$p$ gleichmäßig lokal beobachtbar.
\end{corollary}

Für einige eingangsaffine Beispielssysteme wird die Existenz der speziellen
Form~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom}) untersucht:

\begin{example}
\label{exa:Minisystem-nicht-glm-Beobachtbarkeits-NF}Das System~(\ref{eq:Minisystem-nicht-glm-beob})
aus Beispiel~\ref{exa:Minisystem-nicht-glm-beob} besitzt eine lineare
Beobachtbarkeitsabbildung~(\ref{eq:Beobachtbarkeitsabbildung}) und
folglich eine konstante Beobachtbarkeitsmatrix~(\ref{eq:Beobachtbarkeitsmatrix}):
\[
\xi=q(x)=\left(\begin{array}{c}
x_{1}\\
-x_{1}+x_{2}
\end{array}\right),\quad Q_{B}(x)=q^{\prime}(x)=\left(\begin{array}{rc}
1 & 0\\
-1 & 1
\end{array}\right).
\]
Damit ist die Umkehrtransformation $x=q^{-1}(\xi)$ auch linear: $x_{1}=\xi_{1}$,
$x_{2}=\xi_{1}+\xi_{2}$. Das transformierte System lautet
\[
\begin{array}{lcl}
\dot{\xi} & = & \frac{\d}{\d t}q(x)\\
 & = & q^{\prime}(x)\cdot\dot{x}\\
 & = & Q_{B}(x)\left(f(x)+g(x)u\right)\\
 & = & \left.\left(\begin{array}{rc}
1 & 0\\
-1 & 1
\end{array}\right)\left(\begin{array}{c}
-x_{1}+x_{2}(1+u)\\
x_{2}
\end{array}\right)\right|_{x=q^{-1}(\xi)}\\
 & = & \left(\begin{array}{c}
\xi_{2}+(\xi_{1}+\xi_{2})u\\
\xi_{1}-(\xi_{1}+\xi_{2})u
\end{array}\right).
\end{array}
\]
Das System liegt damit in der Form~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein})
mit $\beta_{1}(\xi)=\xi_{1}+\xi_{2}$ und $\beta_{2}(\xi)=-(\xi_{1}+\xi_{2})$
vor. Da $\beta_{1}(\xi)$ auch von~$\xi_{2}$ abhängt, ist die Struktur~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
nicht gegeben. Das System ist also in Übereinstimmung mit den Betrachtungen
aus Beispiel~\ref{exa:Minisystem-nicht-glm-beob} nicht gleichmäßig
lokal beobachtbar.
\end{example}

\begin{example}
\label{exa:hg-mathematisches-Pendel-Drehmoment}Das inverse mathematische
Pendel aus Beispiel~\ref{exa:hg-inverses-pendel} mit der Ausgangsgröße
aus Beispiel~\ref{exa:hg-mathematisches-Pendel-autonom} lässt sich
durch das Zustandsraummodell
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & \kappa_{1}\sin x_{1}+\kappa_{2}u\\
y & = & x_{2}
\end{array}\label{eq:hg-math-pendel-drehmoment}
\end{equation}
beschreiben. Aus der Beobachtbarkeitsabbildung~(\ref{eq:hg-math-pendel-q})
erhält man Hin- und Rücktransformation 
\[
\begin{array}{lcl}
\xi_{1} & = & x_{2}\\
\xi_{2} & = & \kappa_{1}\sin x_{1}
\end{array}\qquad\text{und}\qquad\begin{array}{lcl}
x_{1} & = & \arcsin\frac{\xi_{2}}{\kappa_{1}}\\
x_{2} & = & \xi_{1}
\end{array}
\]
in die Beobachtbarkeitsnormalform~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein}).
Daraus ergibt sich das transformierte System 
\begin{equation}
\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}+\kappa_{2}u\\
\dot{\xi}_{2} & = & \kappa_{1}\xi_{1}\sqrt{1-\frac{\xi_{2}^{2}}{\kappa_{1}^{2}}}
\end{array}\label{eq:hg-math-pendel-transformiert}
\end{equation}
mit $\beta_{1}(\xi)=\kappa_{2}$ und $\beta_{2}(\xi)=0$. Dabei hängt
$\beta_{1}(\xi)$ nicht von~$\xi_{2}$ ab, so dass das System~(\ref{eq:hg-math-pendel-transformiert})
in de Form~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom}) vorliegt
und für $|x_{1}|<\pi/2$ nach Satz~\ref{thm:hg-Beobachtbarkeit-nicht-autonom}
gleichmäßig lokal beobachtbar ist. Mit der Beobachterverstärkung~(\ref{eq:math-pendel-autonom-beobachterverstaerkung-x})
erhält man für das erregte System~(\ref{eq:hg-math-pendel-drehmoment})
den Beobachter
\[
\left(\begin{array}{l}
\dot{\hat{x}}_{1}\\
\dot{\hat{x}}_{2}
\end{array}\right)=\left(\begin{array}{c}
\hat{x}_{2}\\
\kappa_{1}\sin\hat{x}_{1}+\kappa_{2}u
\end{array}\right)+\left(\begin{array}{c}
\frac{a_{0}}{\kappa_{1}\cos\hat{x}_{1}}\\
a_{1}
\end{array}\right)\left(y-\hat{x}_{2}\right)
\]
mit den Koeffizienten $a_{0},a_{1}>0$.
\end{example}

\begin{example}
\label{exa:Synchronmaschine-HG}In~\cite{mukhopadhyay1972} wird
eine Synchronmaschine\index{Synchronmaschine} modelliert und durch
die Zustandsgleichungen 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & B_{1}-A_{1}x_{2}-A_{2}x_{3}\sin x_{1}-\tfrac{1}{2}B_{2}\sin(2x_{1})\\
\dot{x}_{3} & = & u-D_{1}x_{3}+D_{2}\cos x_{1}\\
y & = & x_{1}
\end{array}\label{eq:synchronmotor}
\end{equation}
beschrieben. Dabei bezeichnet~$x_{1}$ den Polradwinkel, also den
Winkel zwischen dem Polrad und dem Drehfeld. Der Polradwinkel fungiert
zugleich als Ausgangsgröße, welche aus dem mit einen Winkelencoder
erfassten Drehwinkel berechnet wird. Fernen seien $x_{2}$ die zugehörige
Winkelgeschwindigkeit (relativ zum rotierenden Bezugssystem), $x_{3}$
die Flussverkettung der Erregerwicklung und $u$ der Eingang.

Das Modell~(\ref{eq:synchronmotor}) wird häufig zu Vergleichszwecken
beim nichtlinearen Beobachterentwurf verwendet~\cite{keller86diss,birk88,adjallah94,roebenack2003buch,roebenack2005habil,adamy2014,franke2016pamm}.
Die Beobachtbarkeitsmatrix 
\begin{equation}
Q_{B}(x)=\left(\begin{array}{ccc}
1 & 0 & 0\\
0 & 1 & 0\\
-A_{2}x_{2}\cos x_{1}-B_{2}\cos(2x_{1}) & -A_{1} & -A_{2}\sin x_{1}
\end{array}\right)\label{eq:synchronmotor-beobachtbarkeitsmatrix}
\end{equation}
ist für $x_{1}\neq\pi i$ mit $i\in\mathbb{Z}$ regulär, so dass der
zugehörige autonome Systemteil, den man für $u=0$ erhält, in diesem
Bereich lokal beobachtbar ist. Zur Untersuchung der gleichmäßigen
Beobachtbarkeit betrachten wir die Struktur des aus~(\ref{eq:synchronmotor})
resultierenden Eingangsvektorfeldes $g(x)=\tfrac{\partial}{\partial x_{3}}$
in den transformierten Koordinaten:
\[
Q_{B}(x)\cdot g(x)=\left(\begin{array}{c}
0\\
0\\
-A_{2}\sin x_{1}
\end{array}\right).
\]
Mit $\beta_{1}(\cdot)=0$ und $\beta_{2}(\cdot)=0$ ist die Strukturbedingung~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
erfüllt, so dass das System~(\ref{eq:synchronmotor}) im o.\,g.
Bereich gleichmäßig lokal beobachtbar ist. Die Beobachterverstärkung
hat die Form
\[
k(\hat{x})=Q_{B}^{-1}(\hat{x})\left(\begin{array}{c}
a_{2}\\
a_{1}\\
a_{0}
\end{array}\right)=\left(\begin{array}{c}
a_{2}\\
a_{1}\\
-\frac{a_{0}+a_{1}A_{1}+a_{2}A_{2}\hat{x}_{3}\cos\hat{x}_{1}+a_{2}B_{2}\cos(2\hat{x}_{1})}{A_{2}\sin\hat{x}_{1}}
\end{array}\right)
\]
mit den Koeffizienten $a_{0},a_{1},a_{2}>0$. Simulationsuntersuchungen
des Beobachters sind in~\cite{roebenack2003buch} beschrieben.
\end{example}

Bei komplizierteren Systemen lässt sich die Beobachtbarkeitsnormalform~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein})
in der Regel nicht explizit angeben. In diesen Fällen ist Satz~\ref{thm:hg-Beobachtbarkeit-nicht-autonom}
zur Überprüfung der gleichmäßigen Beobachtbarkeit nicht geeignet.
Mit folgendem Satz ist die Überprüfung der Struktur~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
auch in Originalkoordinaten möglich~\cite[Lemma~2]{jo2002}:
\begin{theorem}
\label{thm:hg-Beobachtbarkeit-nicht-autonom2}Man betrachte das System~(\ref{eq:hg-system-eingangsaffin})
im Punkt $p\in\mathcal{M}$. Es gelte $\rank\,Q_{B}(p)=n$. Das System
ist genau dann gleichmäßig lokal beobachtbar im Punkt~$p$, wenn
\begin{equation}
\d L_{g}L_{f}^{i}h\in\spann\{\d h,\d L_{f}h,\ldots,\d L_{f}^{i}h\}\quad\text{für}\quad i=0,\ldots,n-2\label{eq:beob-nicht-autonom-grad-x}
\end{equation}
in einer Umgebung von~$p$ gilt.
\end{theorem}
\begin{svmultproof2}
Es gelte $\rank\,Q_{B}(p)=n$. Dann ist die in Gl.~(\ref{eq:Beobachtbarkeitsabbildung})
definierte Beobachtbarkeitsabbildung $\xi=q(x)$ ein lokaler Diffeomorphismus,
der das System~(\ref{eq:hg-system-eingangsaffin}) in die Beobachtbarkeitsnormalform~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom-allgemein})
überführt. Die in Gl.~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
angegebenen funkionalen Abhängigkeiten in den Komponenten~$\beta_{i}$
des (transformierten) Eingangsvektorfeldes lassen sich über lineare
Abhängigkeiten ausdrücken:
\begin{equation}
\begin{array}{lclcl}
\beta_{1}(\xi_{1}) & \quad\Longleftrightarrow\quad & \d\beta_{1} & \in & \spann\{\d\xi_{1}\}\\
\beta_{2}(\xi_{1},\xi_{2}) & \quad\Longleftrightarrow\quad & \d\beta_{2} & \in & \spann\{\d\xi_{1},\d\xi_{2}\}\\
 & \vdots\\
\beta_{n-1}(\xi_{1},\xi_{2},\ldots,\xi_{n-1}) & \quad\Longleftrightarrow\quad & \d\beta_{n-1} & \in & \spann\{\d\xi_{1},\d\xi_{2},\ldots,\d\xi_{n-1}\}.
\end{array}\label{eq:beob-nicht-autonom-grad-z}
\end{equation}
Aus $\xi_{i}=L_{f}^{i-1}h(x)$ ergibt sich $\d\xi_{i}=\d L_{f}^{i-1}h(x)$
für $i=1,\ldots,n$. Mit~(\ref{eq:beobachtbarkeits-NF-beta-i}) wertet
Gl.~(\ref{eq:beob-nicht-autonom-grad-x}) die in Gl.~(\ref{eq:beob-nicht-autonom-grad-z})
beschriebenen Abhängigkeiten in den Originalkoordinaten aus. Die Anwendung
von Satz~\ref{thm:hg-Beobachtbarkeit-nicht-autonom} liefert den
Bezug zur gleichmäßigen lokalen Beobachtbarkeit.
\end{svmultproof2}

\begin{example}
Wir ergänzen das in Beispiel~\ref{exa:wagen-pendel-hg1} betrachtete
Wagen-Pendel-System um das Eingangsvektorfeld
\[
g(x)=\left(\begin{array}{c}
0\\
\frac{1}{m_{1}+m_{2}\sin^{2}x_{3}}\\
0\\
-\frac{\cos x_{3}}{l(m_{1}+m_{2}\sin^{2}x_{3})}
\end{array}\right)
\]
aus Abschnitt~\ref{subsec:Wagen-mit-Pendel}. Mit dem Vektorfeld~$f$
aus Gl.~(\ref{eq:hg-wagen-pendel-f0}) und dem Ausgang $y=h(x)=x_{1}$
berechnet man die Lie-Ableitungen 
\[
\begin{array}{lcl}
L_{g}h(x) & = & 0\\
L_{g}L_{f}h(x) & = & \frac{1}{m_{1}+m_{2}\sin^{2}x_{3}}\\
L_{g}L_{f}^{2}h(x) & = & -2\frac{m_{2}x_{4}\sin x_{3}\cos x_{3}}{(m_{1}+m_{2}\sin^{2}x_{3})^{2}},
\end{array}
\]
deren Gradienten die folgende Struktur aufweisen:
\[
\begin{array}{lcc}
\d L_{g}h & = & (\,0\,,\,0\,,\,0\,,\,0\,)\phantom{.}\\
\d L_{g}L_{f}h & = & (\,0\,,\,0\,,\,*\,,\,0\,)\phantom{.}\\
\d L_{g}L_{f}^{2}h & = & (\,0\,,\,0\,,\,*\,,\,*\,).
\end{array}
\]
Aus den ersten zwei Zeilen der Beobachtbarkeitsmatrix~(\ref{eq:wageh-pendel-hg-Qb1})
liest man $\d\xi_{1}=\d h=\d x_{1}$ und $\d\xi_{2}=\d L_{f}h=\d x_{2}$
ab. Damit ist Bedingung~(\ref{eq:beob-nicht-autonom-grad-x}) für
$i=1$ nicht erfüllt, d.\,h. aus $\d L_{g}L_{f}h\in\spann\{\d x_{3}\}$
folgt $\d L_{g}L_{f}h\notin\spann\{\d h,\d L_{f}h\}=\spann\{\d x_{1},\d x_{2}\}$.
Das System ist also nicht gleichmäßig beobachtbar.
\end{example}

\begin{remark}
Der beschriebene Zugang zum Entwurf von High-Gain-Beobachtern lässt
sich für Mehrgrößensysteme verallgemeinern~\cite{dalla-mora2000}.
Gleichzeitig zur Schätzung des Zustands ist grundsätzlich auch eine
Parameterschätzung mittels Adaption möglich~\cite{bullinger1997cdc,besancon2004}.
Erhält man für die Beobachtbarkeitsmatrix umfangreiche Ausdrücke,
so bietet sich die Berechnung mit algorithmischem Differenzieren an~\cite{rr2000nolta,roebenack2005dsmc,roebenack2005habil}.
Ist die Beobachtbarkeitsrangbedingung~(\ref{eq:Beobachtbarkeitsrangbedingung})
erfüllt, aber die Beobachtbarkeitsmatrix~(\ref{eq:Beobachtbarkeitsmatrix})
singulär, dann empfiehlt sich der Entwurf eines Einbettungsbeobachters~\cite{gauthier91}.\index{Beobachter!Einbettungs-}
\end{remark}

\section{Beobachterentwurf auf Basis der Eingangs-Ausgangs-Normalform\label{sec:High-Gain-Entwurf-Eingangs-Ausgangs-Normalform}}

\subsection{Struktur des Beobachters}

Die gleichmäßig lokale Beobachtbarkeit eines eingangsaffinen Systems~(\ref{eq:hg-system-eingangsaffin})
setzt die Zustandsäquivalenz zur Form~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
voraus. Dabei unterliegen mit Ausnahme der letzten Komponente alle
anderen Komponenten des transformierten Eingangsvektorfeldes hinsichtlich
der zulässigen Abhängigkeiten bestimmten Strukturbedingungen. Bei
einem System mit wohldefiniertem relativen Grad würde der Eingang
nur in der letzten Differentialgleichungen des ersten Teilsystems
der Eingangs-Ausgangs-Normalform in Erscheinung treten. Die vorangegangenen
Komponenten des transformierten Eingangsvektorfeldes sind dabei identisch
Null, so dass das erste Teilsystem (unter Beachtung der zusätzlichen
Abhängigkeiten vom zweiten Teilsystem) der Strukturbedingung~(\ref{eq:Beobachtbarkeits-NF-nicht-autonom})
genügt. Dieser Abschnitt behandelt die in~\cite{jo2000b,roebenack2004at,roebenack2007ndst}
vorgestellten Entwurfsverfahren, bei denen der in Abschnitt~\ref{sec:High-Gain-Entwurf-Beobachtbarkeitsnormalform}
beschriebene Beobachterentwurf von der Beobachtbarkeitsnormalform
auf die Eingangs-Ausgang- bzw. Byrnes-Isidori-Normalform übertragen
wird.

Das eingangsaffine System~(\ref{eq:hg-system-eingangsaffin}) habe
einen wohldefinierten relativen Grad $r<n$. Dann kann das System
mit einer Zustandstransformation 
\begin{equation}
\left(\begin{array}{c}
\xi\\
\eta
\end{array}\right)=\Phi(x)\label{eq:hg-EA-Phi}
\end{equation}
 in die Eingangs-Ausgangs-Normalform
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{r-1} & = & \xi_{r}\\
\dot{\xi}_{r} & = & \alpha(\xi,\eta)+\beta(\xi,\eta)u\\
\dot{\eta}_{1} & = & q_{1}(\xi,\eta)+d_{1}(\xi,\eta)u\\
 & \vdots\\
\dot{\eta}_{n-r} & = & q_{n-r}(\xi,\eta)+d_{n-r}(\xi,\eta)u\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi,\eta)+\beta(\xi,\eta)u)\\
\dot{\eta} & = & q(\xi,\eta)+d(\xi,\eta)u\\
y & = & c^{T}\xi
\end{array}\label{eq:hg-EA-NF}
\end{equation}
transformiert werden (siehe Abschnitt~\ref{subsec:Byrnes-Isidori-Normalform}).
Das erste Teilsystem besitzt weitgehend die Struktur der Beobachtbarkeitsnormalform~(\ref{eq:Beobachtbarkeits-NF-autonom}),
d.\,h., dass die Nichtlinearitäten, die hier zusätzlich über den
Eingang beeinflusst werden, nur in der letzten Zeile auftreten. Daher
wird der Beobachter für das erste Teilsystem auch in der Form analog
zu Gl.~(\ref{eq:hg-beobachter-autonom-trans}) angesetzt. Der Korrekturterm
wirkt nicht direkt auf das zweite Teilsystem. Insgesamt erhält man
dabei den Ansatz 
\begin{equation}
\begin{array}{rcl}
\dot{\hat{\xi}} & = & A\hat{\xi}+b(\alpha(\hat{\xi},\hat{\eta})+\beta(\hat{\xi},\hat{\eta})u)+l\cdot(y-\hat{\xi}_{1})\\
\dot{\hat{\eta}} & = & q(\hat{\xi},\hat{\eta})+d(\hat{\xi},\hat{\eta})u
\end{array}\label{eq:hg-EA-NF-Beobachter}
\end{equation}
mit der konstanten Beobachterverstärkung $l\in\R^{r}$. Der Beobachtungsfehler
$\tilde{\xi}=\xi-\hat{\xi}$ und $\tilde{\eta}=\eta-\hat{\eta}$ genügt
dem Differentialgleichungssystem
\begin{equation}
\begin{array}{lcl}
\dot{\tilde{\xi}} & = & \left(A-lc^{T}\right)\tilde{\xi}+b\left[\alpha(\xi,\eta)+\beta(\xi,\eta)u-\alpha(\hat{\xi},\hat{\eta})-\beta(\hat{\xi},\hat{\eta})u\right]\\
\dot{\tilde{\eta}} & = & q(\xi,\eta)+d(\xi,\eta)u-q(\hat{\xi},\hat{\eta})-d(\hat{\xi},\hat{\eta})u.
\end{array}\label{eq:hg-EA-fehler-dgl}
\end{equation}
In Anlehnung an Gl.~(\ref{eq:hg-cp}) erhält man mit $l=(a_{r-1},\ldots,a_{0})^{T}$
das charakteristische Polynom 
\begin{equation}
\begin{array}{crl}
\CP(s) & := & \det(sI-(A-lc^{T}))\\
 & = & a_{0}+a_{1}s+\cdots+a_{r-1}s^{r-1}+s^{r}\\
 & = & (s-s_{1})\cdots(s-s_{r}).
\end{array}\label{eq:hg-cp-EA-NF}
\end{equation}
Man würde Eigenwerte $s_{1},\ldots,s_{r}$, die hinreichend weit links
in der komplexen Ebene liegen, vorgeben und daraus die Koeffizienten
$p_{0},\ldots,p_{r-1}$ des charakteristischen Polynoms~(\ref{eq:hg-cp-EA-NF})
berechnen. Mit 
\[
\left(\begin{array}{c}
\dot{\hat{\xi}}\\
\dot{\hat{\eta}}
\end{array}\right)=\frac{\d}{\d t}\Phi(\hat{x})=\Phi^{\prime}(\hat{x})\cdot\dot{\hat{x}}
\]
lässt sich der Beobachter~(\ref{eq:hg-EA-NF-Beobachter}) in den
Originalkoordinaten angeben:
\begin{equation}
\begin{array}{lll}
\dot{\hat{x}} & = & \left(\Phi^{\prime}(\hat{x})\right)^{-1}\cdot\left(\begin{array}{c}
\dot{\hat{\xi}}\\
\dot{\hat{\eta}}
\end{array}\right)\\
 & = & \left(\Phi^{\prime}(\hat{x})\right)^{-1}\cdot\left(\begin{array}{c}
A\hat{\xi}+b(\alpha(\hat{\xi},\hat{\eta})+\beta(\hat{\xi},\hat{\eta})u)+l\cdot(y-\hat{\xi}_{1})\\
q(\hat{\xi},\hat{\eta})+d(\hat{\xi},\hat{\eta})u
\end{array}\right)\\
 & = & f(\hat{x})+g(\hat{x})u+\left(\Phi^{\prime}(\hat{x})\right)^{-1}\cdot\left(\begin{array}{c}
l\\
0
\end{array}\right)\cdot(y-h(\hat{x}))\\
 & =: & f(\hat{x})+g(\hat{x})u+k(\hat{x})\cdot(y-h(\hat{x})).
\end{array}\label{eq:hg-EA-Beobachter-x}
\end{equation}
Damit erhält man eine vom Beobachterzustand abhängige Beobachterverstärkung
$k:\mathcal{M}\to\R^{n}$. Anwendungen dieses Beobachteransatzes sind
beispielsweise in~\cite{gao2010,mahmud2011,ide2013,koester2015}
zu finden.

\subsection{Berechnung der Beobachterverstärkung auf Basis der Byrnes-Isidori-Normalform}

Eine besondere Situation liegt vor, wenn die Koordinatentransformation~(\ref{eq:hg-EA-Phi})
in die Eingangs-Ausgangs-Normalform~(\ref{eq:hg-EA-NF}) so gewählt
wird, dass $d\equiv0$ gilt. In diesem Fall geht~(\ref{eq:hg-EA-NF})
in die Byrnes-Isidori-Normalform 
\begin{equation}
\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi,\eta)+\beta(\xi,\eta)u)\\
\dot{\eta} & = & q(\xi,\eta)\\
y & = & c^{T}\xi
\end{array}\label{eq:hg-BI-NF}
\end{equation}
über. Dabei vereinfacht sich die Fehlerdynamik~(\ref{eq:hg-EA-fehler-dgl})
zu 
\begin{equation}
\begin{array}{lcl}
\dot{\tilde{\xi}} & = & \left(A-lc^{T}\right)\tilde{\xi}+b\left[\alpha(\xi,\eta)+\beta(\xi,\eta)u-\alpha(\hat{\xi},\hat{\eta})-\beta(\hat{\xi},\hat{\eta})u\right]\\
\dot{\tilde{\eta}} & = & q(\xi,\eta)-q(\hat{\xi},\hat{\eta}).
\end{array}\label{eq:hg-BI-NF-fehler-dgl}
\end{equation}
Der nachfolgende Satz gibt globale Konvergenzbedingungen an. Schwächere
Existenzbedingungen, die allerdings einen umfangreicheren Beweis mit
sich bringen, sind in~\cite{jo2000b} zu finden.

\begin{theorem}
\label{thm:hg-konvergenz-BI-BF}System~(\ref{eq:hg-system-eingangsaffin})
habe einen gleichmäßigen relativen Grad~$r$ auf $\mathcal{M}=\R^{n}$.
Zusätzlich sei die Transformation~(\ref{eq:hg-EA-Phi}) in die Byrnes-Isidori-Normalform~(\ref{eq:uio-BI-NF})
ein globaler Diffeomorphismus. Die Nichtlinearitäten des ersten Teilsystems
genügen einer globalen Lipschitz-Bedingung\index{Lipschitz-Bedingung}
\begin{equation}
\forall\xi,\hat{\xi},\eta,\hat{\eta},u:\quad\left\Vert \alpha(\xi,\eta)+\beta(\xi,\eta)u-\alpha(\hat{\xi},\hat{\eta})-\beta(\hat{\xi},\hat{\eta})u\right\Vert \leq\rho\left\Vert \xi-\hat{\xi}\right\Vert \label{eq:hg-BI-NF-Lipschitz}
\end{equation}
gleichmäßig in $\eta,\hat{\eta},u$. Existieren eine global positiv
definite Funktion~$V_{2}$ und Funktionen $\gamma_{1},\gamma_{2}$
der Klasse~$\mathcal{K}_{\infty}$ derart, dass die Zeit\-ableitung
von~$V_{2}(\tilde{\eta})$ entlang der Fehlerdynamik~(\ref{eq:hg-BI-NF-fehler-dgl})
der Bedingung 
\begin{equation}
\forall\tilde{\xi},\tilde{\eta}:\quad\dot{V}_{2}\leq-\gamma_{1}(\|\tilde{\eta}\|)+\gamma_{2}(\|\tilde{\xi}\|)\label{eq:hg-BI-NF-dV}
\end{equation}
genügt, dann existiert eine Beobachterverstärkung $l\in\R^{r}$ derart,
dass der Beobachter~(\ref{eq:hg-EA-Beobachter-x}) global konvergiert.
\end{theorem}
\begin{proofsketch}Mit der Bedingung~(\ref{eq:hg-BI-NF-Lipschitz})
lässt sich die globale asympotitsche Stabilität der Ruhelage $\tilde{\xi}=0$
des ersten Teilsystems der Fehler\-dynamik~(\ref{eq:hg-BI-NF-fehler-dgl})
analog zu Satz~\ref{thm:hg-konvergenz-autonom} zeigen. Nach Gl.~(\ref{eq:hg-BI-NF-dV})
ist das zweite Teilsystem der Fehlerdynamik~(\ref{eq:hg-BI-NF-fehler-dgl})
eingangs-zustands-stabil bezüglich~$\tilde{\xi}$. Aufgrund der Kaskaden\-struktur
ist die Ruhelage $(\tilde{\xi},\tilde{\eta})=(0,0)$ der Fehlerdynamik~(\ref{eq:hg-BI-NF-fehler-dgl})
global asymptotisch stabil.\end{proofsketch}

Die Bedingung~(\ref{eq:hg-BI-NF-dV}), welche die Eingangs-Zustands-Stabilität
des zweiten Teilsystems der Fehlerdynamik sichert, gewährleistet die
Ermittelbarkeit des Gesamtsystems~\cite{amicucci1998,sontag97oss}.
Hinsichtlich des zweiten Teilsystems der Regelstrecke~(\ref{eq:hg-BI-NF})
entspricht die Bedingung~(\ref{eq:hg-BI-NF-dV}) einer inkrementellen
Eingangs-Zustands-Stabilität~\cite{Angeli2002}.

\begin{example}
\label{exa:isidori434-HG-BI-NF}Das folgende Beispielsystem entstammt
aus~\cite[S.~{167}]{isidori3}:
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{3}-x_{2}^{3}\\
\dot{x}_{2} & = & -x_{2}-x_{3}^{2}u\\
\dot{x}_{3} & = & -x_{3}+x_{1}^{2}+u\\
y & = & x_{1}.
\end{array}\label{eq:isidori434-system}
\end{equation}
Mit $L_{g}h(x)=0$ und $L_{g}L_{f}h(x)=1+3x_{2}^{2}x_{3}^{2}>0$ ist
der relative Grad $r=2$ im gesamten Zustandsraum $\mathcal{M}=\R^{3}$
wohldefiniert. Zur Transformation in die Byrnes-Isidori-Normalform
ist eine Funktion~$\phi_{3}$ gesucht, welche die partielle Differentialgleichung
\[
L_{g}\phi_{3}(x)=-x_{3}^{2}\frac{\partial\phi_{3}(x)}{\partial x_{2}}+\frac{\partial\phi_{3}(x)}{\partial x_{3}}=0
\]
erfüllt. Eine mögliche Wahl ist $\phi_{3}(x)=x_{2}+x_{3}^{3}/3$.
Die zugehörige Transformation~(\ref{eq:hg-EA-Phi}) lautet 
\[
\Phi(x)=\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
\phi_{3}(x)
\end{array}\right)=\left(\begin{array}{c}
x_{1}\\
x_{3}-x_{2}^{3}\\
x_{2}+\frac{1}{3}x_{3}^{3}
\end{array}\right).
\]
Aus der Jacobimatrix
\begin{equation}
\Phi^{\prime}(x)=\left(\begin{array}{ccc}
1 & 0 & 0\\
0 & -3x_{2}^{2} & 1\\
0 & 1 & x_{3}^{2}
\end{array}\right)\label{eq:isidori434-dPhi}
\end{equation}
ergibt sich die auf ganz~$\mathcal{M}$ definierte Beobachterverstärkung
\begin{equation}
k(\hat{x})=\left(\Phi^{\prime}(\hat{x})\right)^{-1}\left(\begin{array}{c}
a_{1}\\
a_{0}\\
0
\end{array}\right)=\left(\begin{array}{c}
a_{1}\\
-\frac{a_{0}\hat{x}_{3}^{2}}{1+3\hat{x}_{2}^{2}\hat{x}_{3}^{2}}\\
\frac{a_{0}}{1+3\hat{x}_{2}^{2}\hat{x}_{3}^{2}}
\end{array}\right)\label{eq:isidori434-k-BINF}
\end{equation}
mit den Koeffizienten $a_{0},a_{1}>0$.
\end{example}

\begin{example}
\label{exa:Wagen-Pendel-HG-BINF}Wir betrachten das gedämpfte Wagen-Pendel-System
aus Abschnitt~\ref{subsec:Wagen-mit-Pendel}. Für den Ausgang $y=x_{1}$
(Position der Last) besitzt das System den relativen Grad $r=2$ (siehe
Beispiel~\ref{exa:Wagen-Pendel-partielle-Linearisierung}). In Beispiel~\ref{exa:Wagen-Pendel-System-BINF}
wurde für das partiell linearisierte Systeme die Transformation
\[
\Phi(x)=\left(\begin{array}{c}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}+\frac{1}{l}x_{2}\cos x_{3}
\end{array}\right)\quad\text{mit}\quad\Phi^{\prime}(x)=\left(\begin{array}{cccc}
1 & 0 & 0 & 0\\
0 & 1 & 0 & 0\\
0 & 0 & 1 & 0\\
0 & -\frac{1}{l}\cos x_{3} & \frac{x_{2}}{l}\cos x_{3} & 1
\end{array}\right)
\]
in die Byrnes-Isidori-Normalform berechnet. Diese Transformation überführt
auch das nicht partiell linearisierte Originalsystem in die Byrnes-Isidori-Normalform.
Das ist daran zu erkennen, dass die letzten $n-r=2$ Komponenten des
transformierten Eingangsvektorfelds verschwinden:
\[
\Phi_{*}g(x)=\Phi^{\prime}(x)g(x)=\left(\begin{array}{c}
0\\
\frac{1}{m_{1}+m_{2}\sin^{2}x_{3}}\\
0\\
0
\end{array}\right).
\]
Aus Gl.~(\ref{eq:hg-EA-Beobachter-x}) ergibt sich die Beobachterverstärkung
\[
k(\hat{x})=\left(\Phi^{\prime}(\hat{x})\right)^{-1}\cdot\left(\begin{array}{c}
a_{1}\\
a_{0}\\
\hline 0\\
0
\end{array}\right)=\left(\begin{array}{c}
a_{1}\\
a_{0}\\
0\\
-\frac{a_{0}}{l}\cos\hat{x}_{3}
\end{array}\right)
\]
mit $a_{0},a_{1}>0$. Es ist zu erwarten, dass der Beobachter hinsichtlich
des zweites Teilsystems, welches maßgeblich vom rotatorischen Teil
bestimmt wird, aufgrund der Dämpfung (Reibung) konvergiert. 
\end{example}

\subsection{Berechnung der Beobachterverstärkung mit der Moore-Penrose-Inversen}

Die bei der Transformation in die Eingangs-Ausgangs-Normalform~(\ref{eq:hg-EA-NF})
bestehenden Freiheitsgrade für die Koordinaten des zweiten Teilsystems
lassen sich auch nutzen, um eine möglichst einfache Berechnungsvorschrift
für die in Gl.~(\ref{eq:hg-EA-Beobachter-x}) definierte Beobachterverstärkung~$k$
zu erhalten~\cite{roebenack2004at,roebenack2007ndst}. In diesen
Zusammenhang fällt auf, dass die Jacobimatrix~$\Phi^{\prime}$ der
Transformation~(\ref{eq:hg-EA-Phi}) in den ersten $r$ Zeilen mit
der Beobachtbarkeitsmatrix~$Q_{B}$ übereinstimmt. Diese $r$ Zeilen
definieren die \emph{reduzierte} \emph{Beobachtbarkeitsmatrix}\index{Beobachtbarkeitsmatrix!reduzierte}
\[
Q(x)=\left(\begin{array}{c}
\d h(x)\\
\d L_{f}h(x)\\
\vdots\\
\d L_{f}^{r-1}h(x)
\end{array}\right).
\]
Bei einem im Punkt $p\in\mathcal{M}$ wohldefinierten relativen Grad
sind die Zeilen dieser Matrix linear unabhängig (Lemma~\ref{lem:Lin-Unabh-Kovektoren}).
Die verbleibenden $n-r$ Zeilen von~$\Phi^{\prime}$ fassen wir in
einer $(n-r)\times n$-Matrix
\[
R(x)=\left(\begin{array}{c}
\d\phi_{r+1}(x)\\
\vdots\\
\d\phi_{n}(x)
\end{array}\right)
\]
zusammen. Die Zeilen der Matrix~$Q$ bestehen nach Konstruktion aus
exakten Kovektorfeldern. Nach Korollar~\ref{cor:ergaenzung-einer-kodistribution-integrierbar}
lassen sich die Zeilen der Matrix~$R$ so wählen, dass die $n\times n$-Gesamtmatrix
\begin{equation}
\Phi^{\prime}(x)=\left(\begin{array}{c}
Q(x)\\
R(x)
\end{array}\right)\label{eq:hg-EA-QR-Jac}
\end{equation}
regulär ist und zusätzlich die Zeilen von~$Q$ und~$R$ senkrecht
aufeinander stehen, z.\,B. es gilt 
\begin{equation}
R(x)\cdot Q^{T}(x)=0\label{eq:hg-EA-QR-orth}
\end{equation}
für alle~$x$ aus einer Umgebung von~$p$. Wegen dieser Orthogonalität
kann man die Inverse der Jacobimatrix~(\ref{eq:hg-EA-QR-Jac}) blockweise
über die \index{Moore-Penrose-Inverse}\emph{Moore-Penrose-Inversen}~$Q^{+}$
und~$R^{+}$ der Matrizen~$Q$ und~$R$ beschreiben~\cite{boullion71,rao71,ben-israel}:
\[
\left(\begin{array}{c}
Q(x)\\
R(x)
\end{array}\right)^{-1}=\left(Q^{+}(x)\,|\,R^{+}(x)\right).
\]
Dann vereinfacht sich die Beobachterverstärkung zu
\begin{equation}
k(x)=\left(\Phi^{\prime}(x)\right)^{-1}\cdot\left(\begin{array}{c}
l\\
0
\end{array}\right)=\left(Q^{+}(x)\,|\,R^{+}(x)\right)\cdot\left(\begin{array}{c}
l\\
0
\end{array}\right)=Q^{+}(x)\cdot l,\label{eq:hg-k-Moore-Penrose-Inverse}
\end{equation}
so dass für deren Berechnung die Matrix~$R$ nicht explizit benötigt
wird. Da die reduzierte Beobachtbarkeitsmatrix~$Q$ vollen Zeilenrang
besitzt, lässt sich deren Moore-Penrose-Inverse folgendermaßen berechnen:
\[
Q^{+}=Q^{T}\left(QQ^{T}\right)^{-1}.
\]

\begin{example}
\label{exa:isidori434-HG-MPPI}Das System~(\ref{eq:isidori434-system})
aus Beispiel~\ref{exa:isidori434-HG-BI-NF} hat den relativen Grad
$r=2$. Daraus ergibt sich die reduzierte Beobachtbarkeitsmatrix 
\[
Q(x)=\left(\begin{array}{c}
\d h(x)\\
\d L_{f}h(x)
\end{array}\right)=\left(\begin{array}{ccc}
1 & 0 & 0\\
0 & -3x_{2}^{2} & 1
\end{array}\right),
\]
vgl. Gl.~(\ref{eq:isidori434-dPhi}). Nach Gl.~(\ref{eq:hg-k-Moore-Penrose-Inverse})
erhält man die Beobachterverstärkung 
\begin{equation}
k(\hat{x})=Q^{+}(x)\cdot\left(\begin{array}{c}
a_{1}\\
a_{0}
\end{array}\right)=\left(\begin{array}{c}
a_{1}\\
-\frac{3a_{0}\hat{x}_{2}^{2}}{1+9\hat{x}_{2}^{4}}\\
\frac{a_{0}}{1+9\hat{x}_{2}^{4}}
\end{array}\right),\label{eq:isidori434-k-MPPI}
\end{equation}
Dieses Ergebnis wird von der mit \textsc{Maxima} durchgeführten Kontrollrechnung
bestätigt:

\begin{maxima}\input{HG_Isidori2.tex}\end{maxima}

Kombiniert man den Beobachter~(\ref{eq:hg-EA-Beobachter-x}) mit
einem Regelgesetz entsprechend Abschnitt~\ref{sec:E-A-Linearisierung-affin},
dann ist sowohl mit der Beobachterverstärkung~(\ref{eq:isidori434-k-BINF})
aus Beispiel~\ref{exa:isidori434-HG-BI-NF} als auch mit der Beobachterverstärkung~(\ref{eq:isidori434-k-MPPI})
eine Stabilisierung der Ruhelage $x=0$ möglich~\cite{roebenack2004at}.
\end{example}

\begin{example}
\label{exa:Wagen-Pendel-HG-MPPI}Für das gedämpfte Wagen-Pendel-System
aus Beispiel~\ref{exa:Wagen-Pendel-HG-BINF} erhält man aus der reduzierten
Beobachtbarkeitsmatrix
\[
Q(x)=\left(\begin{array}{cccc}
1 & 0 & 0 & 0\\
0 & 1 & 0 & 0
\end{array}\right)
\]
die sehr einfache (nämlich konstante) Beobachterverstärkung
\[
k(\hat{x})=\left(\begin{array}{c}
a_{1}\\
a_{0}\\
0\\
0
\end{array}\right)
\]
mit $a_{0},a_{1}>0$. Die dem translatorischen Teilsystem zugeordneten
Beobachterzustände $\hat{x}_{1},\hat{x}_{2}$ werden über diese Beobachterverstärkung
direkt beeinflusst. Die das rotatorische Teilsystem beschreibenden
Beobachterzustände $\hat{x}_{3},\hat{x}_{4}$ werden als Simulationsterm,
der vom ersten Teilsystem über~$\hat{x}_{2}$ angeregt wird, mitgeführt.
Unter Annahme einer geeigneten Dämpfung konvergiert der Beobachter.
\end{example}

\section{Beobachterentwurf bei unbekanntem Eingang}

Bei den bisher behandelten Beobachtern wurde davon ausgegangen, dass
man bei einem System mit Eingang diesen auch messen kann. Schätzt
ein Beobachter den Systemzustand bei Messung des Ausgangs~$y$, aber
ohne Kenntnis des (vorhandenen) Systemeingangs~$u$ (vgl. Abb.~\ref{fig:uio-struktur}),
so spricht man von einem \emph{Beobachter mit unbekanntem Eingang}\index{Beobachter!mit unbekanntem Eingang}
(engl. \emph{unkown input observer}, kurz \emph{UIO}) oder einem \emph{starken
Beobachter} (engl. \emph{strong observer}). Diese Art des Beobachters
setzt man ein, wenn die messtechnische Erfassung der Eingangsgröße
sehr aufwendig bzw. nicht möglich ist. Die Existenzbedingungen und
der Beobachterentwurf werden für lineare Systeme in einem kürzlich
erschienenen Übersichtsbeitrag beschrieben~\cite{lunze2017at}. Dieser
Abschnitt befasst sich mit der Berechnung eines starken Beobachters
für eine spezielle Klasse nicht\-linearer Systeme~\cite{moreno2000UnknownInput}.

\begin{figure}
\begin{centering}
\resizebox{0.55\textwidth}{!}{\input{uio.pdftex_t}}
\par\end{centering}
\caption{Zustandsbeobachtung bei unbekanntem Eingang\label{fig:uio-struktur}}

\end{figure}

Man betrachtet das eingangsaffine Eingrößensystem~(\ref{eq:hg-system-eingangsaffin}).
Bei wohldefiniertem relativen Grad~$r$ existiert immer eine Transformation~(\ref{eq:hg-EA-Phi}),
die das System in die Byrnes-Isidori-Normalform~(\ref{eq:hg-BI-NF})
überführt. Im Fall $r=1$ gilt $\xi=\xi_{1}=y$, d.\,h. der eindimensionale
Zustand des ersten Teilsystems ist der Ausgang. Damit lässt sich die
Byrnes-Isidori-Normalform~(\ref{eq:hg-BI-NF}) auch folgendermaßen
angeben: 
\begin{equation}
\begin{array}{rcl}
\dot{y} & = & \alpha(y,\eta)+\beta(y,\eta)u\\
\dot{\eta} & = & q(y,\eta)
\end{array}\label{eq:uio-BI-NF}
\end{equation}
Der starke Beobachter 
\begin{equation}
\begin{array}{ccl}
\dot{\hat{\eta}} & = & q(y,\hat{\eta})\\
\hat{x} & = & \Phi^{-1}(y,\hat{\eta})
\end{array}\label{eq:uio-beobachter}
\end{equation}
besteht aus einer Kopie des zweiten Teilsystems von~(\ref{eq:uio-BI-NF}),
welches direkt vom gemessenen Ausgang~$y$ erregt wird. Da das zweite
Teilsystem bei $r=1$ die Dimension $n-1$ besitzt, handelt es sich
um einen reduzierten Beobachter\index{Beobachter!reduzierter}. Bemerkenswert
ist, dass beim Beobachter kein Einstellparameter (z.\,B. in Form
einer Beobachterverstärkung) auftritt. Mit der Rücktransformation~$\Phi^{-1}$
erhält man den Schätzwert des Zustands in den Originalkoordinaten.

Für die Untersuchung der Konvergenz des Beobachters ist lediglich
das zweite Teilsystem zu betrachten. Mit $\tilde{\eta}=\eta-\hat{\eta}$
erhält man die Fehlerdifferentialgleichung
\begin{equation}
\dot{\tilde{\eta}}=q(y,\eta)-q(y,\hat{\eta}),\label{eq:uio-fehler-dgl}
\end{equation}
deren Konvergenz der Gegenstand des folgenden Satzes ist:
\begin{theorem}
\label{thm:uio-konvergenz-global}System~(\ref{eq:hg-system-eingangsaffin})
habe einen gleichmäßigen relativen Grad $r=1$ auf $\mathcal{M}=\R^{n}$.
Zusätzlich sei die Transformation~(\ref{eq:hg-EA-Phi}) in die Byrnes-Isidori-Normalform~(\ref{eq:uio-BI-NF})
ein globaler Diffeomorphismus. Existieren eine global positiv definite
Funktion~$V$ und eine Funktion~$\gamma$ der Klasse~$\mathcal{K}_{\infty}$
derart, dass die Zeit\-ableitung von~$V(\tilde{\eta})$ entlang
der Fehlerdynamik~(\ref{eq:uio-fehler-dgl}) der Bedingung 
\begin{equation}
\forall\eta,\hat{\eta}:\quad\dot{V}(\eta,\hat{\eta})\leq-\gamma(\|\eta-\hat{\eta}\|)\label{eq:uio-dV}
\end{equation}
genügt, dann konvergiert der Beobachter~(\ref{eq:uio-beobachter})
global.
\end{theorem}
\begin{svmultproof2}
Bei gleichmäßigem relativen Grad und einer globalen Transformation
kann die Konvergenzuntersuchung in den Koordinaten der Bynres-Isidori-Normalform
erfolgen. Die Funktion~$V$ ist eine strenge Ljapunov-Funktion für
das Fehlersystem~(\ref{eq:uio-fehler-dgl}). Mit~(\ref{eq:uio-dV})
ist die Ruhelage $\tilde{\eta}=0$ von~(\ref{eq:uio-fehler-dgl})
global asymptotisch stabil (vgl. Anhang~\ref{sec:Stabilitaet-autonomer-Systeme}).
Damit konvergiert der Beobachter~(\ref{eq:uio-beobachter}) global.
\end{svmultproof2}

Die Funktion eines starken Beobachters wird an folgendem Beispiel
illustriert:
\begin{example}
Das Hodgkin-Huxley-Modell beschreibt das Aktionspotential eines Neurons~\cite{hodgkin1952}.
Das Aktionspotential ist eine Spannung~$U$, die zwischen dem Inneren
und dem Äußeren der Zelle abfällt. Die Zellmembran wirkt als Kondensator
mit dem Kapazitätsbelag $C=1\,\text{\ensuremath{\mu}F}/\text{cm}^{2}$.
Die Dynamik des Aktionspotentials lässt sich durch die Differentialgleichung
\begin{equation}
C\dot{U}=I-I_{\text{Na}}-I_{\text{K}}-I_{\text{L}}\label{eq:uio-hodgkin1}
\end{equation}
beschreiben. Dabei wird die Stromdichte in die Zelle (z.\,B. durch
äußere Erregung) mit~$I$ bezeichnet. Die Bewegung von \hbox{Natrium-}
bzw. Kalium\-ionen verursacht die Stromdichten~$I_{\text{Na}}$
bzw.~$I_{\text{K}}$. Zusätzlich enthält das Modell eine Leckstromdichte~$I_{\text{L}}$.
Die letztgenannten Stromdichten werden durch die Gleichungen
\begin{equation}
\begin{array}{lcl}
I_{\text{Na}} & = & g_{\text{Na}}m^{3}h\left(U-U_{\text{Na}}\right)\\
I_{\text{K}} & = & g_{\text{K}}n^{4}\left(U-U_{\text{K}}\right)\\
I_{\text{L}} & = & g_{\text{L}}\left(U-U_{\text{L}}\right)
\end{array}\label{eq:uio-hodgkin2}
\end{equation}
mit den flächenbezogenenen Leitwerten $g_{\text{Na}}=120\,\text{mS}/\text{cm}^{2}$,
$g_{\text{K}}=36\,\text{mS}/\text{cm}^{2}$, $g_{\text{L}}=0,3\,\text{mS}/\text{cm}^{2}$
und den Spannungen $U_{\text{Na}}=50\,\text{mV}$, $U_{\text{K}}=-77\,\text{mV}$,
$U_{\text{L}}=-54,4\,\text{mV}$ beschrieben. Die Durchlässigkeit
der Ionenkanäle wird durch die Zustände $m,h,n$ und das Markovmodell
\begin{equation}
\begin{array}{ccl}
\dot{m} & = & \alpha_{m}(U)\,(1-m)-\beta_{m}(U)\,m\\
\dot{h} & = & \alpha_{h}(U)\,(1-h)-\beta_{h}(U)\,h\\
\dot{n} & = & \alpha_{n}(U)\,(1-n)-\beta_{n}(U)\,n
\end{array}\label{eq:uio-hoghkin3}
\end{equation}
mit den Übergangsraten 
\begin{equation}
\begin{array}{lcl}
\alpha_{m}(U) & = & 0,1(U+40)/(1-\exp(-(U+40)/10)),\\
\beta_{m}(U) & = & 4\exp(-(U+65)/18),\\
\alpha_{h}(U) & = & 0,07\exp(-(U+65)/20),\\
\beta_{h}(U) & = & 1/(1+\exp(-(U+35)/10)),\\
\alpha_{n}(U) & = & 0,01(U+55)/(1-\exp(-(U+55)/10)),\\
\beta_{n}(U) & = & 0,125\exp(-(U+65)/80)
\end{array}\label{eq:uio-hodgkin4}
\end{equation}
modelliert. Die Spannung~$U$ ist dabei auf $\text{mV}$ normiert.
Das zu den Modellgleichungen~(\ref{eq:uio-hodgkin1}) und~(\ref{eq:uio-hodgkin2})
gehörende elektrische Ersatzschaltbild ist in Abb.~\ref{fig:hodgkin-huxley-netzwerk}
dargestellt.

\begin{figure}
\begin{centering}
\resizebox{0.5\textwidth}{!}{\input{hodgkin-huxley-modell.pdftex_t}}
\par\end{centering}
\caption{Ersatznetzwerk des Hodgkin-Huxley-Modells\label{fig:hodgkin-huxley-netzwerk}}

\end{figure}

Mit dem Ausgang $y=U$ liegt das durch Gln.~(\ref{eq:uio-hodgkin1})
bis~(\ref{eq:uio-hodgkin4}) beschriebene Modell bereits in der Byrnes-Isidori-Normalform
vor. Für die Simulation des Systems verwenden wir die Anfangswerte
$U(0)=-61,733\,\text{mV}$, $m(0)=0,0722$, $h(0)=0,4794$, $n(0)=0,3687$
und das Eingangssignal
\[
I(t)=\left\{ \begin{array}{rcl}
5 & \text{für} & 0\leq t\leq100\\
10 & \text{für} & t>100
\end{array}\right.
\]
mit der Zeit~$t$ in $\text{ms}$ und der Stromdichte~$I$ in $\text{\ensuremath{\mu}A}/\text{cm}^{2}$.
Zum Zeitpunkt $t=100$ wird die Zelle stimuliert. Der zugehörige Spannungsverlauf
ist in Abb.~\ref{fig:hodgkin-huxley-simulation} (oben) dargestellt.

Den Beobachter setzt man einfach als Kopie des Systems~(\ref{eq:uio-hoghkin3})
an, wobei man die Zustände $m,h,n$ in $\hat{m},\hat{h},\hat{n}$
umbenennt. Zur Überprüfung der Konvergenzbedingung~(\ref{eq:uio-dV})
setzen wir~$V$ als quadratische Form $V(\tilde{\eta})=\tfrac{1}{2}\sum_{i=1}^{3}\tilde{\eta}_{i}^{2}$
mit $\tilde{\eta}=(\tilde{m},\tilde{h},\tilde{n})^{T}$ an. Damit
ist~$V$ global positiv definit. Für die Zeitableitung von~$V$
entlang der sich aus~(\ref{eq:uio-hoghkin3}) ergebenden Fehlerdynamik
gilt 
\begin{equation}
\dot{V}=\sum_{i=1}^{3}\tilde{\eta}_{i}\dot{\tilde{\eta}}_{i}=-\sum_{i=1}^{3}\left(\alpha_{i}(U)+\beta_{i}U)\right)\tilde{\eta}_{i}^{2}\leq-\mu\|\tilde{\eta}\|^{2}\label{eq:uio-hodgkin-dV}
\end{equation}
mit $\mu:=\inf_{i,U}(\alpha_{i}(U)+\beta_{i}U))>0$, wobei die Funktionen~(\ref{eq:uio-hodgkin4})
entsprechend der Gleichungssnummer in~(\ref{eq:uio-hoghkin3}) notiert
wurden, d.\,h. $\alpha_{1}=\alpha_{m},\ldots,\beta_{3}=\beta_{n}$.
Mit~(\ref{eq:uio-hodgkin-dV}) ist Bedingung~(\ref{eq:uio-dV})
erfüllt, so dass der Beobachter global konvergiert. Für die Simulation
des Beobachter wird der Anfangsvektor $\hat{\eta}=0\in\R^{3}$ gewählt.
In Abb.~\ref{fig:hodgkin-huxley-simulation} (unten) ist zu sehen,
dass die Beobachtertrajektorien schnell gegen die Systemtrajektorien
konvergieren.

\begin{figure}
\begin{centering}
\includegraphics[width=0.95\textwidth]{Hodgkin_Sim}
\par\end{centering}
\caption{Simulierter Spannungsverlauf des Hodgkin-Huxley-Modells (oben), Trajektorien
der internen Dynamik von System und Beobachter (unten)\label{fig:hodgkin-huxley-simulation}}

\end{figure}
\end{example}

\begin{remark}
Der starke Beobachter~(\ref{eq:uio-beobachter}) lässt sich dahingehend
erweitern, dass man simultan auch eine (nicht asymptotische) Schätzung
des Eingangs erhält. Dabei nutzt man Beobachter-Filter-Kombinationen,
die in~\cite{goel2005tech,roebenack2007medjmc,roebenack2009ijss,roebenack2009ndst}
an verschiedenen Zellmodellen erprobt werden.
\end{remark}

\bibliographystyle{babalpha}
\bibliography{dynamic}

