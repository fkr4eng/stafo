#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass svmono
\options german,deutsch,sectrefs
\use_default_options true
\maintain_unincluded_children false
\language ngerman
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language german
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Erweiterte Regelungskonzepte auf Basis der exakten Linearisierung
\begin_inset CommandInset label
LatexCommand label
name "chap:regler-varianten"

\end_inset


\end_layout

\begin_layout Standard
Aufbauend auf den in Kapitel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:regler-grundlagen"

\end_inset

 entwickelten Konzepten (relativer Grad und bestimmte Normalformen) lassen
 sich etliche verschiedene Regler realisieren und damit auch unterschiedliche
 regelungstechnische Aufgabenstellungen lösen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "henson1997chap4"

\end_inset

.
 In diesem Kapitel werden verschiedene Regelungskonzepte, die auf der exakten
 Linearisierung aufbauen, vorgestellt.
 Den nachfolgenden Betrachtungen wird ein eingangsaffines Modell für die
 Regelstrecke zugrunde gelegt.
 Während für theoretische Untersuchungen die Byrnes-Isidori-Normalform bevorzugt
 wird, erfolgen praktische Berechnung oft mit der Eingangs-Ausgangs-Normalform.
 Daher sind die vorgestellten Entwurfsverfahren auch leicht auf nicht eingangsaf
fine Systeme zu übertragen.
\end_layout

\begin_layout Section
Trajektorienfolgeregelung mittels Rückführung (Feed\SpecialChar softhyphen
back)
\begin_inset CommandInset label
LatexCommand label
name "sec:Trajektorienfolgeregelung-Feedback"

\end_inset


\end_layout

\begin_layout Subsection
Ausgangsfolgeregelung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ausgangsfolgeregelung"

\end_inset


\end_layout

\begin_layout Standard
Man betrachte eine eingangsaffine Regelstrecke der Form
\begin_inset Formula 
\begin{equation}
\dot{x}=f(x)+g(x)u,\quad y=h(x)\label{eq:var-basissystem}
\end{equation}

\end_inset

mit glatten Vektorfeldern 
\begin_inset Formula $f,g,:\mathcal{M}\to\R^{n}$
\end_inset

 und einem glatten Skalarfeld 
\begin_inset Formula $h:\mathcal{M}\to\R$
\end_inset

, wobei die Felder auf einer offenen Menge 
\begin_inset Formula $\mathcal{M}\subseteq\R^{n}$
\end_inset

 definiert sind.
 Auf Basis der Eingangs-Ausgangs-Linearisierung wird nachfolgend eine Ausgangsfo
lgeregelung entworfen.
 Der Systemausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $y$
\end_inset

 soll sich dabei asymp\SpecialChar softhyphen
totisch einem Referenzverlauf 
\begin_inset Formula $y_{\text{ref}}:[0,\infty)\to\R$
\end_inset

 annähern.
 Die Darstellung beruht auf
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
after "Abschn.~{4.5}"
key "isidori3"

\end_inset

.
\end_layout

\begin_layout Standard
System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 habe einen wohldefinierten relativen Grad 
\begin_inset Formula $r\leq n$
\end_inset

.
 Dann kann das System mit einer Zustandstransformation 
\begin_inset Formula $(\xi,\eta)=\Phi(x)$
\end_inset

 in die Byrnes-Isidori-Normalform
\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!Byrnes-Isidori-
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{r-1} & = & \xi_{r}\\
\dot{\xi}_{r} & = & \alpha(\xi,\eta)+\beta(\xi,\eta)u\\
\dot{\eta}_{1} & = & q_{1}(\xi,\eta)\\
 & \vdots\\
\dot{\eta}_{n-r} & = & q_{n-r}(\xi,\eta)\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi,\eta)+\beta(\xi,\eta)u)\\
\dot{\eta} & = & q(\xi,\eta)\\
y & = & c^{T}\xi
\end{array}\label{eq:var-BI-NF}
\end{equation}

\end_inset

transformiert werden (siehe Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Byrnes-Isidori-Normalform"

\end_inset

).
 Mit der Eingangs-Ausgangs-Linearisierung 
\begin_inset Formula 
\begin{equation}
u=\frac{1}{\beta(\xi,\eta)}\left(v-\alpha(\xi,\eta)\right)=\frac{1}{L_{g}L_{f}^{r-1}h(x)}\left(v-L_{f}^{r}h(x)\right)\label{eq:var-linearisierung-FB}
\end{equation}

\end_inset

kompensiert man die im ersten Teilsystem von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 auftretenden Nichtlinearitäten derart, dass das Eingangs-Ausgangs-Verhalten
 durch die Integratorkette
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{r-1} & = & \xi_{r}\\
\dot{\xi}_{r} & = & v\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+bv\\
y & = & c^{T}\xi
\end{array}\label{eq:var-TS1-EA-linearisiert}
\end{equation}

\end_inset

beschrieben wird.
\end_layout

\begin_layout Standard
Zur Beschreibung des Folgeverhaltens wird der Fehler 
\begin_inset Formula 
\begin{equation}
\varepsilon(t):=y(t)-y_{\text{ref}}(t)\quad\text{für}\quad t\geq0\label{eq:var-ausgangsfehler}
\end{equation}

\end_inset

als Differenz zwischen System- und Referenzausgang eingeführt.
 Für den Zeitverlauf des Fehlers
\begin_inset space ~
\end_inset


\begin_inset Formula $\varepsilon$
\end_inset

 geben wir eine Fehlerdynamik in Form einer linearen zeitinvarianten Differentia
lgleichung 
\begin_inset Formula 
\begin{equation}
\varepsilon^{(r)}(t)+a_{r-1}\varepsilon^{(r-1)}(t)+\cdots+a_{1}\dot{\varepsilon}(t)+a_{0}\varepsilon(t)=0\label{eq:var-fehlerdynamik}
\end{equation}

\end_inset

der Ordnung
\begin_inset space ~
\end_inset


\begin_inset Formula $r$
\end_inset

 vor.
 Die Koeffizienten 
\begin_inset Formula $a_{0},\ldots a_{r-1}\in\R$
\end_inset

 sind dabei so zu wählen, dass das zu
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 gehörende charakteristische Polynom ein Hurwitz-Polynom ist.
 Dann gilt 
\begin_inset Formula 
\[
\lim_{t\to\infty}\varepsilon(t)\to0
\]

\end_inset

für alle Anfangswerte von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

, wodurch das asymptotische Folgeverhalten gewährleistet ist.
\end_layout

\begin_layout Standard
Die gewünschte Fehlerdynmik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 ist jetzt noch in das System einzuprägen.
 Der vorgegebene Referenzverlauf 
\begin_inset Formula $y_{\text{ref}}:[0,\infty)\to\R$
\end_inset

 des Ausgangs sei 
\begin_inset Formula $r$
\end_inset

 mal stetig differenzierbar.
 Aus
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-ausgangsfehler"

\end_inset

 folgt unmittelbar 
\begin_inset Formula $\varepsilon^{(i)}(t)=y^{(i)}(t)-y_{\text{ref}}^{(i)}(t)$
\end_inset

 für 
\begin_inset Formula $i=0,\ldots,r$
\end_inset

.
 Für die Integratorkette
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-TS1-EA-linearisiert"

\end_inset

 ergibt sich daraus der Eingangsverlauf
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
v(t) & = & y^{(r)}(t)\\
 & = & y_{\text{ref}}^{(r)}(t)+\varepsilon^{(r)}(t)\\
 & = & y_{\text{ref}}^{(r)}(t)-a_{r-1}\varepsilon^{(r-1)}(t)-\cdots-a_{1}\dot{\varepsilon}(t)-a_{0}\varepsilon(t).
\end{array}\label{eq:var-PD-verallg}
\end{equation}

\end_inset

Ersetzt man die Zeitableitungen des Systemausgangs durch Lie-Ableitungen
 
\begin_inset Formula $y^{(i)}(t)=L_{f}^{i}h(x(t))$
\end_inset

 für 
\begin_inset Formula $i=1,\ldots,r-1$
\end_inset

 und bezieht die linearisierende Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-linearisierung-FB"

\end_inset

 ein, so erhält man das Regelgesetz 
\begin_inset Formula 
\begin{equation}
u=\frac{1}{L_{g}L_{f}^{r-1}h(x)}\left(y_{\text{ref}}^{(r)}(t)-L_{f}^{r}h(x)+\sum_{i=0}^{r-1}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)\right).\label{eq:folgeregelung-feedback}
\end{equation}

\end_inset

Dieses Regelgesetz kann man als Linearkombination 
\begin_inset Formula 
\[
u=u_{\text{steuer}}+u_{\text{stab}}
\]

\end_inset

eines Anteils zur Vorsteuerung
\begin_inset Formula 
\begin{equation}
u_{\text{steuer}}=\frac{1}{L_{g}L_{f}^{r-1}h(x)}\left(y_{\text{ref}}^{(r)}(t)-L_{f}^{r}h(x)\right)\label{eq:u-steuer-FB}
\end{equation}

\end_inset

und eines Anteils zur asymptotischen Stabilisierung 
\begin_inset Formula 
\begin{equation}
u_{\text{stab}}=\frac{1}{L_{g}L_{f}^{r-1}h(x)}\sum_{i=0}^{r-1}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)\label{eq:u-stab-FB}
\end{equation}

\end_inset

auffassen.
 Man spricht dabei von einer 
\emph on
Struktur mit zwei Freiheits\SpecialChar softhyphen
graden
\emph default

\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "horowitz1963synthesis,kreisselmeier1999"

\end_inset

.
 Der Steuerungsanteil
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-steuer-FB"

\end_inset

 wird unter Verwendung der Hirschorn-Inversen
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hirschorn-Inverse
\end_layout

\end_inset

 entlang der Systemtrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 gebildet (siehe Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Hirschorn-Inverse"

\end_inset

).
 Ein Trajektoriengenerator stellt die Referenztrajektorie bereit.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Trajektorienfolgeregelung-FB"

\end_inset

 verdeutlicht das Zusammenwirken der verschiedenen Anteile im geschlossenen
 Regelkreis.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename Traj_FB.fig
	width 95text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Struktur der Trajektorienfolgeregelung mittels Rückführung
\begin_inset CommandInset label
LatexCommand label
name "fig:Trajektorienfolgeregelung-FB"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
Stabilitätsaussage
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Durch die im Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 auftretende Referenztrajektorie 
\begin_inset Formula $t\mapsto y_{\text{ref}}(t)$
\end_inset

 ist das rückgeführte System zeitvariant, so dass man die Stabilitätsaussagen
 aus den Sätzen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Stabilisierung-EA-lokal"

\end_inset

 oder
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Stabilisierung-EA-global"

\end_inset

 nicht unmittelbar übernehmen kann.
 Allerdings lassen sich die Überlegungen von Satz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Stabilisierung-EA-global-fuehrungssignal"

\end_inset

 übertragen.
 Dazu betrachten wir das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 in der Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

.
 Der Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi$
\end_inset

 des ersten Teilsystems von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 ist durch den Ausgang und seine Zeitableitungen gegeben:
\begin_inset Formula 
\begin{equation}
\xi_{1}=y,\,\xi_{2}=\dot{y},\,\ldots,\,\xi_{r}=y^{(r-1)}.\label{eq:Zustand-xi-durch-y}
\end{equation}

\end_inset

Der Referenzzustand 
\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

 lässt sich in gleicher Weise durch 
\begin_inset Formula $\xi_{1,\text{ref}}=y_{\text{ref}},\ldots,\xi_{r,\text{ref}}=y_{\text{ref}}^{(r-1)}$
\end_inset

 beschreiben.
 Die Differenz 
\begin_inset Formula $\tilde{\xi}=\xi-\xi_{\text{ref}}$
\end_inset

 liefert die Koordinaten des Fehlersystems mit 
\begin_inset Formula $\tilde{\xi}_{1}=\varepsilon,\ldots,\tilde{\xi}_{r}=\varepsilon^{(r-1)}$
\end_inset

.
 Die Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 lässt sich dann als Zustandsraummodell
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\tilde{\xi}}_{1} & = & \tilde{\xi}_{2}\\
 & \vdots\\
\dot{\tilde{\xi}}_{r-1} & = & \tilde{\xi}_{r}\\
\dot{\tilde{\xi}}_{r} & = & -a_{0}\tilde{\xi}_{1}-\cdots-a_{r-1}\tilde{\xi}_{r}
\end{array}\right\} \quad\dot{\tilde{\xi}}=(A-bk^{T})\,\tilde{\xi}\label{eq:folgesystem-FB1}
\end{equation}

\end_inset

mit 
\begin_inset Formula $k=(a_{0},\ldots,a_{r-1})^{T}$
\end_inset

 angeben.
 Mit 
\begin_inset Formula $\xi=\xi_{\text{ref}}+\tilde{\xi}$
\end_inset

 ergibt sich für das zweite Teilsystem die Form
\begin_inset Formula 
\begin{equation}
\dot{\eta}=q(\xi_{\text{ref}}+\tilde{\xi},\eta).\label{eq:folgesystem-FB2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Nach diesen Vorüberlegungen kann folgende Aussage getroffen werden:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Stabilisierung-FB"

\end_inset

Das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 habe den Arbeitspunkt 
\begin_inset Formula $p\in\mathcal{M}$
\end_inset

 (für 
\begin_inset Formula $u=0$
\end_inset

) und den gleichmäßigen relativen Grad 
\begin_inset Formula $r<n$
\end_inset

.
 Zusätzlich sei das System global rück\SpecialChar softhyphen
führ\SpecialChar softhyphen
äquivalent zu der Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 mit der Ruhelage 
\begin_inset Formula $(\xi,\eta)=(0,0)$
\end_inset

.
 Die Reglerverstärkung 
\begin_inset Formula $k\in\R^{r}$
\end_inset

 sei so gewählt, dass das zur Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 gehörende charakteristische Polynom ein Hurwitz-Polynom ist.
 Zusätzlich sei der Referenzverlauf
\begin_inset space ~
\end_inset


\begin_inset Formula $y_{\text{ref}}$
\end_inset

 bis zur Ableitungsordnung 
\begin_inset Formula $r-1$
\end_inset

 beschränkt, d.
\begin_inset space \thinspace{}
\end_inset

h.
 es gibt eine Schranke 
\begin_inset Formula $M>0$
\end_inset

, so dass
\begin_inset Formula 
\begin{equation}
\left|y_{\text{ref}}^{(i)}(t)\right|<M\label{eq:yref-beschraenkt-in-Cr}
\end{equation}

\end_inset

für alle 
\begin_inset Formula $t\geq0$
\end_inset

 und 
\begin_inset Formula $i=0,\ldots,r-1$
\end_inset

.
 Ist das System stark minimalphasig, dann bleiben die Systemtrajektorien
 beschränkt.
\end_layout

\begin_layout Proof(smartQED)
Da globale Rückführäquivalenz zur Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 angenommen wird, kann die Stabilitätsbetrachtung auf Basis der Gln.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgesystem-FB1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgesystem-FB2"

\end_inset

 erfolgen.
 Weil alle Eigenwerte der Matrix 
\begin_inset Formula $A-bk^{^{T}}$
\end_inset

nach Wahl der Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset Formula $k$
\end_inset

 negative Realteile besitzen, klingt
\begin_inset space ~
\end_inset


\begin_inset Formula $\tilde{\xi}$
\end_inset

 ab, d.
\begin_inset space \thinspace{}
\end_inset

h.
 
\begin_inset Formula $\tilde{\xi}(t)\to0$
\end_inset

 für 
\begin_inset Formula $t\to\infty$
\end_inset

.
 Damit ist
\begin_inset space ~
\end_inset


\begin_inset Formula $\tilde{\xi}$
\end_inset

 beschränkt.
 Mit Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yref-beschraenkt-in-Cr"

\end_inset

 ist
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

 und damit die auch Summe 
\begin_inset Formula $\xi_{\text{ref}}+\tilde{\xi}$
\end_inset

 beschränkt.
 Mit der angenommenen starken Minimalphasigkeit ist das zweite Teilsystem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgesystem-FB2"

\end_inset

 eingangs-zustands-stabil, so dass 
\begin_inset Formula $\eta$
\end_inset

 beschränkt bleibt.
 Da die Transformation ein globaler Diffeomorphismus ist, bleibt auch die
 System\SpecialChar softhyphen
trajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 beschränkt.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
E-Z-Linearisierung, flaches System
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Für 
\begin_inset Formula $r=n$
\end_inset

 tritt das zweites Teilsystem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgesystem-FB2"

\end_inset

 nicht auf.
 In diesem Fall erhält man durch
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgesystem-FB1"

\end_inset

 insgesamt eine lineare zeitinvariante Fehlerdynamik.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Mehrgrößensysteme
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die dargelegten Überlegungen lassen sich unmittelbar auf Mehr\SpecialChar softhyphen
größen\SpecialChar softhyphen
systeme
 übertragen.
 Die Kompensation der Nichtlinearitäten erfolgt simultan mit der Entkopplung
 der Teilsysteme (siehe Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mehrvariable-Systeme"

\end_inset

).
 Die Trajektorienfolgeregelung wird dann für jeden einzelnen Ausgang in
 der beschriebenen Weise durchgeführt.
 Bei einem vollständig aktuierten mechanischen System lässt sich die Trajektorie
nfolgeregelung besonders einfach gestalten: 
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Mechanisches-System-Feedback"

\end_inset

Wir betrachten ein mechanisches System, welches durch eine Bewegungsgleichung
 der Form 
\begin_inset Formula 
\begin{equation}
M(q)\ddot{q}+C(q,\dot{q})=\tau\label{eq:mani-euler-lagrange-tracking}
\end{equation}

\end_inset

mit den verallgemeinerten Positionen
\begin_inset space ~
\end_inset


\begin_inset Formula $q$
\end_inset

, den verallgemeinerten Geschwindigkeiten
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{q}$
\end_inset

 und der Massenmatrix 
\begin_inset Formula $M(q)$
\end_inset

 beschrieben wird.
 Der Vektor
\begin_inset space ~
\end_inset


\begin_inset Formula $\tau$
\end_inset

 enthält die eingeprägten Kräfte bzw.
 Momente und der Vektor 
\begin_inset Formula $C(q,\dot{q})$
\end_inset

 alle weiteren Kräfte.
 Die Forderung 
\begin_inset Formula 
\[
\ddot{q}\stackrel{!}{=}v
\]

\end_inset

einer exakten Kompensation der Nichtlinearitäten führt zunächst auf das
 (linearisierende) Stellgesetz
\begin_inset Formula 
\begin{equation}
\tau=M(q)\,v+C(q,\dot{q}),\label{eq:mech-linearisierung-feedback}
\end{equation}

\end_inset

vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Mechanisch-relativer-grad"

\end_inset

.
 Die Stabilisierung entlang einer zweimal stetig differenzierbaren Referenztraje
ktorie
\begin_inset space ~
\end_inset


\begin_inset Formula $q_{\text{ref}}$
\end_inset

 erfolgt durch die als PD-Regler
\begin_inset Index idx
status open

\begin_layout Plain Layout
PD-Regler
\end_layout

\end_inset

 interpretierbare Rückführung
\begin_inset Formula 
\begin{equation}
v=\ddot{q}_{\text{ref}}+K_{D}\left(\dot{q}_{\text{ref}}-\dot{q}\right)+K_{P}\left(q_{\text{ref}}-q\right)\label{eq:mech-stabiliserung}
\end{equation}

\end_inset

mit passenden Diagonalmatrizen
\begin_inset space ~
\end_inset


\begin_inset Formula $K_{P}$
\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset Formula $K_{D}$
\end_inset

.
 Setzt man das daraus resultierende Stellgesetz 
\begin_inset Formula 
\begin{equation}
\tau=M(q)\cdot\left[\ddot{q}_{\text{ref}}+K_{D}\left(\dot{q}_{\text{ref}}-\dot{q}\right)+K_{P}\left(q_{\text{ref}}-q\right)\right]+C(q,\dot{q})\label{eq:tau-mech-FB}
\end{equation}

\end_inset

in die Bewegungsgleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mani-euler-lagrange-tracking"

\end_inset

 ein, so erhält man eine exakt lineare zeit\SpecialChar softhyphen
invariante Fehlerdynamik
\begin_inset Formula 
\[
0=\ddot{q}_{\text{ref}}-\ddot{q}+K_{D}\left(\dot{q}_{\text{ref}}-\dot{q}\right)+K_{P}\left(q_{\text{ref}}-q\right).
\]

\end_inset

Bei diesem Ansatz nutzt man die Bewegungsgleichung zur Berechnung der einzupräge
nden Momente.
 Man spricht daher von der 
\emph on
Methode der berechneten Momente
\emph default
 (engl.
 
\emph on
computed torque method
\emph default
).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
PI-Regelung
\end_layout

\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:PI-Feedback"

\end_inset

PI- und PID-Regler sind in der industriellen Praxis die am häufigsten eingesetzt
en Reglertypen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "marlin2000,odwyer2009handbook"

\end_inset

.
 Mit dem I-Anteil lassen sich bleibende Regelabweichungen kompensieren und
 Störungen unterdrücken
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "datta2000"

\end_inset

.
 Die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 kann man unter Bezug auf Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-PD-verallg"

\end_inset

 als verallgemeinerten PD-Regler
\begin_inset Index idx
status open

\begin_layout Plain Layout
PD-Regler
\end_layout

\end_inset

 auffassen.
 Zur Ergänzung eines I-Anteils erweitert man die Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 zu
\begin_inset Formula 
\[
\varepsilon^{(r)}(t)+a_{r-1}\varepsilon^{(r-1)}(t)+\cdots+a_{1}\dot{\varepsilon}(t)+a_{0}\varepsilon(t)+a_{I}\int_{0}^{t}\varepsilon(\tau)\d\tau=0
\]

\end_inset

mit dem zusätzlichen Koeffizienten 
\begin_inset Formula $a_{I}>0$
\end_inset

.
 Der I-Anteil wird dabei nach der Kompensation der Nichtlinearitäten durch
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-linearisierung-FB"

\end_inset

 eingefügt.
 In den Originalkoordinaten erhält man daraus die Zustandsrückführung
\begin_inset Formula 
\[
u=\frac{1}{L_{g}L_{f}^{r-1}h(x)}\left(a_{I}\!\int_{0}^{t}\!\left(y_{\text{ref}}(\tau)-h(x(\tau))\right)\d\tau+\sum_{i=0}^{r}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)\right)
\]

\end_inset

mit 
\begin_inset Formula $a_{r}:=1$
\end_inset

, vgl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "kravaris1987,henson1991critique"

\end_inset

.
 Diese Rückführung lässt sich als verallgemeinerter PID-Regler
\begin_inset Index idx
status open

\begin_layout Plain Layout
PID-Regler
\end_layout

\end_inset

 interpretieren
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sira-ramirez2002gpid"

\end_inset

.
 Alternativ kann man dem (nicht eingangs-ausgangs-linearisierten) Originalsystem
 auch einen Integrator vorschalten
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "mahout2003"

\end_inset

.
 Das erweiterte System hat dann den relativen Grad 
\begin_inset Formula $r+1$
\end_inset

 (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Relativer-Grad-nichtaffine"

\end_inset

) und kann mit der hinsichtlich
\begin_inset space ~
\end_inset


\begin_inset Formula $r$
\end_inset

 entsprechend an\SpecialChar softhyphen
ge\SpecialChar softhyphen
passten Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 geregelt werden.
\end_layout

\begin_layout Subsection
Überführung zwischen Ruhelagen
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ueberfuehrung-zwischen-Ruhelagen"

\end_inset


\end_layout

\begin_layout Standard
Eine besonders praxisrelevante Aufgabenstellung im Rahmen der Trajektorienfolger
egelung ist die Überführung des Systems von einer Ruhelage 
\begin_inset Formula $x^{0}\in\mathcal{M}$
\end_inset

 in eine andere Ruhelage 
\begin_inset Formula $x^{1}\in\mathcal{M}$
\end_inset

.
 Hinsichtlich des Ausgangs bedeutet das einen Übergang von 
\begin_inset Formula $y^{0}=h(x^{0})$
\end_inset

 zu 
\begin_inset Formula $y^{1}=h(x^{1})$
\end_inset

.
 Gesucht ist ein Referenzverlauf 
\begin_inset Formula $y_{\text{ref}}:[0,T]\to\R$
\end_inset

 des Ausgangs, so dass die Ruhelage 
\begin_inset Formula $x^{0}=x(0)$
\end_inset

 in die Ruhelage 
\begin_inset Formula $x^{1}=x(T)$
\end_inset

 überführt wird (siehe Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Referenztrajektorie-Ausgang"

\end_inset

).
 Die Ruhelagenüberführung erfolgt in diesem Abschnitt für das durch Rückführung
 linearisierte erste Teil\SpecialChar softhyphen
system
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-TS1-EA-linearisiert"

\end_inset

.
 Die Überführung des Zustands
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 bzw.
 
\begin_inset Formula $(\xi,\eta)$
\end_inset

 des Gesamtsystems wird in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedforward"

\end_inset

 behandelt.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename Ruhelagenueberfuehrung.fig
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Referenztrajektorie des Ausgangs bei einer Ruhelagenüberführung
\begin_inset CommandInset label
LatexCommand label
name "fig:Referenztrajektorie-Ausgang"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Der Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi$
\end_inset

 des Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-TS1-EA-linearisiert"

\end_inset

 lässt sich durch den Ausgang und seine Zeitableitungen erfassen, vgl.
 Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Zustand-xi-durch-y"

\end_inset

.
 Die Ruhelagen vor und nach dem Überführungsvorgang sind daher durch die
 
\begin_inset Formula $2r$
\end_inset

 Randbedingungen
\begin_inset Formula 
\begin{equation}
\begin{array}{llll}
y_{\text{ref}}(0)=y^{0}, & \dot{y}_{\text{ref}}(0)=0, & \ldots, & y_{\text{ref}}^{(r-1)}(0)=0\\
y_{\text{ref}}(T)=y^{1}, & \dot{y}_{\text{ref}}(T)=0, & \ldots, & y_{\text{ref}}^{(r-1)}(T)=0
\end{array}\label{eq:var-randbedingungungen1}
\end{equation}

\end_inset

eindeutig festgelegt.
 Wählt man für die Überführung zwischen den Ruhelagen einen hinreichend
 glatten Verlauf des Referenzausgangs 
\begin_inset Formula $y_{\text{ref}}:[0,T]\to\R$
\end_inset

, so dass diese Randbedingungen erfüllt sind, dann erhält man damit auch
 einen stetigen Übergang des Zustands
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi$
\end_inset

.
 Fordert man zusätzlich
\begin_inset Formula 
\begin{equation}
y_{\text{ref}}^{(r)}(0)=y_{\text{ref}}^{(r)}(T)=0,\label{eq:var-randbedingungungen2}
\end{equation}

\end_inset

dann ist wegen der letzten Differentialgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-TS1-EA-linearisiert"

\end_inset

 auch der für die Überführung benötigte Eingangsverlauf stetig.
 Mit den Gln.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

 ergeben sich insgesamt 
\begin_inset Formula $2r+2$
\end_inset

 Randbedingungen, die der gesuchte Referenzverlauf 
\begin_inset Formula $y_{\text{ref}}$
\end_inset

 des Ausgangs erfüllen soll.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Normiertes Übergangspolynom
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Für den Übergang von 
\begin_inset Formula $y^{0}=y_{\text{ref}}(0)$
\end_inset

 zu 
\begin_inset Formula $y^{1}=y_{\text{ref}}(T)$
\end_inset

 unter Beachtung der o.
\begin_inset space \thinspace{}
\end_inset

g.
 Randbedingungen könnte man aus einer großen Menge möglicher Ansatzfunktionen
 wählen (z.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
,
\end_layout

\end_inset

B.
 Splines oder Linearkombinationen trigonometrischer Funktionen).
 Ein besonders einfacher Ansatz ist durch ein Polynom gegeben.
 Um nicht in jedem Einzelfall das benötigte Polynom erneut auszurechnen
 bietet es sich an, ein normiertes Polynom
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma$
\end_inset

 zu bestimmen, welches von 
\begin_inset Formula $\sigma(0)=0$
\end_inset

 auf 
\begin_inset Formula $\sigma(1)=1$
\end_inset

 unter Berücksichtigung der entsprechenden Randbedingungen in den Ableitungen
 übergeht.
 Für 
\begin_inset Formula $2r+2$
\end_inset

 Parameter muss das Polynom
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma$
\end_inset

 mindestens mit dem Grad 
\begin_inset Formula $2r+1$
\end_inset

 angesetzt werden.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:normiertes-uebergangspolynom"

\end_inset

Für 
\begin_inset Formula $r=1$
\end_inset

 würde man ein Polynom von Grad 
\begin_inset Formula $2r+1=3$
\end_inset

 ansetzen:
\begin_inset Formula 
\[
\sigma(t)=\sigma_{0}+\sigma_{1}t+\sigma_{2}t^{2}+\sigma_{3}t^{3}.
\]

\end_inset

Die Parameter
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma_{0}$
\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma_{1}$
\end_inset

 erhält man aus den Bedingungen am linken Rand:
\begin_inset Formula 
\[
\begin{array}{lclcl}
\sigma(0) & = & \sigma_{0} & \stackrel{!}{=} & 0,\\
\dot{\sigma}(0) & = & \sigma_{1} & \stackrel{!}{=} & 0.
\end{array}
\]

\end_inset

Die Bedingungen am rechten Rand 
\begin_inset Formula 
\[
\left.\begin{array}{lclcl}
\sigma(1) & = & \sigma_{2}+\sigma_{3} & \stackrel{!}{=} & 1\\
\dot{\sigma}(1) & = & 2\sigma_{2}+3\sigma_{3} & \stackrel{!}{=} & 0
\end{array}\right\} \quad\Leftrightarrow\quad\left(\begin{array}{cc}
1 & 1\\
2 & 3
\end{array}\right)\left(\begin{array}{c}
\sigma_{2}\\
\sigma_{3}
\end{array}\right)=\left(\begin{array}{c}
1\\
0
\end{array}\right)
\]

\end_inset

liefern 
\begin_inset Formula $\sigma_{2}=3$
\end_inset

 und 
\begin_inset Formula $\sigma_{3}=-2$
\end_inset

 und damit 
\begin_inset Formula $\sigma(t)=3t^{2}-2t^{3}$
\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset Note Note
status open

\begin_layout Plain Layout
Direkte Formel für Übergangspolynom
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Der in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:normiertes-uebergangspolynom"

\end_inset

 beschriebene Ansatz führt bei polynomialen Ansatzfunktionen immer auf ein
 lineares Gleichungssystem.
 Allerdings können die gesuchten Übergangspolynome auch über eine direkte
 Formel berechnet werden
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "piazzi2001tac,piazzi2001automatica"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\sigma(t)=\frac{(2r+1)!}{r!}\sum_{i=r+1}^{2r+1}\frac{(-1)^{i-r-1}}{(i-r-1)!\,(2r+1-i)!\cdot i}\,t^{i}.\label{eq:formel-uebergangspolynom}
\end{equation}

\end_inset

Basierend auf dem normierten Übergangspolynom
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma$
\end_inset

 lässt sich jetzt der Übergang von 
\begin_inset Formula $y^{0}=y_{\text{ref}}(0)$
\end_inset

 zu 
\begin_inset Formula $y^{1}=y_{\text{ref}}(T)$
\end_inset

 durch die abschnittsweise definierte Funktion
\begin_inset Formula 
\begin{equation}
y_{\text{ref}}(t)=\left\{ \begin{array}{ccl}
y^{0} &  & t<0\\
y^{0}+(y^{1}-y^{0})\cdot\sigma\left(\frac{t}{T}\right) & \quad\text{für}\quad & 0\leq t\leq T\\
y^{1} &  & t>T
\end{array}\right.\label{eq:yref-allgemein}
\end{equation}

\end_inset

spezifizieren (vgl.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Referenztrajektorie-Ausgang"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel: Hochsetzsteller
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:hochsetzsteller-folgeregelung-feedback"

\end_inset

Man betrachte das gemittelte Modell des Hochsetzstellers
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hochsetzsteller
\end_layout

\end_inset

 aus Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Hochsetzsteller"

\end_inset

 mit den dort angegebenen Parameterwerten:
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & -(1-u)\frac{1}{L}x_{2}+\frac{E}{L},\\
\dot{x}_{2} & = & (1-u)\frac{1}{C}x_{1}-\frac{1}{RC}x_{2}.
\end{array}\label{eq:var-hochsetzsteller}
\end{equation}

\end_inset

Gewünscht ist ein Übergang der Ausgangsspannung von 
\begin_inset Formula $20\,\text{V}$
\end_inset

 auf 
\begin_inset Formula $25\,\text{V}$
\end_inset

 in einem Zeitintervall der Länge 
\begin_inset Formula $T=50\,\text{ms}$
\end_inset

.
\end_layout

\begin_layout Example
Verwendet man für den Reglerentwurf den Strom
\begin_inset Foot
status open

\begin_layout Plain Layout
Aus Anwendungssicht wäre es wünschenswert, die Spannung direkt als Referenzgröße
 nutzen zu können.
 Mit dem hier beschriebenen Zugang ist das leider nicht möglich, da die
 zugehörige Nulldynamik instabil ist (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Hochsetzsteller-Ausgang-Spannung"

\end_inset

).
\end_layout

\end_inset

 als Ausgang
\begin_inset Formula 
\begin{equation}
y=h(x)=x_{1},\label{eq:hochsetzsteller-ausgang-strom-tracking}
\end{equation}

\end_inset

so hat das System den relativen Grad 
\begin_inset Formula $r=1$
\end_inset

.
 Damit lässt sich das normierte Übergangspolynom 
\begin_inset Formula $\sigma(t)=3t^{2}-2t^{3}$
\end_inset

 aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:normiertes-uebergangspolynom"

\end_inset

 nutzen.
 Der Übergang zwischen den o.
\begin_inset space \thinspace{}
\end_inset

g.
 Spannungen entspricht einem Übergang des Stroms von 
\begin_inset Formula $y^{0}=x_{1}(0)=2,\bar{6}\,\text{\text{A}}$
\end_inset

 auf 
\begin_inset Formula $y^{1}=x_{1}(T)=4,1\bar{6}\,\text{A}$
\end_inset

.
 Auf Basis des sich daraus ergebenden Referenzverlaufs
\begin_inset Formula 
\begin{equation}
y_{\text{ref}}(t)=\frac{8}{3}+1800t^{2}-24000t^{3}\label{eq:hochsetzsteller-yref-strom}
\end{equation}

\end_inset

nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yref-allgemein"

\end_inset

 mit 
\begin_inset Formula $t$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{s}$
\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset Formula $y_{\text{ref}}$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{A}$
\end_inset

 nimmt das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 die Form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
u & = & \frac{1}{L_{g}h(x)}\left(\dot{y}_{\text{ref}}(t)-L_{f}h(x)+a_{0}(y_{\text{ref}}(t)-h(x))\right)\\
 & = & \frac{L}{x_{2}}\left(\dot{y}_{\text{ref}}(t)-\frac{E-x_{2}}{L}+a_{0}(y_{\text{ref}}(t)-x_{1})\right)
\end{eqnarray*}

\end_inset

mit einem Koeffizienten 
\begin_inset Formula $a_{0}>0$
\end_inset

 an.
\end_layout

\begin_layout Standard
Verwendet man alternativ die elektrische Energie als Ausgang 
\begin_inset Formula 
\begin{equation}
y=h(x)=\frac{L}{2}x_{1}^{2}+\frac{C}{2}x_{2}^{2},\label{eq:hochsetzsteller-ausgang-energie-tracking}
\end{equation}

\end_inset

so hat das System den relativen Grad 
\begin_inset Formula $r=2$
\end_inset

, d.
\begin_inset space \thinspace{}
\end_inset

h.
 man führt eine Eingangs-Zustands-Linearisierung durch.
 Aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:formel-uebergangspolynom"

\end_inset

 erhält man das Übergangspolynom 
\begin_inset Formula $\sigma(t)=10t^{3}-15t^{4}+6t^{5}$
\end_inset

.
 Für
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-ausgang-energie-tracking"

\end_inset

 wird der Übergang von 
\begin_inset Formula $y^{0}=0,201\bar{7}\,\text{Ws}$
\end_inset

 auf 
\begin_inset Formula $y^{1}=0,3168402\bar{7}\,\text{Ws}$
\end_inset

 entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yref-allgemein"

\end_inset

 geplant 
\begin_inset Formula 
\begin{equation}
y_{\text{ref}}(t)=0,201\bar{7}+9205t^{3}-276150t^{4}+2209200t^{5},\label{eq:hochsetzsteller-yref-energie}
\end{equation}

\end_inset

wobei 
\begin_inset Formula $t$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{s}$
\end_inset

 und 
\begin_inset Formula $y_{\text{ref}}$
\end_inset

 in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{Ws}$
\end_inset

 angegeben sind.
 Das Regelgesetz hat die Gestalt 
\begin_inset Formula 
\[
u=\frac{1}{L_{g}L_{f}h(x)}\left(\ddot{y}_{\text{ref}}(t)\!-\!L_{f}^{2}h(x)+a_{1}((\dot{y}_{\text{ref}}(t)\!-\!L_{f}h(x)))+a_{0}(y_{\text{ref}}(t)\!-\!h(x))\right)
\]

\end_inset

mit den Lie-Ableitungen aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Hochsetzsteller-Lie-Ableitungen-Energie"

\end_inset

 und den Koeffizienten 
\begin_inset Formula $a_{0},a_{1}>0$
\end_inset

 (Stodola-Bedingung).
\end_layout

\begin_layout Standard
Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-Tracking"

\end_inset

 zeigt die numerischen Ergebnisse für beide Fälle (
\begin_inset Formula $r=1$
\end_inset

 bzw.
 
\begin_inset Formula $r=2$
\end_inset

 für Eingangs-Ausgangs- bzw.
 Eingangs-Zustands-Linearisierung).
 Die Koeffizienten 
\begin_inset Formula $a_{0},a_{1}$
\end_inset

 der Reglerverstärkung wurden entsprechend Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Hochsetzsteller"

\end_inset

 gewählt.
 Mit der Eingangs-Zustands-Linearisierung ist ein schnelleres Einschwingen
 möglich.
 Allerdings weist der Strom in diesem Fall auch ein leichtes Überschwingen
 auf (Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-Tracking"

\end_inset

 oben).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Hochsetzsteller_Tracking_FB.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Referenztrajektorien bzw.
 Simulation des ungestörten Hochsetzstellers
\begin_inset CommandInset label
LatexCommand label
name "fig:Hochsetzsteller-Tracking"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Trajektorienfolgeregelung mittels Aufschaltung (Feed\SpecialChar softhyphen
forward)
\begin_inset CommandInset label
LatexCommand label
name "sec:Trajektorienfolgeregelung-Feedforward"

\end_inset


\end_layout

\begin_layout Subsection
Folgeregelung entlang einer bekannten Referenztrajektorie
\end_layout

\begin_layout Standard
Wir widmen uns weiterhin dem Problem der Trajektorienfolgeregelung und betrachte
n die in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hagenmeyer2003lncis,hagenmeyer2003"

\end_inset


\begin_inset CommandInset citation
LatexCommand nocite
key "zinober2003"

\end_inset

 vorgestellten Lösungsansätze.
 Dabei gehen wir jetzt von einem bekannten Referenzverlauf 
\begin_inset Formula $x_{\text{ref}}:[0,T]\to\mathcal{M}$
\end_inset

 des Zustands aus.
 Befindet sich der Zustand des Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 bereits auf der Referenztrajektorie, d.
\begin_inset space \thinspace{}
\end_inset

h.
 
\begin_inset Formula $x=x_{\text{ref}}$
\end_inset

, dann kann die in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-linearisierung-FB"

\end_inset

 durchgeführte Kompensation der Nichtlinearitäten des ersten Teilsystems
 von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 auch auf Basis des Referenzzustands mit 
\begin_inset Formula $(\xi_{\text{ref}},\eta_{\text{ref}})=\Phi(x_{\text{ref}})$
\end_inset

 erfolgen: 
\begin_inset Formula 
\begin{equation}
u=\frac{1}{\beta(\xi_{\text{ref}},\eta_{\text{ref}})}\left(v-\alpha(\xi_{\text{ref}},\eta_{\text{ref}})\right)=\frac{1}{L_{g}L_{f}^{r-1}h(x_{\text{ref}})}\left(v-L_{f}^{r}h(x_{\text{ref}})\right).\label{eq:var-linearisierung-FF}
\end{equation}

\end_inset

Zusammen mit der aus der vorgegebenen Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-fehlerdynamik"

\end_inset

 hergeleiteten Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 erhält man insgesamt das Regelgesetz 
\begin_inset Formula 
\begin{equation}
u=\frac{1}{L_{g}L_{f}^{r-1}h(x_{\text{ref}}(t))}\left(y_{\text{ref}}^{(r)}(t)-L_{f}^{r}h(x_{\text{ref}}(t))+\sum_{i=0}^{r-1}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)\right).\label{eq:folgeregelung-feedforward}
\end{equation}

\end_inset

Der Unterschied zu dem Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 besteht lediglich darin, dass die höchsten Lie-Ableitungen 
\begin_inset Formula $L_{f}^{r}h(x)$
\end_inset

 und 
\begin_inset Formula $L_{g}L_{f}^{r-1}h(x)$
\end_inset

 entlang der Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 anstelle der Systemtrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 ausgewertet werden.
 Bei diesem Zugang erwartet man im Vergleich zur Trajektorienfolgeregelung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

 mittels Rückführung eine größere Robustheit gegenüber Modellunbestimmtheiten.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Aufteilung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Auch bei Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedforward"

\end_inset

 ist eine Aufspaltung 
\begin_inset Formula 
\begin{equation}
u=u_{\text{ref}}+u_{\text{stab}}\label{eq:u-aufspaltung-FF}
\end{equation}

\end_inset

in einen Anteil der Vorsteuerung
\begin_inset Formula 
\begin{equation}
u_{\text{ref}}=\frac{1}{L_{g}L_{f}^{r-1}h(x_{\text{ref}}(t))}\left(y_{\text{ref}}^{(r)}(t)-L_{f}^{r}h(x_{\text{ref}}(t))\right)\label{eq:u-steuer-FF}
\end{equation}

\end_inset

und einen Anteil zur asymptotischen Stabilisierung
\begin_inset Formula 
\begin{equation}
u_{\text{stab}}=\frac{1}{L_{g}L_{f}^{r-1}h(x_{\text{ref}}(t))}\sum_{i=0}^{r-1}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)\label{eq:u-stab-FF}
\end{equation}

\end_inset

möglich.
 Die Steuerung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-steuer-FF"

\end_inset

 wird als Hirschorn-Inverse
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hirschorn-Inverse
\end_layout

\end_inset

 der Systemdynamik entlang der Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 gebildet und stellt damit (unabhängig vom Systemzustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

) den Referenzverlauf des Eingangssignals dar.
 Damit liegt hier ein inversionsbasierter Vorsteuerungsentwurf vor
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "graichen2006at"

\end_inset

.
 Die sich daraus ergebende Regelkreisstruktur ist in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Trajektorienfolgeregelung-FF"

\end_inset

 dargestellt.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
CK: Die Bedingung 
\begin_inset Formula $x=x_{\text{ref}}$
\end_inset

 ist de facto nicht zu erfüllen.
 Wie kann man kurz begründen, dass dieser Ansatz trotzdem sinnvoll ist?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename Traj_FF.fig
	width 95text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Struktur der Trajektorienfolgeregelung mittels Aufschaltung
\begin_inset CommandInset label
LatexCommand label
name "fig:Trajektorienfolgeregelung-FF"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Mehrgrößensysteme
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die beschriebene Herangehensweise lässt sich analog zur Trajektorienfolgeregelun
g mittels Rückführung auch auf Mehrgrößensysteme übertragen.
 Der Spezialfall vollständig aktuierter mechanischer Systemer wird in der
 folgenden Anmerkung behandelt.
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Mechanisches-System-Feedforward"

\end_inset

Wir betrachten die Bewegungsgleichungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mani-euler-lagrange-tracking"

\end_inset

 aus Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Mechanisches-System-Feedback"

\end_inset

.
 Die in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mech-linearisierung-feedback"

\end_inset

 vorgenommene Kompensation der Nichtlinearitäten erfolgt jetzt allerdings
 entlang der Referenztrajektorien:
\begin_inset Formula 
\begin{equation}
\tau=M(q_{\text{ref}})\,v+C(q_{\text{ref}},\dot{q}_{\text{ref}}).\label{eq:mech-linearisierung-feedforward}
\end{equation}

\end_inset

Zusammen mit der Stabilisierung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mech-stabiliserung"

\end_inset

 erhält man das Stellgesetz
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\tau & = & M(q_{\text{ref}})\cdot\left[\ddot{q}_{\text{ref}}+K_{D}\left(\dot{q}_{\text{ref}}-\dot{q}\right)+K_{P}\left(q_{\text{ref}}-q\right)\right]+C(q_{\text{ref}},\dot{q}_{\text{ref}})\\
 & = & \underbrace{M(q_{\text{ref}})\,\ddot{q}_{\text{ref}}+C(q_{\text{ref}},\dot{q}_{\text{ref}})}_{{\displaystyle \tau_{\text{ref}}}}+M(q_{\text{ref}})\left[K_{D}\left(\dot{q}_{\text{ref}}-\dot{q}\right)+K_{P}\left(q_{\text{ref}}-q\right)\right],
\end{array}\label{eq:tau-mech-FF}
\end{equation}

\end_inset

bei dem das aus der Bewegungsgleichung erzeugte Referenzmoment
\begin_inset space ~
\end_inset


\begin_inset Formula $\tau_{\text{ref}}$
\end_inset

 zur Vorsteuerung entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-aufspaltung-FF"

\end_inset

 verwendet wird.
 Für 
\begin_inset Formula $q\equiv q_{\text{ref}}$
\end_inset

 stimmen die Rückführungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:tau-mech-FB"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:tau-mech-FF"

\end_inset

 überein.
 Bei den in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "an1989"

\end_inset

 durchgeführten Experimenten zeigen beide Regler ein ähnliches Verhalten.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
PI-Regler
\end_layout

\end_inset


\end_layout

\begin_layout Remark
Die Kompensation der Nichtlinearitäten durch Aufschaltung entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-linearisierung-FF"

\end_inset

 ist nur für 
\begin_inset Formula $x=x_{\text{ref}}$
\end_inset

 exakt.
 In der Regel muss man von 
\begin_inset Formula $x\neq x_{\text{ref}}$
\end_inset

 ausgehen, d.
\begin_inset space \thinspace{}
\end_inset

h.
 der Systemzustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 wird praktisch nie exakt mit dem Referenzzustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 übereinstimmen.
 Zur Kompensation der sich daraus ergebenden Regelabweichung bietet sich
 die Aufschaltung eines I-Anteils an
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hagenmeyer2003lncis,hagenmeyer2003"

\end_inset

.
 Dabei geht das Regelgesetz Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedforward"

\end_inset

 in den verallgemeinerten PID-Regler
\begin_inset Index idx
status open

\begin_layout Plain Layout
PID-Regler
\end_layout

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
u & = & \frac{1}{L_{g}L_{f}^{r-1}h(x_{\text{ref}}(t))}\left(y_{\text{ref}}^{(r)}(t)-L_{f}^{r}h(x_{\text{ref}}(t))\right.\\
 &  & +\left.\sum_{i=0}^{r-1}a_{i}\left(y_{\text{ref}}^{(i)}(t)-L_{f}^{i}h(x)\right)+a_{I}\!\int_{0}^{t}\!\left(y_{\text{ref}}(\tau)-h(x(\tau))\right)\d\tau\right)
\end{eqnarray*}

\end_inset

über (vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:PI-Feedback"

\end_inset

).
\end_layout

\begin_layout Subsection
Berechnung der Referenztrajektorie bei vollem relativen Grad
\begin_inset CommandInset label
LatexCommand label
name "subsec:Berechnung-Referenztraj-flach"

\end_inset


\end_layout

\begin_layout Standard
Hat das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 den relativen Grad 
\begin_inset Formula $r=n$
\end_inset

, dann existiert eine Zustands\SpecialChar softhyphen
transformation 
\begin_inset Formula $\xi=\Phi(x)$
\end_inset

, mit der das System in die nichtlineare Regelungsnormalform
\begin_inset Index idx
status open

\begin_layout Plain Layout
Regelungsnormalform
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!Regelungs-
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}\\
\dot{\xi}_{n} & = & \alpha(\xi)+\beta(\xi)u\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi)+\beta(\xi)u)\\
y & = & c^{T}\xi
\end{array}\label{eq:var-Regelungs-NF}
\end{equation}

\end_inset

überführt wird.
 Bezogen auf Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 entspricht das dem Wegfall des zweiten Teilsystems.
 Wir gehen von einer bekannten Referenztrajektorie 
\begin_inset Formula $y_{\text{ref}}:[0,T]\to\R$
\end_inset

 aus (siehe Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Ueberfuehrung-zwischen-Ruhelagen"

\end_inset

).
 Nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Zustand-xi-durch-y"

\end_inset

 lässt sich damit der Referenzzustand des transformierten System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF"

\end_inset

 berechnen.
 Über die Rücktransformation 
\begin_inset Formula $x_{\text{ref}}=\Phi^{-1}(\xi_{\text{ref}})$
\end_inset

 erhält man die Referenztrajektorie 
\begin_inset Formula $x_{\text{ref}}:[0,T]\to\mathcal{M}$
\end_inset

 des Originalzustands
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

.
 Aus der letzten Differentialgleichung 
\begin_inset Formula 
\[
y^{(n)}=\dot{\xi}_{n}=\alpha(\xi)+\beta(\xi)u
\]

\end_inset

der Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF"

\end_inset

 ergibt sich zusätzlich der Referenzverlauf
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
u_{\text{ref}}(t) & = & \frac{1}{\beta(\xi_{\text{ref}}(t))}\left(y_{\text{ref}}^{(n)}(t)-\alpha(\xi_{\text{ref}}(t))\right)\\
 & = & \frac{1}{L_{g}L_{f}^{n-1}h(x_{\text{ref}}(t))}\left(y_{\text{ref}}^{(n)}(t)-L_{f}^{n}h(x_{\text{ref}}(t))\right)
\end{array}\label{eq:uref-feedforward-n}
\end{equation}

\end_inset

des Eingangs als Spezialfall von Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-steuer-FF"

\end_inset

 für 
\begin_inset Formula $r=n$
\end_inset

.
 Bei vollem relativen Grad ist der Ausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $y$
\end_inset

 auch ein flacher Ausgang, der zusammen mit seinen Zeitableitungen die Parametri
erung aller anderen System\SpecialChar softhyphen
größen ermöglicht (siehe Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Flache-Systeme"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Hochsetzsteller, Hochsetzsteller_RNF_Track1.wxmx
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:hochsetzsteller-folgeregelung-feedforward-flach"

\end_inset

Wir betrachten das Modell
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 des Hochsetzstellers
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hochsetzsteller
\end_layout

\end_inset

 aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-folgeregelung-feedback"

\end_inset

.
 Mit dem Ausgang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-ausgang-energie-tracking"

\end_inset

 hat das System den vollen relativen Grad 
\begin_inset Formula $r=2$
\end_inset

.
 Die Zustände der Regelungsnormalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF"

\end_inset

 ergeben sich aus
\begin_inset Formula 
\[
\begin{array}{lclcl}
\xi_{1} & = & h(x) & = & \frac{L}{2}x_{1}^{2}+\frac{C}{2}x_{2}^{2},\\
\xi_{2} & = & L_{f}h(x) & = & Ex_{1}-\frac{1}{R}x_{2}^{2}.
\end{array}
\]

\end_inset

Dieses nichtlineare Gleichungssystem lässt sich nach
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 auflösen
\begin_inset Formula 
\begin{eqnarray*}
x_{1} & = & \frac{\sqrt{C^{2}E^{2}R^{2}+4CLR\xi_{2}+8\,L\xi_{1}}-CER}{2L},\\
x_{2} & = & \sqrt{R\left(Ex_{1}-\xi_{2}\right)},
\end{eqnarray*}

\end_inset

siehe
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "gensior2006"

\end_inset

 und Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Hochsetzsteller-flach"

\end_inset

 aus Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Flache-Systeme"

\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Direkte Formel: 
\begin_inset Formula $x_{2}=\sqrt{\frac{R\,\left(-2L\xi_{2}-CE^{2}R+E\,\sqrt{C^{2}E^{2}R^{2}+4CLR\xi_{2}+8L\xi_{1}}\right)}{2L}}$
\end_inset


\end_layout

\end_inset

 Durch Einsetzen der Referenzverläufe 
\begin_inset Formula $\xi_{1}=y_{\text{ref}}$
\end_inset

 und 
\begin_inset Formula $\xi_{2}=\dot{y}_{\text{ref}}$
\end_inset

 erhält man den Referenzzustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

.
 Den Referenzeingang kann man mit Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:uref-feedforward-n"

\end_inset

 in Originalkoordinaten berechnen:
\begin_inset Formula 
\[
u_{\text{ref}}(t)=\frac{-2Lx_{2,\text{ref}}^{2}\,+2LRx_{1,\text{ref}}x_{2,\text{ref}}+CR^{2}\left(L\ddot{y}_{\text{ref}}(t)-E^{2}+Ex_{2,\text{ref}}\right)}{R\left(CER+2Lx_{1,\text{ref}}\right)x_{2,\text{ref}}}.
\]

\end_inset

Mit den Parameterwerten aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-folgeregelung-feedback"

\end_inset

 erhält man bei vorgegebenem Referenzverlauf
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-energie"

\end_inset

 die bereits in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-Tracking"

\end_inset

 für die Eingangs-Zustands-Linearisierung angegebenen Verläufe.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Berechnung mit AD
\end_layout

\end_inset


\end_layout

\begin_layout Remark
Die symbolische Berechnung der benötigten Refernzverläufe ist bei eingangs-zusta
nds-linearisierbaren bzw.
 flachen Systemen immer möglich, aber mitunter aufwendig.
 Eine numerische Methode zur punktweisen Berechnung der Eingangs- und Zustandsre
ferenzverläufe bei gegebener Ausgangsreferenztrajektorie mit Hilfe des algorithm
ischen Differenzieren wird in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "roebvogel2000,roebenack2004automatica,roebenack2005habil"

\end_inset

 beschrieben.
\end_layout

\begin_layout Subsection
Berechnung der Referenztrajektorie bei nicht vollem relativen Grad
\begin_inset CommandInset label
LatexCommand label
name "subsec:Berechnung-Referenztraj-randwert"

\end_inset


\end_layout

\begin_layout Standard
Dieser Abschnitt befasst sich mit der Berechnung einer Referenztrajektorie
 auf Basis des in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "graichen2005,graichen2005ecc,graichen2006at"

\end_inset

 vorgeschlagenen Verfahrens, mit der das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 von einer Ruhelage 
\begin_inset Formula $x^{0}\in\mathcal{M}$
\end_inset

 in eine zweite Ruhelage 
\begin_inset Formula $x^{1}\in\mathcal{M}$
\end_inset

 überführt wird.
 Nachdem der Fall 
\begin_inset Formula $r=n$
\end_inset

 in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Berechnung-Referenztraj-flach"

\end_inset

 behandelt wurde gehen wir jetzt von einem relativen Grad 
\begin_inset Formula $r<n$
\end_inset

 aus.
 Damit existiert zwar die Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

, diese ist allerdings oft schwer zu berechnen (vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Berechnung-Byrnes-Isidori-NF"

\end_inset

).
 Daher betrachten wir jetzt die leichter aufzustellende Eingangs-Ausgangs-Normal
form
\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!Eingangs-Ausgangs-
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi,\eta)+\beta(\xi,\eta)u)\\
\dot{\eta} & = & q(\xi,\eta)+d(\xi,\eta)u\\
y & = & c^{T}\xi,
\end{array}\label{eq:var-EA-NF}
\end{equation}

\end_inset

bei der das zweite Teilsystem direkt vom Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 abhängen kann (siehe Satz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:EA-Form"

\end_inset

).
 
\end_layout

\begin_layout Standard
Die Ruhelagen sind in den transformierten Koordinaten durch 
\begin_inset Formula $(\xi^{0},\eta^{0})=\Phi(x^{0})$
\end_inset

 und 
\begin_inset Formula $(\xi^{1},\eta^{1})=\Phi(x^{1})$
\end_inset

 gegeben.
 Für den Verlauf des Ausgangs sind hinsichtlich des ersten Teilsystems die
 
\begin_inset Formula $2r+2$
\end_inset

 Randbedingungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

 zu erfüllen.
 Für das 
\begin_inset Formula $(n-r$
\end_inset

)-dimensionale zweite Teilsystem sind zusätzlich die (vektoriellen) Randbedingun
gen
\begin_inset Formula 
\begin{equation}
\eta_{\text{ref}}(0)=\eta^{0}\quad\text{und}\quad\eta_{\text{ref}}(T)=\eta^{1}\label{eq:var-randbedingungen3}
\end{equation}

\end_inset

gegeben.
 Damit ist für das zweite Teilsystem die 
\emph on
Randwertaufgabe
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Randwertaufgabe
\end_layout

\end_inset

 (engl.
 
\emph on
boundary value problem
\emph default
, kurz 
\emph on
BVP
\emph default
) einer gewöhnlichen (in der Regel nichtlinearen) Differentialgleichung
 zu lösen.
 Mit den 
\begin_inset Formula $2(n-r)$
\end_inset

-Bedingungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungen3"

\end_inset

 erhält man insgesamt 
\begin_inset Formula $2(n+1)$
\end_inset

 Randbedingungen.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Vorgehen Lösung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die durch das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-EA-NF"

\end_inset

 und die Randbedingungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungen3"

\end_inset

 gegebene Randwertaufgabe könnte man rein numerisch lösen, z.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
,
\end_layout

\end_inset

B.
 mit der 
\shape smallcaps
Scilab
\shape default
-Funktion 
\family typewriter
bvode
\family default

\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "campbell2006"

\end_inset

 oder dem 
\shape smallcaps
Python
\shape default
-Paket 
\family typewriter
PyTrajectory
\family default

\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "pytrajectory"

\end_inset

.
 Alternativ dazu wird in der o.
\begin_inset space \thinspace{}
\end_inset

g.
 Literatur ein Lösungsansatz mit freien Parametern vorgeschlagen:
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp1"

\end_inset

Aufstellen einer Ansatzfunktion für 
\begin_inset Formula $y_{\text{ref}}:[0,T]\to\R$
\end_inset

 mit 
\begin_inset Formula $n+r+2$
\end_inset

 freien Parametern.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp2"

\end_inset

Lösen der sich aus den 
\begin_inset Formula $2r+2$
\end_inset

 Randbedingungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

 ergebenden algebraischen Gleichungen.
 Die Lösung hängt dann noch von 
\begin_inset Formula $n-r$
\end_inset

 freien Parametern ab.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp3"

\end_inset

Berechnung der Zustandsreferenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

 des ersten Teilsystems aus dem Referenzausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $y_{\text{ref}}$
\end_inset

 und seinen Zeitableitungen nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Zustand-xi-durch-y"

\end_inset

.
 Dabei wird
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

 ebenfalls von den 
\begin_inset Formula $n-r$
\end_inset

 freien Parametern abhängen.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp4"

\end_inset

Berechnung des Eingangs aus der letzten Zeile des ersten Teilsystems: 
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
u^{*}(t) & = & \frac{1}{\beta(\xi_{\text{ref}}(t),\eta)}\left(y_{\text{ref}}^{(n)}(t)-\alpha(\xi_{\text{ref}}(t),\eta)\right).\end{array}\label{eq:uref-feedforward-r}
\end{equation}

\end_inset

Der Eingangsverlauf ist neben der Zeit auch vom (noch nicht bekannten) Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\eta$
\end_inset

 des zweiten Teilsystems und den o.
\begin_inset space \thinspace{}
\end_inset

g.
 
\begin_inset Formula $n-r$
\end_inset

 Parametern abhängig.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp5"

\end_inset

Einsetzen von
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset Formula $u^{*}$
\end_inset

 in das zweite Teilsystem führen zusammen mit der linken Randbedingung aus
 Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungen3"

\end_inset

 auf die Anfangswertaufgabe
\begin_inset Formula 
\begin{equation}
\dot{\eta}(t)=q(\xi_{\text{ref}}(t),\eta(t))+d(\xi_{\text{ref}}(t),\eta(t))\,u^{*}(t),\quad\eta(0)=\eta^{1}\label{eq:AWA-TS2-FF}
\end{equation}

\end_inset

mit einer sowohl zeitvarianten als auch parameterabhängigen Differential\SpecialChar softhyphen
gleichun
g, deren Lösung für 
\begin_inset Formula $t=T$
\end_inset

 benötigt wird.
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:bvp6"

\end_inset

Berechnung der verbleibenden 
\begin_inset Formula $n-r$
\end_inset

 Parameter derart, dass die rechte Randbedingung aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungen3"

\end_inset

 erfüllt ist.
 Mit der Festlegung dieser Parameter sind die Referenzverläufe 
\begin_inset Formula $y_{\text{ref}}$
\end_inset

, 
\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

, 
\begin_inset Formula $\eta_{\text{ref}}$
\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset Formula $u_{\text{ref}}$
\end_inset

 eindeutig spezifiziert.
\end_layout

\begin_layout Standard
Bei Punkt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:bvp1"

\end_inset

 kann man ein Polynom von Grad 
\begin_inset Formula $n+r+1$
\end_inset

 ansetzen.
 In diesem Fall hat man im Punkt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:bvp2"

\end_inset

 ein lineares Gleichungssystem zu lösen.
 Führt man die Berechnung in der Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 durch, die einen Spezialfall der Eingangs-Ausgangs-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-EA-NF"

\end_inset

 darstellt, so kann Punkt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:bvp4"

\end_inset

 entfallen, da der Eingang nicht im zweiten Teilsystem auftritt.
 Ist die Anfangswertaufgabe
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AWA-TS2-FF"

\end_inset

 symbolisch zu lösen, dann erhält man beim Einsetzen der rechten Randbedingung
 
\begin_inset Formula $\eta(T)=\eta^{1}$
\end_inset

 ein algebraisches Gleichungssystem, welches nach den Parametern aufzulösen
 ist.
 Im Allgemeinen ist jedoch nicht zu erwarten, dass man dieses Gleichungssystem
 symbolisch lösen kann.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "graichen2005,graichen2005ecc,graichen2006at"

\end_inset

 wird für die Lösung der in Punkt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:bvp6"

\end_inset

 auftretenden Randwertaufgabe die Nutzung der 
\shape smallcaps
Matlab
\shape default
-Funktion 
\family typewriter
bvp4c
\family default
 vorgeschlagen.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Hochsetzsteller, Strom, Hochsetzsteller_Strom_EA_Form.wxmx
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Das beschriebene Vorgehen wird nachfolgend am Beispiel des Hochsetzstellers
 illustriert:
\end_layout

\begin_layout Example
Man betrachte den Hochsetzsteller
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hochsetzsteller
\end_layout

\end_inset

 aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-folgeregelung-feedback"

\end_inset

 mit dem Strom und dem Ausgang entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-ausgang-strom-tracking"

\end_inset

.
 Das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 hat dann den relativen Grad 
\begin_inset Formula $r=1$
\end_inset

 und liegt bereits in der Eingangs-Ausgangs-Normalform mit 
\begin_inset Formula $\xi_{1}=x_{1}$
\end_inset

 und 
\begin_inset Formula $\eta_{1}=x_{2}$
\end_inset

 vor.
 Wir betrachten wieder den Übergang 
\begin_inset Formula 
\[
\text{von}\quad x^{0}=x(0)=\left(\begin{array}{c}
2,\bar{6}\\
20
\end{array}\right)\quad\text{in}\quad x^{1}=x(T)=\left(\begin{array}{c}
4,1\bar{6}\\
25
\end{array}\right)
\]

\end_inset

in 
\begin_inset Formula $T=50\,\text{ms}$
\end_inset

, wobei die jeweils erste Komponente des Zustands (d.
\begin_inset space \thinspace{}
\end_inset

h.
 der Strom) in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{A}$
\end_inset

 und die zweite (d.
\begin_inset space \thinspace{}
\end_inset

h.
 die Spannung) in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{V}$
\end_inset

 angegeben ist.
 Hinsichtlich des erstens Teilsystems sind nach Gln.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

 die Randbedingungen 
\begin_inset Formula $y_{\text{ref}}(0)=y^{0}$
\end_inset

, 
\begin_inset Formula $\dot{y}_{\text{ref}}(0)=0$
\end_inset

, 
\begin_inset Formula $y_{\text{ref}}(T)=y^{1}$
\end_inset

 und 
\begin_inset Formula $\dot{y}_{\text{ref}}(T)=0$
\end_inset

 zu erfüllen, so dass hierfür ein Polynom vom Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $3$
\end_inset

 nötig wäre.
 Für das zweite Teilsystem der Dimension 
\begin_inset Formula $n-r=1$
\end_inset

 benötigt man einen weiteren Freiheitsgrad für das Übergangspolynom.
 Wir setzen daher für das normierte Übergangspolynom ein Polynom von Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $4$
\end_inset

 an: 
\begin_inset Formula $\sigma(t)=\sigma_{0}+\sigma_{1}t+\cdots+\sigma_{4}t^{4}$
\end_inset

.
 Mit Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:yref-allgemein"

\end_inset

 kommt man unter Einhaltung der Randbedingungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-randbedingungungen2"

\end_inset

 auf das Polynom 
\begin_inset Formula 
\begin{equation}
y_{\text{ref}}(t)=\frac{8}{3}+600(3+\sigma_{4})t^{2}-24000(1+\sigma_{4})t^{3}+240000\sigma_{4}t^{4}\label{eq:hochsetzsteller-yref-strom-FF}
\end{equation}

\end_inset

mit t in
\begin_inset space ~
\end_inset


\begin_inset Formula $\text{s}$
\end_inset

, welches für 
\begin_inset Formula $\sigma_{4}=0$
\end_inset

 mit dem Referenzpolynom
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-strom"

\end_inset

 übereinstimmt.
 Den Zeitverlauf setzt man entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-ausgang-strom-tracking"

\end_inset

 für
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{1}$
\end_inset

 in die erste Differentialgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 ein und stellt die Gleichung nach
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 um
\begin_inset Formula 
\[
u^{*}(t)=\frac{x_{2}-E+1200t(20t-1)(40\sigma_{4}t-\sigma_{4}-3)L}{x_{2}},
\]

\end_inset

vgl.
 Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:uref-feedforward-r"

\end_inset

.
 Diesen Eingangsverlauf setzt man nun zusammen mit dem Referenzverlauf
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-strom-FF"

\end_inset

 für
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{1}$
\end_inset

 in die zweite Differentialgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 ein und erhält damit eine zeitvariante Differentialgleichung in der Zustandskom
ponente
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{2}$
\end_inset

.
 Die zu dieser Differentialgleichung mit 
\begin_inset Formula $x_{2}(0)=20$
\end_inset

 gehörende Anfangswertaufgabe kann man symbolisch mit 
\shape smallcaps
Maxima
\shape default
 lösen, wobei die Lösung vom Parameter
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma_{4}$
\end_inset

 abhängt.
 Für den rechten Rand fordert man 
\begin_inset Formula $x_{2}(T)=25$
\end_inset

 und erhält dadurch ein algebraisches Gleichungssystem (in Form einer quadratisc
hen Gleichung bezüglich
\begin_inset space ~
\end_inset


\begin_inset Formula $\sigma_{4}$
\end_inset

).
 Von den zwei Lösungen 
\begin_inset Formula $\sigma_{4}\approx-6966$
\end_inset

 und 
\begin_inset Formula $\sigma_{4}\approx4.6156$
\end_inset

 ist nur die letztere physikalisch sinnvoll.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-Tracking-Strom-FB-FF"

\end_inset

 zeigt den sich dafür aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-strom-FF"

\end_inset

 ergebenden Verlauf im Vergleich mit den Referenztrajektorien aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-folgeregelung-feedback"

\end_inset

.
 Bei der Solltrajektorie nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-strom-FF"

\end_inset

 (Eingangs-Ausgangs-Linearisierung mit Aufschaltung) wird im Unterschied
 zu der nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-strom"

\end_inset

 (Eingangs-Ausgangs-Linearisierung mit Rückführung) die interne Dynamik,
 also die Dynamik des zweiten Teilsystems, berücksichtigt.
 Die für die Eingangs-Zustands-Linearisierung berechnete Solltrajektorie
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-yref-energie"

\end_inset

 beschreibt den Verlauf der Energie, aus welchem sich der in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-Tracking-Strom-FB-FF"

\end_inset

 gezeigte Verlauf des Stroms ergibt.
 Dabei wird die vollständige Dynamik von außen vorgegeben.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Hochsetzsteller_Tracking_Strom.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ausgangsreferenzverläufe des Hochsetzstellers
\begin_inset CommandInset label
LatexCommand label
name "fig:Hochsetzsteller-Tracking-Strom-FB-FF"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Modellbasierte Regelung (IMC)
\begin_inset CommandInset label
LatexCommand label
name "sec:Modellbasierte-Regelung-IMC"

\end_inset


\end_layout

\begin_layout Standard
Die in diesem Buch behandelten Regelungsansätze sind alle modellbasiert
 in dem Sinne, dass das Modell der Regelstrecke für den Reglerentwurf benötigt
 wird.
\begin_inset Foot
status open

\begin_layout Plain Layout
Im Unterschied zu modellbasierten Verfahren gibt es auch Ansätze zur 
\emph on
modellfreien
\emph default
 Steuerung bzw.
 Regelung
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "fliess2009"

\end_inset

.
 Bei diesen Verfahren werden nur die Mess- oder Simulationsdaten genutzt.
\end_layout

\end_inset

 Bei der 
\emph on
modellbasierten Regelung
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
modellbasierte Regelung
\end_layout

\end_inset

 (engl.
 
\emph on
internal model control
\emph default
, kurz 
\emph on
IMC
\emph default
) im engeren Sinne ist das Modell der Regelstrecke unmittelbar im Regler
 enthalten.
 Der eigentliche Reglerentwurf ist auch bei komplizierten Modellen vergleichswei
se einfach und ähnelt der Entwurf einer Steuerung.
 Daher ist dieser Ansatz u.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
,
\end_layout

\end_inset

a.
 in der chemischen Verfahrenstechnik sehr beliebt.
 In Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Modellbasierte-Regelung-linear"

\end_inset

 wird zunächst der Reglerentwurf für lineare Regelstrecken vorgestellt
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "garcia1982"

\end_inset

.
 Die Verallgemeinerung auf nichtlineare Regelstrecken erfolgt in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Modellbasierte-Regelung-nichtlinear-minimalphasig"

\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Noch zu ergänzen: Vorteile des Verfahrens, warum so beliebt in der chemischen
 Industrie?
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Modellbasierte Regelung für lineare Systeme
\begin_inset CommandInset label
LatexCommand label
name "subsec:Modellbasierte-Regelung-linear"

\end_inset


\end_layout

\begin_layout Standard
Die Regelstrecke werde im Laplace-Bereich durch 
\begin_inset Formula 
\[
Y(s)=G(s)\,U(s)+D(s)
\]

\end_inset

mit einer gebrochen rationalen, properen
\begin_inset Index idx
status open

\begin_layout Plain Layout
Ubertragungsfunktion@
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
"U}
\end_layout

\end_inset

bertragungsfunktion!proper
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Eine rationale Übertragungsfunktion heißt 
\emph on
proper
\emph default
, wenn der Grad des Zählerpolynoms nicht größer ist als der Grad des Nennerpolyn
oms.
\end_layout

\end_inset

 Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

, dem Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $U$
\end_inset

, dem Ausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $Y$
\end_inset

 und der Störung
\begin_inset space ~
\end_inset


\begin_inset Formula $D$
\end_inset

 beschrieben.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Struktur-IMC-linear"

\end_inset

 zeigt die bei der modellbasierten Regelung verwendete Anordnung
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "lunze2007"

\end_inset

.
 Der Gesamtregeler besteht dabei aus einem sog.
 
\emph on
IMC-Regler
\emph default
 mit der Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $K$
\end_inset

 und einem durch die Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{G}$
\end_inset

 beschriebenen Modell der Regelstrecke.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename IMC-linear.fig
	width 75text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Struktur einer modellbasierten Regelung
\begin_inset CommandInset label
LatexCommand label
name "fig:Struktur-IMC-linear"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Bei der modellbasierten Regelung wird der Streckenausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $y$
\end_inset

 mit dem Modellausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{y}$
\end_inset

 verglichen.
 Bei exakter Modellkenntnis (
\begin_inset Formula $G=\hat{G}$
\end_inset

) reduziert sich im störungsfreien Fall (
\begin_inset Formula $d=0$
\end_inset

) der in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Struktur-IMC-linear"

\end_inset

 gezeigte Regelkreis wegen 
\begin_inset Formula $y=\hat{y}$
\end_inset

 auf eine reine Steuerung, wobei der IMC-Regler als Steuerungseinrichtung
 bzw.
 Vorfilter fungiert (siehe Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Struktur-IMC-Steuerung"

\end_inset

).
 Für die Stabilität des Gesamtsystems ergibt sich sofort die Forderung,
 dass sowohl die Regelstrecke als auch der Regler stabil sein müssen.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename IMC-linear-Steuerung.fig
	width 65text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Vereinfachung einer modellbasierten Regelung zur Steuerung
\begin_inset CommandInset label
LatexCommand label
name "fig:Struktur-IMC-Steuerung"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Perfekter Regler
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Bei der Steuerung in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Struktur-IMC-Steuerung"

\end_inset

 würde man mit der Wahl 
\begin_inset Formula 
\begin{equation}
K(s)=G^{-1}(s)\label{eq:IMC-perfekter-Regler-linear}
\end{equation}

\end_inset

die Dynamik der Regelstrecke exakt kompensieren.
 Der Ausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $y$
\end_inset

 würde (nach dem einmaligen Einschwingen durch verschiedene Anfangswerte
 von Strecke und Steuerung) der Führungsgröße unmittelbar folgen.
 Man spricht daher von einem 
\emph on
perfekten
\emph default
 
\emph on
IMC-Regler
\emph default

\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "garcia1982"

\end_inset

.
 Der perfekte Regler
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-perfekter-Regler-linear"

\end_inset

 ist jedoch aus folgenden Gründen meistens nicht einsetzbar:
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:IMC-Problem1"

\end_inset

Ist der Zählergrad der Streckenübertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 echt kleiner als der Nennergrad, dann sind die Verhältnisse bei der inversen
 Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G^{-1}$
\end_inset

 umgekehrt, so dass der Zählergrad größer als der Nennergrad ist.
 Eine derartige Reglerübertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-perfekter-Regler-linear"

\end_inset

 wäre nicht mehr proper.
 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:IMC-Problem2"

\end_inset

Bei der Inversion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-perfekter-Regler-linear"

\end_inset

 gehen die Nullstellen von
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 in die Polstellen von
\begin_inset space ~
\end_inset


\begin_inset Formula $G^{-1}$
\end_inset

 über.
 Liegen Nullstellen von
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 in der rechten Halbebene, dann besitzt das inverse Modell
\begin_inset space ~
\end_inset


\begin_inset Formula $G^{-1}$
\end_inset

 Polstellen in der rechten Halbebene und ist daher instabil.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Problem1 1: nicht proper
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Das erste Problem lässt sich umgehen, wenn man den IMC-Regler zusätzlich
 mit einem Filter ausstattet.
 Sei 
\begin_inset Formula $r>0$
\end_inset

 die Differenz zwischen Zähler- und Nennergrad von
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

, d.
\begin_inset space \thinspace{}
\end_inset

h.
 das durch die Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 beschriebene Modell hat den relativen Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $r$
\end_inset

 (vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:rel-grad-Uebertragungsfunktion"

\end_inset

).
 Setzt man für das Filter die Übertragungsfunktion
\begin_inset Formula 
\begin{equation}
F(s)=\frac{a_{0}}{a_{0}+a_{1}s+\cdots+a_{r-1}s^{r-1}+s^{r}}\label{eq:IMC-Filter-F}
\end{equation}

\end_inset

mit einem stabilen Nennerpolynom an, so ist der neue IMC-Regler
\begin_inset Formula 
\begin{equation}
K(s)=F(s)\cdot G^{-1}(s)\label{eq:IMC-Regler-mit-Filter-linear}
\end{equation}

\end_inset

proper, d.
\begin_inset space \thinspace{}
\end_inset

h.
 der Zähler von
\begin_inset space ~
\end_inset


\begin_inset Formula $K$
\end_inset

 weist keinen Gradüberschuss mehr auf.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Problem 2: nicht minimalphasig
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Eine stabile Übertragungsfunktion
\begin_inset Formula 
\begin{equation}
G(s)=\frac{Z(s)}{N(s)}=\frac{\bar{b}_{0}+\bar{b}_{1}s+\bar{b}_{2}s^{2}+\cdots+\bar{b}_{n-r}s^{n-r}}{\bar{a}_{0}+\bar{a}_{1}s+\cdots+\bar{a}_{n-1}s^{n-1}+s^{n}}\label{eq:IMC-P}
\end{equation}

\end_inset

nennt man 
\emph on
minimalphasig
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Die Verbindung zur Minimalphasigkeit in Sinne der Nulldynamik wird in Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Nulldynamik-Nullstellen-Uebertragungsfunktion"

\end_inset

 beschrieben.
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Ubertragungsfunktion@
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
"U}
\end_layout

\end_inset

bertragungsfunktion!minimalphasig
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
minimalphasig
\end_layout

\end_inset

, wenn alle Nullstellen des Zählerpolynoms 
\begin_inset Formula $Z(s)$
\end_inset

 in der offenen linken Halbebene liegen.
 Für eine minimalphasige Streckenübertragungsfunktion ist der IMC-Regler
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Regler-mit-Filter-linear"

\end_inset

 auch stabil.
 Andernfalls kann man die Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 in einen minimalphasigen Anteil
\begin_inset space ~
\end_inset


\begin_inset Formula $G_{\text{MP}}$
\end_inset

 und einen Allpass
\begin_inset space ~
\end_inset


\begin_inset Formula $G_{\text{A}}$
\end_inset

 zerlegen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "lunze2007"

\end_inset

:
\begin_inset Formula 
\begin{equation}
G(s)=G_{\text{MP}}(s)\cdot G_{\text{A}}(s).\label{eq:zerlegung-minimalphasig-allpass}
\end{equation}

\end_inset

Der IMC-Regler hat dann die Form
\begin_inset Formula 
\begin{equation}
K(s)=F(s)\cdot G_{\text{MP}}^{-1}(s).\label{eq:IMC-Regler-mit-Filter-minimalphasig}
\end{equation}

\end_inset

Diesen Ansatz kann man als stabile Approximation der inversen Strecken\SpecialChar softhyphen
dynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-perfekter-Regler-linear"

\end_inset

 auffassen.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Berechnung des minimalphasigen Anteils
\end_layout

\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:Uebertragungsfunktion-minimalphasiger-Anteil"

\end_inset

Bei einer nicht minimal\SpecialChar softhyphen
phasigen Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G$
\end_inset

 erhält man den minimal\SpecialChar softhyphen
phasigen Anteil
\begin_inset space ~
\end_inset


\begin_inset Formula $G_{\text{MP}}$
\end_inset

 dadurch, dass man die in der rechten Halbebene liegenden Nullstellen an
 der imaginären Achse spiegelt.
 Da die Nullstellen entweder reell sind oder in konjugiert komplexen Paaren
 auftreten, kann diese Spiegelung auch am Ursprung erfolgen.
 Liegen 
\shape italic
alle
\shape default
 Nullstellen in der rechten Halbebene, so heißt die Übertragungsfunktion
 
\emph on
maximal\SpecialChar softhyphen
phasig
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Ubertragungsfunktion@
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
"U}
\end_layout

\end_inset

bertragungsfunktion!maximalphasig
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
maximalphasig
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "doyle96"

\end_inset

.
 In diesem Fall erhält man für die Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-P"

\end_inset

 den minimal\SpecialChar softhyphen
phasigen Anteil 
\begin_inset Formula 
\begin{equation}
G_{\text{MP}}(s)=\frac{Z(-s)}{N(s)}=\frac{\bar{b}_{0}-\bar{b}_{1}s+\bar{b}_{2}s^{2}-\cdots+\bar{b}_{n-r}(-s)^{n-r}}{\bar{a}_{0}+\bar{a}_{1}s+\cdots+\bar{a}_{n-1}s^{n-1}+s^{n}},\label{eq:IMC-PMP}
\end{equation}

\end_inset

durch die Substitution 
\begin_inset Formula $s\mapsto-s$
\end_inset

 im Zählerpolynom.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel aus Vorlesung, könnte vielleicht später um Sprungantworten ergänzt
 werden
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:IMC-linear"

\end_inset

Die Übertragungsfunktion
\begin_inset Formula 
\[
G(s)=\frac{3-s}{(s+1)(s+2)}
\]

\end_inset

der Regelstrecke ist selber stabil, ihre Inverse
\begin_inset space ~
\end_inset


\begin_inset Formula $G^{-1}$
\end_inset

 wegen der o.
\begin_inset space \thinspace{}
\end_inset

g.
 Probleme
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:IMC-Problem1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "enu:IMC-Problem2"

\end_inset

 dagegen nicht.
 Eine Zerlegung nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:zerlegung-minimalphasig-allpass"

\end_inset

 liefert 
\begin_inset Formula 
\[
G(s)=\underbrace{\frac{3+s}{(s+1)(s+2)}}_{{\displaystyle G_{\text{MP}}(s)}}\cdot\frac{3-s}{3+s}.
\]

\end_inset

Der Gradunterschied zwischen Nenner- und Zählerpolynom erfordert ein Filter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Filter-F"

\end_inset

 der Ordnung 
\begin_inset Formula $r=1$
\end_inset

.
 Damit erhält man für den IMC-Regler
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Regler-mit-Filter-minimalphasig"

\end_inset

 die stabile Übertragungsfunktion
\begin_inset Formula 
\[
K(s)=\frac{a_{0}}{s+a_{0}}\cdot\frac{(s+1)(s+2)}{3+s}
\]

\end_inset

mit einem Koeffizienten 
\begin_inset Formula $a_{0}>0$
\end_inset

.
\begin_inset Foot
status open

\begin_layout Plain Layout
Mit 
\begin_inset Formula $a_{0}\in\{1,2\}$
\end_inset

 kann man durch Pol-Nullstellen-Kürzung die Ordnung des IMC-Reglers reduzieren.
 Für 
\begin_inset Formula $a_{0}=1$
\end_inset

 erhält man beispielsweise 
\begin_inset Formula $K(s)=\frac{s+2}{s+3}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Darstellung im Standardregelkreis
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Struktur-IMC-linear"

\end_inset

 gezeigte Anordnung einer modellbasierten Regelung kann man in die Form
 eines Standardregelkreises überführen (siehe Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:IMC-linear-Standardregelkreis"

\end_inset

).
 Die gezeigte Regel\SpecialChar softhyphen
kreis\SpecialChar softhyphen
struktur lässt sich in ähnlicher Weise auf nichtlineare
 Systeme übertragen.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename IMC-linear-Standardregelkreis.fig
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Darstellung der modellbasierten Regelung als Standardregelkreis
\begin_inset CommandInset label
LatexCommand label
name "fig:IMC-linear-Standardregelkreis"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Modellbasierte Regelung für nichtlineare minimalphasige Systeme
\begin_inset CommandInset label
LatexCommand label
name "subsec:Modellbasierte-Regelung-nichtlinear-minimalphasig"

\end_inset


\end_layout

\begin_layout Standard
Das Konzept der modellbasierten Regelung lässt sich auf nichtlineare Systeme
 verallgemeinern
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "economou1986,henson1991,schwarzmann2006,schwarzmann2007"

\end_inset

.
 Wir betrachten ein System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 mit relativem Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $r$
\end_inset

.
 Das System sei minimalphasig und eingangs-zustands-stabil (siehe Anhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Stabilitaet-erregter-Systeme"

\end_inset

).
 
\end_layout

\begin_layout Standard
Bei wohldefiniertem relativen Grad kann man das inverse Systemmodell durch
 die Hirschorn-Inverse
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hirschorn-inverse-SISO"

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Hirschorn-Inverse
\end_layout

\end_inset

 realisieren (vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Hirschorn-Inverse"

\end_inset

).
 Die Hirschorn-Inverse benötigt neben der 
\begin_inset Formula $r$
\end_inset

-ten Zeitableitung des Ausgangs auch den Systemzustand.
 Geht man zunächst von einer Systemdarstellung in der Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 aus, so ist auch der Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi$
\end_inset

 des ersten Teilsystems nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Zustand-xi-durch-y"

\end_inset

 durch die Zeitableitungen des Ausgangs
\begin_inset space ~
\end_inset


\begin_inset Formula $y$
\end_inset

 darstellbar.
 Da Zeitableitungen aus Mess\SpecialChar softhyphen
signalen schwer zu ermitteln sind, schalten
 wir dem inversen Systemmodell in Anlehnung an Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Regler-mit-Filter-linear"

\end_inset

 ein Filter vor.
 Die Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Filter-F"

\end_inset

 wird dabei als Zustandsraummodell 
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\hat{\xi}}_{1} & = & \hat{\xi}_{2}\\
 & \vdots\\
\dot{\hat{\xi}}_{r-1} & = & \hat{\xi}_{r}\\
\dot{\hat{\xi}}_{r} & = & -a_{0}\hat{\xi}_{1}-\cdots-a_{r-1}\hat{\xi}_{r}+a_{0}\tilde{w}\\
\hat{y} & = & \hat{\xi}_{1}
\end{array}\right\} \quad\begin{array}{lcl}
\dot{\hat{\xi}} & = & \left(A-bk^{T}\right)\hat{\xi}+a_{0}b\,\tilde{w}\\
\hat{y} & = & c^{T}\hat{\xi}
\end{array}\label{eq:IMC-Zustandsvariablenfilter}
\end{equation}

\end_inset

mit 
\begin_inset Formula $k=(a_{0},\ldots,a_{r-1})^{T}$
\end_inset

 implementiert, so dass sich der Modellausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{y}$
\end_inset

 und seine Zeitableitungen aus 
\begin_inset Formula 
\[
\hat{y}=\hat{\xi}_{1},\;\dot{\hat{y}}=\hat{\xi}_{2},\;\ldots,\;\hat{y}^{(r-1)}=\hat{\xi}_{r},\;\hat{y}^{(r)}=-a_{0}\hat{\xi}_{1}-\cdots-a_{r-1}\hat{\xi}_{r}+a_{0}\tilde{w}
\]

\end_inset

ergeben.
 Man spricht hierbei von einem 
\emph on
Zustandsvariablenfilter
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Zustandsvariablenfilter
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "isermann2"

\end_inset

.
 Dabei wird aus dem Referenzsignal
\begin_inset space ~
\end_inset


\begin_inset Formula $\tilde{w}$
\end_inset

 ein geglätteter Zeitverlauf
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{y}$
\end_inset

 generiert, den man wie einen Referenzausgang aus Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedback"

\end_inset

 behandeln kann.
 Den von dem Filter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Zustandsvariablenfilter"

\end_inset

 bereitgestellten Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{\xi}$
\end_inset

 speist man in das zweite Teilsystem der Byrnes-Isidori-Normalform
\begin_inset Formula 
\[
\dot{\hat{\eta}}=q(\hat{\xi},\hat{\eta})
\]

\end_inset

ein und erhält damit einen Referenzverlauf
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{\eta}$
\end_inset

.
 Aus der letzten Zeile des ersten Teilsystems erhält man den Eingang 
\begin_inset Formula 
\begin{equation}
u=\frac{1}{\beta(\hat{\xi},\hat{\eta})}\left(\hat{y}^{(r)}-\alpha(\hat{\xi},\hat{\eta})\right).\label{eq:IMC-u}
\end{equation}

\end_inset

Mit der Rücktransformation 
\begin_inset Formula $\hat{x}=\Phi^{-1}(\hat{\xi},\hat{\eta})$
\end_inset

 kann man
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-u"

\end_inset

 auch in Originalkoordinaten darstellen und erhält dabei die Hirschorn-Inverse
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hirschorn-inverse-SISO"

\end_inset

.
\end_layout

\begin_layout Standard
Verwendet man anstelle der Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 die in der Regel leichter zu berechnende Eingangs-Ausgangs-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-EA-NF"

\end_inset

, dann muss man erst den Eingang nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-u"

\end_inset

 berechnen und dann in das zweite Teilsystem einsetzen: 
\begin_inset Formula 
\begin{equation}
\dot{\hat{\eta}}=q(\hat{\xi},\hat{\eta})+d(\hat{\xi},\hat{\eta})u.\label{eq:IMC-TS2-EA}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Gleichungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Zustandsvariablenfilter"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-u"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-TS2-EA"

\end_inset

 bilden den IMC-Regler.
 Der Modell\SpecialChar softhyphen
ausgang
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{y}$
\end_inset

 liegt dabei schon am Filter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Zustandsvariablenfilter"

\end_inset

 an, so dass das Streckenmodell nicht noch separat zu implementieren ist.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regelkreis-IMC-nichtlinear"

\end_inset

 zeigt den Regelkreis für das nichtlineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 in Verallgemeinerung von Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:IMC-linear-Standardregelkreis"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename IMC-nichtlinear.fig
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Regelkreis mit nichtlinearem IMC-Regler für eine minimalphasige Regelstrecke
\begin_inset CommandInset label
LatexCommand label
name "fig:Regelkreis-IMC-nichtlinear"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel Hochsetzsteller
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:hochsetzsteller-IMC"

\end_inset

Wir betrachten wieder den 
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hochsetzsteller
\end_layout

\end_inset

Hochsetzsteller
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 mit dem Strom als Ausgang entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-ausgang-strom-tracking"

\end_inset

.
 Das System hat den relativen Grad 
\begin_inset Formula $r=1$
\end_inset

 und liegt schon in der Eingangs-Ausgangs-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-EA-NF"

\end_inset

 mit 
\begin_inset Formula $\xi_{1}=x_{1}$
\end_inset

 und 
\begin_inset Formula $\eta_{1}=x_{2}$
\end_inset

 vor.
 In der Implementierung bietet sich daher die Verwendung der ursprünglichen
 Bezeichnungen für die Zustandsvariablen an.
 Das Zustandsvariablenfilter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Zustandsvariablenfilter"

\end_inset

 wird als Filter erster Ordnung
\begin_inset Formula 
\begin{equation}
\dot{\hat{x}}_{1}=a_{0}\left(\tilde{w}-\hat{x}_{1}\right),\quad\tilde{w}=w-\left(y-\hat{x}_{1}\right)\label{eq:hochsetzsteller-IMC-x1hat}
\end{equation}

\end_inset

mit einem Koeffizienten 
\begin_inset Formula $a_{0}>0$
\end_inset

 angesetzt.
 Das Umstellen der ersten Systemgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 liefert die Hirschorn-Inverse 
\begin_inset Formula 
\begin{equation}
u=\frac{\hat{x}_{2}-E+L\dot{\hat{x}}_{1}}{\hat{x}_{2}}\label{eq:hochsetzsteller-IMC-u}
\end{equation}

\end_inset

nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-u"

\end_inset

.
 Das damit erzeugte Eingangssignal speist man in die zweite Systemgleichung
 von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 ein, um den Verlauf von
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{2}$
\end_inset

 im Regler zu simulieren: 
\begin_inset Formula 
\begin{equation}
\dot{\hat{x}}_{2}=(1-u)\frac{1}{C}\hat{x}_{1}-\frac{1}{RC}\hat{x}_{2}.\label{eq:hochsetzsteller-IMC-x2hat}
\end{equation}

\end_inset

Gleichzeitig ist
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-IMC-u"

\end_inset

 das Reglerausgangssignal, welches in die Regelstrecke
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-hochsetzsteller"

\end_inset

 eingespeist wird.
\end_layout

\begin_layout Example
\begin_inset Note Note
status open

\begin_layout Plain Layout
Simulation: boost-tracking.imc1.sce
\end_layout

\end_inset


\end_layout

\begin_layout Example
Für die numerische Simulation wird wieder der Übergang von 
\begin_inset Formula $20\,\text{V}$
\end_inset

 auf 
\begin_inset Formula $25\,\text{V}$
\end_inset

 betrachtet.
 Dazu wird das Führungssignal 
\begin_inset Formula 
\[
w(t)=\left\{ \begin{array}{rcl}
2,\bar{6}\,\text{A} & \text{für} & t<50\,\text{ms}\\
4,1\bar{6}\,\text{A} & \text{für} & t\geq50\,\text{ms}
\end{array}\right.
\]

\end_inset

vorgegeben.
 Für den Hochsetzsteller werden die von der Ruhelage abweichenden Anfangswerte
 
\begin_inset Formula $x_{1}(0)=2\,\text{A}$
\end_inset

 und 
\begin_inset Formula $x_{2}(0)=15\,\text{V}$
\end_inset

 vorgegeben, für den aus den Differentialgleichungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-IMC-x1hat"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-IMC-x2hat"

\end_inset

 bestehenden IMC-Regler dagegen die Anfangswerte 
\begin_inset Formula $\hat{x}_{1}(0)=2,\bar{6}\,\text{A}$
\end_inset

 und 
\begin_inset Formula $\hat{x}_{2}(0)=20\,\text{\text{V}}$
\end_inset

.
 Wie in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Hochsetzsteller-Num-Sim"

\end_inset

 wird der normierte Filterparameter 
\begin_inset Formula $a_{0}=300$
\end_inset

 eingesetzt.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-IMC-Strom"

\end_inset

 zeigt das Simulationsergebnis.
 Durch die unterschiedlichen Anfangswerte
\begin_inset space ~
\end_inset


\begin_inset Formula $x(0)$
\end_inset

 bzw.
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{x}(0)$
\end_inset

 treten zunächst Schwingungen auf, die bei dem ab 
\begin_inset Formula $t=50\,\text{ms}$
\end_inset

 eingeleiteten Übergang der Ausgangsspannung weitgehend abgeklungen sind.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Hochsetzsteller_IMC_Strom.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulation des Hochsetzstellers mit dem IMC-Regler aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-IMC"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:Hochsetzsteller-IMC-Strom"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Modellbasierte Regelung für nichtlineare maximalphasige Systeme
\begin_inset CommandInset label
LatexCommand label
name "subsec:Modellbasierte-Regelung-nichtlinear-maximalphasig"

\end_inset


\end_layout

\begin_layout Standard
Die zur IMC-Regelung verwendete Aufspaltung einer nicht minimalphasigen
 Übertragungsfunktion in einen minimalphasigen Anteil und einen Allpass
 lässt sich prinzipiell auch auf nichtlineare Systeme übertragen, ist in
 der Regel aber sehr kompliziert
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ball2004"

\end_inset

.
 In Anlehnung an
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "doyle96"

\end_inset

 wird in diesem Abschnitt eine Methode zur IMC-Regelung einer speziellen
 Klasse nicht minimalphasiger Systeme vorgestellt.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Einführung der Maximalphasigkeit
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Wir betrachten ein System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 mit einem wohldefinierten relativen Grad 
\begin_inset Formula $r<n$
\end_inset

.
 Damit kann das Systm in die Byrnes-Isidori-Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-BI-NF"

\end_inset

 transformiert werden.
 Das System ist minimalphasig
\begin_inset Index idx
status open

\begin_layout Plain Layout
minimalphasig
\end_layout

\end_inset

, wenn die Ruhelage 
\begin_inset Formula $\eta=0$
\end_inset

 der Nulldynamik
\begin_inset Formula 
\begin{equation}
\dot{\eta}=q(0,\eta)\label{eq:var-nulldynamik}
\end{equation}

\end_inset

asymptotisch stabil ist (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Reglerentwurf-zur-Stabilisierung-Ruhelage"

\end_inset

).
 Ist die Ruhelage zusätzlich hyperbolisch
\begin_inset Index idx
status open

\begin_layout Plain Layout
Ruhelage!hyperbolische
\end_layout

\end_inset

, dann liegen alle 
\begin_inset Formula $n-r$
\end_inset

 Eigenwerte der aus der Taylor-Linearisierung resultierenden Matrix 
\begin_inset Formula 
\begin{equation}
A_{22}:=\left.\frac{\partial}{\partial\eta}q(0,\eta)\right|_{\eta=0}\label{eq:eq:var-nulldynamik-linearisierung}
\end{equation}

\end_inset

in der offenen linken Halbebene (vgl.
 Anmerkungen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Nulldynamik-linear"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Nulldynamik-Nullstellen-Uebertragungsfunktion"

\end_inset

).
\end_layout

\begin_layout Standard
In Anlehnung an
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "doyle96"

\end_inset

 nennen wir ein System 
\emph on
maximalphasig
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
maximalphasig
\end_layout

\end_inset

, wenn die Ruhelage 
\begin_inset Formula $\eta=0$
\end_inset

 des zur Nulldynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-nulldynamik"

\end_inset

 assoziierten Systems 
\begin_inset Formula 
\begin{equation}
\dot{\eta}=-q(0,\eta)\label{eq:nulldynamik-maximalphasig}
\end{equation}

\end_inset

asymptotisch stabil ist.
 Im Falle einer hyperbolischen Ruhelage liegen dann alle Eigenwerte der
 zugehörigen Jacobimatrix
\begin_inset Formula 
\[
\left.\frac{\partial}{\partial\eta}\left(-q(0,\eta)\right)\right|_{\eta=0}=-\left.\frac{\partial}{\partial\eta}q(0,\eta)\right|_{\eta=0}=-A_{22}
\]

\end_inset

in der offenen linken Halbebene.
 Das bedeutet, dass alle Eigenwerte der Jacobi\SpecialChar softhyphen
matrix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eq:var-nulldynamik-linearisierung"

\end_inset

 der ursprünglichen Nulldynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-nulldynamik"

\end_inset

 in der offenen rechten Halbebene liegen.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Verallgemeinerte Regelungsnormalform
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Zusätzlich zur Byrnes-Isidori-Normalform betrachten wir das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 in der verallgemeinerten Regelungsnormalform
\begin_inset Index idx
status open

\begin_layout Plain Layout
verallgemeinerte Regelungsnormalform
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!verallgemeinerte Regelungs-
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{z}_{1} & = & z_{2}\\
 & \vdots\\
\dot{z}_{n-1} & = & z_{n}\\
\dot{z}_{n} & = & \underbrace{\alpha\left(z,u,\dot{u},\ddot{u},\ldots,u^{(n-r-1)}\right)+\beta\left(z,u,\dot{u},\ddot{u},\ldots,u^{(n-r-1)})\right)u^{(n-r)}}_{{\displaystyle \delta\left(u,\dot{u},\ldots,u^{(n-r)}\right)}}\\
y & = & z_{1},
\end{array}\label{eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig}
\end{equation}

\end_inset

vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Verallgemeinerte-Regelungsnormalform"

\end_inset

.
 Da das Ausgangssystem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 affin ist, ist die in der letzten Differentialgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig"

\end_inset

 auftretende Nichtlinearität
\begin_inset space ~
\end_inset


\begin_inset Formula $\delta$
\end_inset

 affin bezüglich der höchsten Zeitableitung des Eingangs.
 Die Transformation 
\begin_inset Formula $z=\Phi(x,u,\dot{u},\ldots,u^{(n-r-1)})$
\end_inset

 ergibt sich aus Zeitableitungen 
\begin_inset Formula $z_{1}=y,\,z_{2}=\dot{y},\,z_{3}=\ddot{y},\ldots,\,z_{n}=y^{(n-1)}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Übergang maximalphasig -> minimalphasig
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die Linearierung von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig"

\end_inset

 führt auf eine Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $G(s)$
\end_inset

 der Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-P"

\end_inset

.
 Die Koeffizienten 
\begin_inset Formula $\bar{b}_{0},\ldots,\bar{b}_{n-r}$
\end_inset

 des Zählerpolynoms 
\begin_inset Formula $Z(s)$
\end_inset

 ergeben sich dabei aus den partiellen Ableitungen von
\begin_inset space ~
\end_inset


\begin_inset Formula $\delta$
\end_inset

 nach dem Eingang und seien Zeitableitungen, d.
\begin_inset space \thinspace{}
\end_inset

h.
 
\begin_inset Formula 
\begin{equation}
\bar{b}_{0}=\frac{\partial\delta}{\partial u},\;\bar{b}_{1}=\frac{\partial\delta}{\partial\dot{u}},\;\ldots,\bar{b}_{n-r}=\frac{\partial\delta}{\partial u^{(n-r)}}\label{eq:IMC-koeff-nennerpolynom}
\end{equation}

\end_inset

für 
\begin_inset Formula $z=0,u=0,\ldots,u^{(n-r)}=0$
\end_inset

.
 Bei einem maximalphasigen System mit hyperbolischer Ruhelage liegen alle
 Nullstellen des Zählerpoylnoms 
\begin_inset Formula $Z(s)$
\end_inset

 in der rechten Halbebene.
 Der Übergang von 
\begin_inset Formula $Z(s)$
\end_inset

 zu 
\begin_inset Formula $Z(-s)$
\end_inset

 liefert den minimalphasigen Anteil
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-PMP"

\end_inset

 der Übertragungsfunktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-P"

\end_inset

, vgl.
 Anmerkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Uebertragungsfunktion-minimalphasiger-Anteil"

\end_inset

.
 Diesen Ansatz übertragen wir jetzt auf das nichtlineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig"

\end_inset

.
 Die im Zählerpolynom der Übertragungsfunktion durchgeführte Ersetzung 
\begin_inset Formula $s\mapsto-s$
\end_inset

 entspricht wegen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-koeff-nennerpolynom"

\end_inset

 in der Nichtlinearität
\begin_inset space ~
\end_inset


\begin_inset Formula $\delta$
\end_inset

 der Substitution 
\begin_inset Formula $\tfrac{\d}{\d t}\mapsto-\tfrac{\d}{\d t}$
\end_inset

.
 Im Falle eines maximalphasigen Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig"

\end_inset

 erhält man dadurch den zugehörigen minimalphasigen Anteil
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{z}_{1} & = & z_{2}\\
 & \vdots\\
\dot{z}_{n-1} & = & z_{n}\\
\dot{z}_{n} & = & \alpha\left(z,u,-\dot{u},\ddot{u},\ldots,(-1)^{n-r-1}u^{(n-r-1)}\right)\\
 &  & +(-1)^{n-r}\beta\left(z,u,-\dot{u},\ddot{u},\ldots,(-1)^{n-r-1}u^{(n-r-1)}\right)u^{(n-r)}\\
y & = & z_{1}.
\end{array}\label{eq:var-verallgemeinerte-Regelungsnormalform-minimalphasig}
\end{equation}

\end_inset

Die Lineariserung des resultierenden minimalphasigen Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-minimalphasig"

\end_inset

 liefert unmittelbar die Übertragungsfunktion 
\begin_inset Formula $G_{\text{MP}}(s)$
\end_inset

 analog zu Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-PMP"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
[
\end_layout

\begin_layout Plain Layout


\backslash
begin{CD}
\end_layout

\begin_layout Plain Layout


\backslash
text{System}~
\backslash
eqref{eq:var-verallgemeinerte-Regelungsnormalform-maxmalphasig} @>{
\backslash
displaystyle
\backslash
text{Zerlegung}}>>
\backslash
text{System}~
\backslash
eqref{eq:var-verallgemeinerte-Regelungsnormalform-minimalphasig}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

@V{
\backslash
displaystyle
\backslash
text{Linearisierung}}VV @VV{
\backslash
displaystyle
\backslash
text{Linearisierung}}V
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

G(s) @>>{
\backslash
displaystyle
\backslash
text{Zerlegung}}> G_
\backslash
text{MP}(s)
\end_layout

\begin_layout Plain Layout


\backslash
end{CD}
\end_layout

\begin_layout Plain Layout


\backslash
]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Entwurf IMC_Regler
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Zur Verallgemeinerung des linearen IMC-Reglers
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Regler-mit-Filter-minimalphasig"

\end_inset

 auf den nichtlinearen Fall lösen wir die letzte Differentialgleichung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-verallgemeinerte-Regelungsnormalform-minimalphasig"

\end_inset

 unter Beachtung von 
\begin_inset Formula $\dot{z}_{n}=y^{(n)}$
\end_inset

 nach der höchsten Zeitableitung des Eingangs auf:
\begin_inset Formula 
\begin{equation}
u^{(n-r)}=\left(-1\right)^{n-r}\,\frac{y^{(n)}-\alpha\left(z,u,-\dot{u},\ddot{u},\ldots,(-1)^{n-r-1}u^{(n-r-1)}\right)}{\beta\left(z,u,-\dot{u},\ddot{u},\ldots,(-1)^{n-r-1}u^{(n-r-1)}\right)u^{(n-r)}}.\label{eq:IMC-max-inv}
\end{equation}

\end_inset

Der Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $z$
\end_inset

 und die Zeitableitung
\begin_inset space ~
\end_inset


\begin_inset Formula $y^{(n)}$
\end_inset

 werden durch ein Zustandsvariablenfilter der Struktur
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-Zustandsvariablenfilter"

\end_inset

, aber der Ordnung
\begin_inset space ~
\end_inset


\begin_inset Formula $n$
\end_inset

, mit dem Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $\hat{z}$
\end_inset

 geschätzt:
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{\hat{z}} & = & \left(A-bk^{T}\right)\hat{z}+a_{0}b\,\tilde{w}\\
\hat{y} & = & c^{T}\hat{z}.
\end{array}\label{eq:Filter-maximalphasig}
\end{equation}

\end_inset

Die so erhaltenen Schätzgrößen setzt man in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-max-inv"

\end_inset

 ein.
 Die Ableitung
\begin_inset space ~
\end_inset


\begin_inset Formula $u^{(n-r)}$
\end_inset

 führt man einer Integratorkette der Länge 
\begin_inset Formula $n-r$
\end_inset

 zu, womit man die in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-max-inv"

\end_inset

 benötigten Ableitungen 
\begin_inset Formula $u^{(n-r-1)},\ldots,\dot{u}$
\end_inset

 und auch den Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 als Stellgröße für die Regelstrecke
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 erhält.
 Das dadurch entstehende Regelungsschema ist in Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regelkreis-IMC-maximalphasig"

\end_inset

 dargestellt.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename IMC-maximalphasig.fig
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Regelkreis mit IMC-Regler eine für maximalphasige Regelstrecke
\begin_inset CommandInset label
LatexCommand label
name "fig:Regelkreis-IMC-maximalphasig"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Hochsetzsteller-IMC-Spannung"

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Hochsetzsteller
\end_layout

\end_inset

Betrachtet wird wieder der Hochsetzsteller.
 Wir verwenden die Kondensatorspannung
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{2}$
\end_inset

 gleichzeitig als Ausgang wie auch als erste Koordinate des transformierten
 Systems:
\begin_inset Formula 
\begin{equation}
z_{1}=y=h(x)=x_{2}.\label{eq:IMC-hochsetzsteller-ausgang-spannung}
\end{equation}

\end_inset

Die zweite Koordinate ist die Zeitableitung des Ausgangs
\begin_inset Formula 
\begin{equation}
z_{2}=\dot{y}=L_{f}h(x)+L_{g}h(x)u=(1-u)\frac{1}{C}x_{1}-\frac{1}{RC}x_{2},\label{eq:IMC-hochsetzsteller-ausgangsableitung}
\end{equation}

\end_inset

die vom Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 abhängt, so dass das System den relativen Grad 
\begin_inset Formula $r=1$
\end_inset

 besitzt.
 Gln.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-hochsetzsteller-ausgang-spannung"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IMC-hochsetzsteller-ausgangsableitung"

\end_inset

 bilden eine vom Eingang abhängige Koordinatentransformation 
\begin_inset Formula $z=\Phi(x,u)$
\end_inset

 mit der Rücktransformation
\begin_inset Formula 
\[
x_{1}=-\frac{z_{1}+RCz_{2}}{(u-1)R},\quad x_{2}=z_{1}.
\]

\end_inset

Aus der zweiten Zeitableitung des Ausgangs
\begin_inset Formula 
\begin{eqnarray*}
\ddot{y} & = & L_{f}^{2}h(x)+\left(L_{g}L_{f}h(x)+L_{f}L_{g}h(x)\right)u+L_{g}^{2}h(x)u^{2}+L_{g}h(x)\dot{u}\\
 & = & -\frac{-Lx_{2}-\left(u-1\right)x_{1}LR+\left(L\dot{u}x_{1}+uE-E+u^{2}x_{2}-2ux_{2}+x_{2}\right)CR^{2}}{C^{2}LR^{2}}\\
 & = & \underbrace{-\frac{Lz_{2}+\left(u-1\right)\left(E+\left(u-1\right)\,z_{1}\right)R}{CLR}}_{{\displaystyle \alpha(z,u)}}+\underbrace{\frac{z_{1}+RCz_{2}}{(u-1)RC}}_{{\displaystyle \beta(z,u)}}\dot{u}
\end{eqnarray*}

\end_inset

erhält man die letzte Zeile der verallgemeinerten Regelungsnormalform:
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{z}_{1} & = & z_{2}\\
\dot{z}_{2} & = & \alpha(z,u)+\beta(z,u)\,\dot{u}\\
y & = & z_{1}
\end{array}\label{eq:hochsetzsteller-verallg-RNF1}
\end{equation}

\end_inset

Durch Zeitumkehr in der Eingangsdynamik, d.
\begin_inset space \thinspace{}
\end_inset

h.
 
\begin_inset Formula $\dot{u}\mapsto-\dot{u}$
\end_inset

, geht das nicht\SpecialChar softhyphen
minimal\SpecialChar softhyphen
phasige System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-verallg-RNF1"

\end_inset

 in die minimalphasige Approximation
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{z}_{1} & = & z_{2}\\
\dot{z}_{2} & = & \alpha(z,u)-\beta(z,u)\,\dot{u}\\
y & = & z_{1}
\end{array}\label{eq:hochsetzsteller-verallg-RNF2}
\end{equation}

\end_inset

über.
 Stellt man die letzte Differentialgleichung in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-verallg-RNF2"

\end_inset

 nach
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{u}$
\end_inset

 um, so erhält man 
\begin_inset Formula 
\begin{equation}
\dot{u}=-\frac{\left(u-1\right)\left(z_{2}L+\left(\dot{z}_{2}CL+uE-E+u^{2}z_{1}-2uz_{1}+z_{1}\right)R\right)}{L\left(z_{2}CR+z_{1}\right)}.\label{eq:hochsetzsteller-maximalphasig-du}
\end{equation}

\end_inset

Die Größen 
\begin_inset Formula $z_{1},z_{2},\dot{z}_{2}$
\end_inset

 lassen sich durch 
\begin_inset Formula $y,\dot{y},\ddot{y}$
\end_inset

 repräsentieren.
 Im IMC-Regler verwendet man dafür die vom Zustandsvariablenfilter 
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{\hat{z}}_{1} & = & \hat{z}_{2}\\
\dot{\hat{z}}_{2} & = & -a_{0}\hat{z}_{1}-a_{1}\hat{z}_{2}+a_{0}\tilde{w}\\
\hat{y} & = & \hat{z}_{1}
\end{array}\label{eq:hochsetzsteller-maxphas-zustandsvarfilter}
\end{equation}

\end_inset

mit 
\begin_inset Formula $a_{0},a_{1}>0$
\end_inset

 generierten Schätzsignale 
\begin_inset Formula $\hat{y},\dot{\hat{y}},\ddot{\hat{y}}$
\end_inset

.
 Die Integration von
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{u}$
\end_inset

 aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-maximalphasig-du"

\end_inset

 liefert das Streckeneingangssignal
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

.
 Mit
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-maximalphasig-du"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-maxphas-zustandsvarfilter"

\end_inset

 erhält man insgesamt einen dynamischen Regler dritter Ordnung.
\end_layout

\begin_layout Example
\begin_inset Note Note
status open

\begin_layout Plain Layout
Numerische Simulation: boost-tracking.imc.spannung.sce 
\end_layout

\end_inset


\end_layout

\begin_layout Example
Für die numerische Simulation wird der Übergang von 
\begin_inset Formula $20\,\text{V}$
\end_inset

 auf 
\begin_inset Formula $25\,\text{V}$
\end_inset

 direkt durch das Führungssignal 
\begin_inset Formula 
\[
w(t)=\left\{ \begin{array}{rcl}
20\,\text{V} & \text{für} & t<50\,\text{ms}\\
25\,\text{V} & \text{für} & t\geq50\,\text{ms}
\end{array}\right.
\]

\end_inset

vorgegeben.
 Wie in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-IMC"

\end_inset

 finden für den Hochsetzsteller die Anfangswerte 
\begin_inset Formula $x_{1}(0)=2\,\text{A}$
\end_inset

 und 
\begin_inset Formula $x_{1}(0)=20\,\text{V}$
\end_inset

 Verwendung.
 Die Anfangswerte des Zustandsvariablenfilters
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-maxphas-zustandsvarfilter"

\end_inset

 lauten 
\begin_inset Formula $\hat{z}_{1}(0)=20$
\end_inset

 und 
\begin_inset Formula $\hat{z}_{2}(0)=0$
\end_inset

.
 Für die Differentialgleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hochsetzsteller-maximalphasig-du"

\end_inset

 des Eingangs gilt 
\begin_inset Formula $u(0)=0,25$
\end_inset

.
 Zusätzlich kommen die Filterkoeffizienten 
\begin_inset Formula $a_{0}=90000$
\end_inset

 und 
\begin_inset Formula $a_{1}=600$
\end_inset

 aus Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Hochsetzsteller-Num-Sim"

\end_inset

 zum Einsatz.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Hochsetzsteller-IMC-Spannung"

\end_inset

 zeigt die simulierten Signalverläufe.
 Zunächst ist der Einschwingvorgang des Hochsetzstellers festzustellen.
 Der Übergang der Ausgangsspannung erfolgt wie gewünscht.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Hochsetzsteller_IMC_Spannung.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulation des Hochsetzstellers mit dem IMC-Regler aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Hochsetzsteller-IMC-Spannung"

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:hochsetzsteller-IMC"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:Hochsetzsteller-IMC-Spannung"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Approximative Linearisierung durch Modifikation
\begin_inset CommandInset label
LatexCommand label
name "sec:Approximative-Linearisierung-Modifikation"

\end_inset


\end_layout

\begin_layout Standard
Bei den bisherigen Betrachtung wurde für das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 immer ein wohldefinierter relativer Grad vorausgesetzt.
 Andernfalls ist die in Kapitel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:regler-grundlagen"

\end_inset

 beschriebene exakte Linearisierung nicht (direkt) anwendbar.
 Mit dem in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hauser92"

\end_inset

 vorgestellten Zugang wird bei nicht wohldefiniertem relativen Grad eine
 approximative Linearisierung erzielt
\begin_inset Index idx
status open

\begin_layout Plain Layout
Linearisierung!approximative
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
im Detail ...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Der relative Grad von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem"

\end_inset

 ist im Punkt 
\begin_inset Formula $p\in\mathcal{M}$
\end_inset

 
\shape italic
nicht
\shape default
 wohldefiniert, wenn die erste nicht verschwindende Lie-Ableitung im Punkt
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 Null ist, d.
\begin_inset space \thinspace{}
\end_inset

h.
 
\begin_inset Formula 
\[
L_{g}L_{f}^{r-1}h(x)\not\equiv0,\quad\text{aber}\quad L_{g}L_{f}^{r-1}h(p)=0.
\]

\end_inset

Das bedeutet, dass beim ersten Auftreten des Eingangs in den Zeitableitungen
 des Ausgangs 
\begin_inset Formula 
\[
\begin{array}{lcl}
y & = & h(x)\\
 & \vdots\\
y^{(r-1)} & = & L_{f}^{r-1}h(x)\\
y^{(r)} & = & L_{f}^{r}h(x)+L_{g}L_{f}^{r-1}h(x)\,u
\end{array}
\]

\end_inset

der Faktor 
\begin_inset Formula $L_{g}L_{f}^{r-1}h(x)$
\end_inset

 vor dem Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 im Punkt
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 verschwindet.
 Aus Stetigkeitsgründen ist dann 
\begin_inset Formula $L_{g}L_{f}^{r-1}h(x)$
\end_inset

 für alle
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 aus einer (hinreichend kleinen) Umgebung von
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 auch betragsmäßig klein.
 Der in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hauser92"

\end_inset

 vorgestellte Ansatz beruht darauf, dass man den Term 
\begin_inset Formula $L_{g}L_{f}^{r-1}h(x)u$
\end_inset

 vernachlässigt und weiter differenziert.
 Diese Ableitungsbildung unter Vernachlässigung des angegebenen Terms lässt
 sich über Lie-Ableitungen entlang des Vektorfelds
\begin_inset space ~
\end_inset


\begin_inset Formula $f$
\end_inset

 darstellen.
 Unter dem sich dabei ergebenden Diffeomorphismus 
\begin_inset Formula $\xi=\Phi(x)$
\end_inset

 mit 
\begin_inset Formula $\xi_{1}=h(x),\,\xi_{2}=L_{f}h(x),\ldots,\xi_{n}=L_{f}^{n-1}h(x)$
\end_inset

 erhält man das transformierte System
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{r-1} & = & \xi_{r}\\
\dot{\xi}_{r} & = & \xi_{r+1}+\beta_{r}(\xi)\,u\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}+\beta_{n-1}(\xi)\,u\\
\dot{\xi}_{n} & = & \alpha_{n}(\xi)+\beta_{n}(\xi)\,u
\end{array}\label{eq:var-approx-ARNF}
\end{equation}

\end_inset

mit 
\begin_inset Formula 
\[
\alpha_{n}(\xi)=L_{f}^{n}h(\Phi^{-1}(\xi)),\quad\beta_{i}(\xi)=L_{g}L_{f}^{i-1}h(\Phi^{-1}(\xi)),\quad i=r,\ldots,n.
\]

\end_inset


\end_layout

\begin_layout Standard
Für die approximative Linearisierung
\begin_inset Index idx
status open

\begin_layout Plain Layout
Linearisierung!approximative
\end_layout

\end_inset

 nehmen wir an, dass die Terme 
\begin_inset Formula $\beta_{r},\ldots\beta_{n-1}$
\end_inset

 im betreffenden Arbeitsbereich (betragsmäßig) kleine Werte annehmen, der
 Term
\begin_inset space ~
\end_inset


\begin_inset Formula $\beta_{n}$
\end_inset

 sich aber erheblich von der Null unterscheidet.
 Die Linearisierung durch Rückführung führt man in der letzten Zeile von
 System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-ARNF"

\end_inset

 mit dem fiktiven Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $v$
\end_inset

 durch:
\begin_inset Formula 
\begin{equation}
v\stackrel{!}{=}\alpha_{n}(\xi)+\beta_{n}(\xi)\,u\quad\Longleftrightarrow\quad u=\frac{1}{\beta_{n}(\xi)}\left(v-\alpha_{n}(\xi)\right).\label{eq:var-approximativ-linearisierende-rueckfuehrung}
\end{equation}

\end_inset

Zur Stabilisierung kombiniert man die (approximativ) linearisierende Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approximativ-linearisierende-rueckfuehrung"

\end_inset

 mit der Rückführung 
\begin_inset Formula $v=-k^{T}\xi$
\end_inset

.
 Die Verstärkung 
\begin_inset Formula $k^{T}=(a_{0},\ldots,a_{n})$
\end_inset

 enthält die Koeffizienten eines vorgegebenen charakteristischen Polynoms
\begin_inset Formula 
\begin{equation}
\det\left(sI-\left(A-bk^{T}\right)\right)=a_{0}+a_{1}s+\cdots+a_{n-1}s^{n-1}+s^{n}.\label{eq:var-al-char-poly}
\end{equation}

\end_inset

Somit erhält man für die Originalkoordinaten in Anlehnung an Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:E-A-Linearisierung-affin"

\end_inset

 das Regelgesetz
\begin_inset Formula 
\begin{equation}
u=-\frac{1}{L_{g}L_{f}^{n-1}h(x)}\sum_{i=0}^{n}a_{i}L_{f}^{i}h(x)\quad\text{mit}\quad a_{n}:=1.\label{eq:var-approx-rueckfuehrung-x}
\end{equation}

\end_inset

In ähnlicher Weise lassen sich auch die in den Abschnitten
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedback"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedforward"

\end_inset

 beschriebenen Rückführungen für Trajektorienfolgeregelungen nutzen.
 Die Stabilisierung des rückgeführten Systems kann man mit Überlegungen
 des High-Gain-Entwurfs begründen (vgl.
 Kapitel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:High-Gain-Beobachter"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Wagen-Pendel-System mit Ausgang für relativen Grad r=3, Wagen_mit_Pendel_Approx_
Lin_Hauser.wxmx
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die approximative Linearisierung wird in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hauser92,sastry1999"

\end_inset

 am Beispiel eines Balls auf einem Balken (engl.
 ball & beam example) untersucht.
 Dieses Beispiel wurde in etlichen weiteren Veröffentlichungen aufgegriffen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "leith2001,zhang2006feedback"

\end_inset

.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "zimmer1995,sastry1998helicopter"

\end_inset

 wird die approximtive Linearisierung eines Hubschraubermodells behandelt.
 Das folgende Beispiel ist an
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "aguilar2002approximate"

\end_inset

 angelehnt:
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:wagen-pendel-approximativ"

\end_inset

Wir betrachten das partiell linearisierte Modell des Wagen-Pendel-Systems
 aus Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Wagen-mit-Pendel"

\end_inset

 und Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Wagen-Pendel-partielle-Linearisierung"

\end_inset

 unter Vernachlässigung der Reibung:
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & v\\
\dot{x}_{3} & = & x_{4}\\
\dot{x}_{4} & = & -\frac{g}{l}\sin x_{3}-\frac{1}{l}v\cos x_{3}\\
y & = & x_{1}.
\end{array}\label{eq:var-approx-wagen-pendel-linearisiert}
\end{equation}

\end_inset

In Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Wagen-Pendel-max-rel-grad"

\end_inset

 wurde für dieses System der (fiktive) Ausgang
\begin_inset Formula 
\begin{equation}
h(x)=x_{1}+\frac{l}{2}\ln\left(\frac{1+\sin x_{3}}{1-\sin x_{3}}\right)\label{eq:var-approx-wagen-ausgang-r-3}
\end{equation}

\end_inset

ermittelt, mit dem das System wegen 
\begin_inset Formula $L_{g}h(x)=L_{g}L_{f}h(x)=0$
\end_inset

 und 
\begin_inset Formula $L_{g}L_{f}^{2}h(x)=-2x_{4}\tan x_{3}$
\end_inset

 für 
\begin_inset Formula $x_{3}\neq k\pi$
\end_inset

, 
\begin_inset Formula $k\in\Z$
\end_inset

 und 
\begin_inset Formula $x_{4}\neq0$
\end_inset

 den (maximalen) relativen Grad 
\begin_inset Formula $r=3$
\end_inset

 besitzt.
 Im Punkt 
\begin_inset Formula $x=0$
\end_inset

 ist der relative Grad damit nicht definiert.
 Für die Approximation gehen wir von 
\begin_inset Formula $x_{3}\approx0$
\end_inset

 (kleine Auslenkung des Pendels) und 
\begin_inset Formula $x_{4}\approx0$
\end_inset

 (kleine Winkelgeschindigkeit) aus und bestimmen die gemischte Lie-Ableitung
 der nächsthöheren Ordnung: 
\begin_inset Formula 
\begin{equation}
L_{g}L_{f}^{3}h(x)=\frac{\left(3l\cos\left(2x_{3}\right)-9l\right)x_{4}^{2}+\left(\cos\left(3x_{3}\right)-3\cos x_{3}\right)g}{l\left(\cos\left(2x_{3}\right)+1\right)}.\label{eq:var-approx-wagen-gemischte-Lie-Ableitung}
\end{equation}

\end_inset

Mit 
\begin_inset Formula $L_{g}L_{f}^{3}h(0)=-g/l$
\end_inset

 ist dieser Term im Arbeitspunkt 
\begin_inset Formula $x=0$
\end_inset

 nicht vernachlässigbar.
 Für die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-rueckfuehrung-x"

\end_inset

 benötigt man neben
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-wagen-gemischte-Lie-Ableitung"

\end_inset

 und dem Ausgang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-wagen-ausgang-r-3"

\end_inset

 noch die Lie-Ableitungen
\begin_inset Formula 
\[
\begin{array}{lcl}
L_{f}h(x) & = & x_{2}+\frac{lx_{4}}{\cos x_{3}}\\
L_{f}^{2}h(x) & = & \tan x_{3}\left(g+\frac{lx_{4}^{2}}{\cos x_{3}}\right)\\
L_{f}^{3}h(x) & = & 2gx_{4}\,\frac{1-\cos(2x_{3})}{1+\cos(2x_{3})}+lx_{4}^{3}\,\frac{1-\sin^{4}x_{3}}{\cos^{5}x_{3}}\\
L_{f}^{4}h(x) & = & 2lx_{4}^{4}\frac{\sin x_{3}}{\cos^{2}x_{3}}\left(\frac{6}{\cos^{2}x_{3}}-1\right)+3gx_{4}^{2}\sin x_{3}\left(\frac{4}{\cos^{2}x_{3}}-1\right)\\
 &  & +\,\frac{g^{2}}{l}\sin x_{3}\left(\frac{3}{\cos^{2}x_{3}}-2\right).
\end{array}
\]

\end_inset


\end_layout

\begin_layout Example
Zur numerischen Simulation verwenden wir mit Ausnahme von 
\begin_inset Formula $d_{1}=0$
\end_inset

 und 
\begin_inset Formula $d_{2}=0$
\end_inset

 (Vernachlässigung der Reibung) die Parameter und Anfangswerte aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Wagen-Pendel-Stabilisierung-Simulation"

\end_inset

.
 Die Eigenwerte werden durch 
\begin_inset Formula $s_{1,2}=-2$
\end_inset

 und 
\begin_inset Formula $s_{3,4}=-3$
\end_inset

 vorgegeben.
 Das Simulationsergebnis ist Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Simulation-Wagen-Pendel-Approx-Lin"

\end_inset

 zu entnehmen.
 Im Unterschied zur Regelung mittels Eingangs-Ausgangs-Linearisierung in
 Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Wagen-Pendel-Stabilisierung-Simulation"

\end_inset

 wird jetzt die Dynamik für alle Zustände eingeprägt.
 Im Vergleich zu Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Simulation-Wagen-Pendel-System"

\end_inset

 erfolgt hier ein schnelleres Einschwingen.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Wagen_Pendel_Approx.pdf
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulationsergebnis des geregelten Wagen-Pendel-Systems
\begin_inset CommandInset label
LatexCommand label
name "fig:Simulation-Wagen-Pendel-Approx-Lin"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Interpretation als Modifikation von f bzw.
 g
\end_layout

\end_inset


\end_layout

\begin_layout Remark
Den Reglerentwurf führt man nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-rueckfuehrung-x"

\end_inset

 so durch, als ob die Terme 
\begin_inset Formula $\beta_{r},\ldots,\beta_{n-1}$
\end_inset

 in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-ARNF"

\end_inset

 identisch Null wären.
 Diese Annahme kann man auch als Modifikation des Systems interpretieren,
 wodurch das resultierende System eingangs-zustands-linearisierbar wird.
 Das Nullsetzen von 
\begin_inset Formula $\beta_{r},\ldots,\beta_{n-1}$
\end_inset

 in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-approx-ARNF"

\end_inset

 führt in Originalkoordinaten auf das modifizierte Vektorfeld 
\begin_inset Formula 
\[
\tilde{g}(x)=\left[\Phi^{\prime}(x)\right]^{-1}\cdot\left.\beta_{n}(z)\frac{\partial}{\partial z_{n}}\right|_{z=\Phi(x)}=L_{g}L_{f}^{n-1}h(x)\cdot\left[\Phi^{\prime}(x)\right]^{-1}\cdot e_{n}.
\]

\end_inset

In ähnlicher Weise kann man auch durch Modifikation des Vektorfeldes
\begin_inset space ~
\end_inset


\begin_inset Formula $f$
\end_inset

 ein eingangs-zustands-linearisierbares System erzeugen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "hauser92"

\end_inset

.
\end_layout

\begin_layout Section
Approximative Linearisierung durch Reihenentwicklung
\begin_inset CommandInset label
LatexCommand label
name "sec:Approximative-Linearisierung-Reihenentwicklung"

\end_inset


\end_layout

\begin_layout Standard
Um die einschränkenden Existenzbedingungen bzw.
 die schwierige Berechnung für eine exakte Eingangs-Zustands-Linearisierung
 zu umgehen, wurden in der Fachliteratur zahlreiche Approximationsansätze
\begin_inset Index idx
status open

\begin_layout Plain Layout
Linearisierung!approximative
\end_layout

\end_inset

 vorgeschlagen
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "reboulet84,baumann86,guardabassi2001"

\end_inset

.
 Etliche Veröffentlichungen basieren auf einer Transformation des betreffenden
 Systems in die Poincaré-Normalform
\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!Poincaré-
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "krener84,krener90,krener91poincare,devanathan2001,devanathan2004"

\end_inset

.
 Dabei setzt man sowohl für das System als auch für die Transformation
\begin_inset space ~
\end_inset


\begin_inset Formula $\Phi$
\end_inset

 eine mehrvariable Taylor\SpecialChar softhyphen
reihe an und versucht, die von den Nichtlinearitäten
 herrührenden Terme höherer Ordnung schrittweise zu eliminieren.
 Da die Anzahl der Terme einer mehrvariablen Taylorentwicklung exponentiell
 mit der Entwicklungsordnung wächst, ist dieser Ansatz nur bedingt praktikabel.
 
\end_layout

\begin_layout Standard
Der in diesem Abschnitt vorgestellte Zugang nach
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "roebenack2012pamm,roebenack2013ecc,franke2015buch"

\end_inset

 vermeidet die Reihenentwicklung der Koordinatentransformation und kann
 in gewisser Weise als das Gegenstück zum erweiterten Luenberger-Beobachter
 aufgefasst werden (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Luenberger"

\end_inset

).
\end_layout

\begin_layout Subsection
Vorüberlegungen und exakte Linearisierung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Approx-exakt"

\end_inset


\end_layout

\begin_layout Standard
Man betrachte eine eingangsaffine Regelstrecke 
\begin_inset Formula 
\begin{equation}
\dot{x}=f(x)+g(x)\,u\label{eq:var-basissystem-ohne-ausgang}
\end{equation}

\end_inset

mit hinreichend glatten Vektorfeldern 
\begin_inset Formula $f,g:\mathcal{M}\to\R^{n}$
\end_inset

 auf einer offenen Menge 
\begin_inset Formula $\mathcal{M}\subseteq\R^{n}$
\end_inset

.
 Das System ist in einem Punkt 
\begin_inset Formula $p\in\mathcal{M}$
\end_inset

 exakt eingangs-zustands-linearisierbar, wenn es eine Ausgangsabbildung
 
\begin_inset Formula $h:\mathcal{M}\to\R$
\end_inset

 gibt, für die das System den relativen Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $n$
\end_inset

 besitzt, also
\begin_inset Formula 
\begin{equation}
L_{g}h(x)=0,\;L_{g}L_{f}h(x)=0,\;\ldots,\;L_{g}L_{f}^{n-2}h(x)=0,\;L_{g}L_{f}^{n-1}h(p)\neq0\label{eq:var-al-rel-grad-n-allgemein}
\end{equation}

\end_inset

für alle
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 aus einer Umgebung von
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 gilt (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exakte-Eingangs-Zustands-Linearisierung"

\end_inset

).
 Wir gehen im Folgenden von der etwas strengeren Bedingung
\begin_inset Formula 
\begin{equation}
L_{g}h(x)=0,\;L_{g}L_{f}h(x)=0,\;\ldots,\;L_{g}L_{f}^{n-2}h(x)=0,\;L_{g}L_{f}^{n-1}h(x)=1\label{eq:var-al-rel-grad-n-speziell}
\end{equation}

\end_inset

für alle
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 aus einer Umgebung von
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 aus.
\begin_inset Foot
status open

\begin_layout Plain Layout
Gilt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-rel-grad-n-allgemein"

\end_inset

, dann kann die Bedingung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-rel-grad-n-speziell"

\end_inset

 immer durch eine zustandsäbhängige Eingangstransformation 
\begin_inset Formula $u\mapsto\tfrac{1}{L_{g}L_{f}^{n-1}h(x)}u$
\end_inset

 erzwungen werden (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:EZ-Linearisierung-Formen"

\end_inset

).
\end_layout

\end_inset

 Die Ausgangsabbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 ist die Lösung der (partiellen) Differentialgleichung 
\begin_inset Formula 
\begin{equation}
\d h(x)=\omega(x),\label{eq:var-al-dh-omega}
\end{equation}

\end_inset

wobei sich das Kovektorfeld
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

 aus der Steuerbarkeitsmatrix
\begin_inset Index idx
status open

\begin_layout Plain Layout
Steuerbarkeitsmatrix
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Matrix!Steuerbarkeits-
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{equation}
Q_{S}(x)=\left(g(x),\ad_{-f}g(x),\ldots,\ad_{-f}^{n-1}g(x)\right)\label{eq:var-al-steuerbarkeitsmatrix}
\end{equation}

\end_inset

entsprechend
\begin_inset Formula 
\begin{equation}
\omega(x)=e_{n}^{T}Q_{S}^{-1}(x)\label{eq:var-al-startkovektor}
\end{equation}

\end_inset

mit dem 
\begin_inset Formula $n$
\end_inset

-ten Einheitsvektor
\begin_inset space ~
\end_inset


\begin_inset Formula $e_{n}$
\end_inset

 ergibt.
 Kennt man die Abbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

, dann lässt sich das System mit dem Diffeomorphismus 
\begin_inset Formula 
\begin{equation}
\xi=\Phi(x)=\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
\vdots\\
L_{f}^{n-1}h(x)
\end{array}\right),\quad x=\Psi(\xi):=\Phi^{-1}(\xi)\label{eq:var-al-transformation}
\end{equation}

\end_inset

in die spezielle Variante
\begin_inset Formula 
\begin{equation}
\left.\begin{array}{lcl}
\dot{\xi}_{1} & = & \xi_{2}\\
 & \vdots\\
\dot{\xi}_{n-1} & = & \xi_{n}\\
\dot{\xi}_{n} & = & \alpha(\xi)+u\\
y & = & \xi_{1}
\end{array}\right\} \quad\begin{array}{rcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi)+u)\\
y & = & c^{T}\xi
\end{array}\label{eq:var-Regelungs-NF-speziell}
\end{equation}

\end_inset

der Regelungsnormalform transformieren (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:EZ-Linearisierung-Formen"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Zielsetzung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In diesem Abschnitt erfolgt der Reglerentwurf ohne explizite Kenntnis der
 zur exakten Eingangs-Zustands-Linearisierung benötigten Ausgangsabbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

.
 Das bedeutet, dass zwar die Flachheit des Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem-ohne-ausgang"

\end_inset

 vorausgesetzt wird (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Flacher-nichtflacher-Ausgang"

\end_inset

), der flache Ausgang aber nicht unmittelbar für die Regelung benötigt wird.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Herleitung für exakte Linearisierung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die gewünschte Dynamik von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem-ohne-ausgang"

\end_inset

 sei durch Referenztrajektorien 
\begin_inset Formula $u_{\text{ref}}(\cdot)$
\end_inset

 und 
\begin_inset Formula $x_{\text{ref}}(\cdot)$
\end_inset

 gegeben, d.
\begin_inset space \thinspace{}
\end_inset

h.
 diese Referenztrajektorien genügen der Systemgleichung
\begin_inset Formula 
\begin{equation}
\dot{x}_{\text{ref}}=f(x_{\text{ref}})+g(x_{\text{ref}})\,u_{\text{ref}}.\label{eq:var-al-referenz-system}
\end{equation}

\end_inset

Die Berechnung dieser Trajektorien ist rein numerisch über die Lösung einer
 entsprechenden Randwertaufgabe möglich (vgl.
 Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Berechnung-Referenztraj-randwert"

\end_inset

).
 Ähnlich wie in den Abschnitten
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedback"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedforward"

\end_inset

 teilen wir das Eingangssignal 
\begin_inset Formula 
\[
u=u_{\text{ref}}+u_{\text{stab}}
\]

\end_inset

in jeweils einen Anteil zur Vorsteuerung und zur Stabilisierung auf.
 Die Vorsteuerung erfolgt über die Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $u_{\text{ref}}$
\end_inset

.
 Die Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 soll über eine Rückführung 
\begin_inset Formula $\kappa:\mathcal{M}\to\R$
\end_inset

 mit
\begin_inset Formula 
\begin{equation}
u_{\text{stab}}=u-u_{\text{ref}}=-\kappa(x)\label{eq:var-al-stab}
\end{equation}

\end_inset

stabilisiert werden.
 Der geschlossene Regelkreis nimmt dadurch die Form
\begin_inset Formula 
\[
\dot{x}=f(x)+g(x)\left(u_{\text{ref}}-\kappa(x)\right)
\]

\end_inset

an.
\end_layout

\begin_layout Standard
Der eigentliche Reglerentwurf erfolgt zunächst in der Normalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF-speziell"

\end_inset

.
 Mit dem Ansatz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-stab"

\end_inset

 erhält man 
\begin_inset Formula 
\[
\begin{array}{lcl}
\dot{\xi} & = & A\xi+b(\alpha(\xi)+u)\\
 & = & A\xi+b(\alpha(\xi)+u_{\text{ref}}-\kappa(\Psi(\xi))
\end{array}
\]

\end_inset

für die Regelstrecke
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF-speziell"

\end_inset

.
 Das transformierte Referenzsystem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-referenz-system"

\end_inset

 nimmt die Gestalt
\begin_inset Formula 
\[
\dot{\xi}_{\text{ref}}=A\xi_{\text{ref}}+b\left(\alpha(\xi_{\text{ref}})+u_{\text{ref}}\right)
\]

\end_inset

an.
 Der Folgefehler 
\begin_inset Formula $\tilde{\xi}=\xi-\xi_{\text{ref}}$
\end_inset

 genügt damit der Differentialgleichung
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{\tilde{\xi}} & = & \dot{\xi}-\dot{\xi}_{\text{ref}}\\
 & = & A\tilde{\xi}+b(\alpha(\xi)-\alpha(\xi_{\text{ref}})-\kappa(\Psi(\xi)).
\end{array}\label{eq:var-al-fehlerdyn1}
\end{equation}

\end_inset

Mit der Rückführung 
\begin_inset Formula 
\begin{equation}
\kappa(x)=\kappa(\Phi^{-1}(\xi))=\alpha(\xi)-\alpha(\xi_{\text{ref}})+k^{T}\tilde{\xi},\quad k\in\R^{n}\label{eq:var-al-regler-exakt-xi}
\end{equation}

\end_inset

erhält man eine exakt lineare Fehlerdynamik
\begin_inset Formula 
\begin{equation}
\dot{\tilde{\xi}}=\left(A-bk^{T}\right)\tilde{\xi}.\label{eq:var-al-fehlerdynamik-linear}
\end{equation}

\end_inset

Setzt man dabei die Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset Formula $k$
\end_inset

 in der Form 
\begin_inset Formula $k^{T}=\left(a_{0},\ldots,a_{n-1}\right)$
\end_inset

 an, so ergibt sich (bedingt durch die Brunovský-Form des Paares 
\begin_inset Formula $(A,b)$
\end_inset

) das charakteristische Polynom
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-char-poly"

\end_inset

.
 In Originalkoordinaten nimmt das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-regler-exakt-xi"

\end_inset

 die Form
\begin_inset Formula 
\begin{equation}
\kappa(x)=\sum_{i=0}^{n}a_{i}L_{f}^{i}h(x)-\sum_{i=0}^{n}a_{i}\underbrace{L_{f}^{i}h(x_{\text{ref}}(t))}_{{\displaystyle y_{\text{ref}}^{(i)}}(t)}\label{eq:var-al-regler-exakt}
\end{equation}

\end_inset

mit der Ausgangsreferenztrajektorie 
\begin_inset Formula $y_{\text{ref}}(\cdot)=h(x_{\text{ref}}(\cdot))$
\end_inset

 und 
\begin_inset Formula $a_{n}:=1$
\end_inset

 an.
\begin_inset Foot
status open

\begin_layout Plain Layout
Bedingt durch die Abhängigkeit von der Referenztrajektorie ist die Rückführung
\begin_inset space ~
\end_inset


\begin_inset Formula $\kappa$
\end_inset

 auch von der Zeit
\begin_inset space ~
\end_inset


\begin_inset Formula $t$
\end_inset

 abhängig.
 Aus Gründen der Übersichtlichkeit wurde auf die explizite Angabe dieser
 Abhängigkeit verzichtet.
\end_layout

\end_inset

 Dieses Regelgesetz ist eine spezielle Variante der in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Trajektorienfolgeregelung-Feedback"

\end_inset

 vorgestellten Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:folgeregelung-feedback"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Inverses Pendel mit Motor, exakte EZ-Linearisierung
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Inverses-Pendel-Approx-Exakt"

\end_inset

Das in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:inverses-pendel-gleichstrommotor"

\end_inset

 modellierte inverse Pendel mit Gleich\SpecialChar softhyphen
strom\SpecialChar softhyphen
antrieb lässt sich durch ein
 System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem-ohne-ausgang"

\end_inset

 mit den Vektorfeldern
\begin_inset Formula 
\begin{equation}
f(x)=\left(\begin{array}{c}
x_{2}\\
\frac{mg\ell}{J}\sin x_{1}-\frac{d}{J}x_{2}+\frac{K}{J}x_{3}\\
-\frac{K}{L}x_{2}-\frac{R}{L}x_{3}
\end{array}\right),\quad g(x)=\left(\begin{array}{c}
0\\
0\\
\frac{1}{L}
\end{array}\right)\label{eq:var-al-inv-pend-system}
\end{equation}

\end_inset

beschreiben.
 Im Zusammenhang mit einer exakten Eingangs-Zustands-Linearisierung wurde
 in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:inverses-pendel-gleichstrommotor-formen"

\end_inset

 entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-startkovektor"

\end_inset

 das Kovektorfeld
\begin_inset Formula 
\begin{equation}
\omega(x)=\left(\unit{\tfrac{JL}{K}},0,0\right)=\tfrac{JL}{K}\,\d x_{1}\label{eq:var-al-inv-pend-omega}
\end{equation}

\end_inset

ermittelt.
 Durch Integration erhält man daraus die Ausgangsabbildung 
\begin_inset Formula $h(x)=\tfrac{JL}{K}x_{1},$
\end_inset

 mit der das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-inv-pend-system"

\end_inset

 die Bedingung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-rel-grad-n-speziell"

\end_inset

 erfüllt und daher zustandsäquivalent zu der speziellen Regelungsnormalform
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF-speziell"

\end_inset

 ist.
 Das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-regler-exakt"

\end_inset

 lässt sich unmittelbar über die Lie-Ableitungen des Skalarfeldes
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 entlang des Vektorfeldes
\begin_inset space ~
\end_inset


\begin_inset Formula $f$
\end_inset

 berechnen.
\end_layout

\begin_layout Subsection
Approximation nullter Ordnung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Approx-nullter-Ordnung"

\end_inset


\end_layout

\begin_layout Standard
Das exakt linearisierende Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-regler-exakt"

\end_inset

 setzt die Kenntnis der Ausgangsabbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 voraus.
 Die nachfolgenden Überlegungen führen auf ein Regelgesetz, für dessen Berechnun
g die nur als Hilfsgröße eingeführte Ausgangsabbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 nicht unmittelbar benötigt wird.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Im Detail ...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Wir betrachten die Reihenentwicklung 
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\kappa(\Psi(\xi)) & = & \left.\frac{\partial\kappa}{\partial x}\frac{\partial x}{\partial\xi}\right|_{\xi_{\text{ref}}}\cdot(\xi-\xi_{\text{ref}})+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right)\\
 & = & \d\kappa(x_{\text{ref}})\cdot\Psi^{\prime}(\xi_{\text{ref}})\cdot\tilde{\xi}+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right)
\end{array}\label{eq:var-al-reihe1}
\end{equation}

\end_inset

des gesuchten Regelgesetzes 
\begin_inset Formula $\kappa(\Psi(\xi))$
\end_inset

 entlang der Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $\xi_{\text{ref}}$
\end_inset

.
 Bei dieser Reihenentwicklung entfällt das Absolutglied, da dessen Anteil
 schon in der Steuerung
\begin_inset space ~
\end_inset


\begin_inset Formula $u_{\text{ref}}$
\end_inset

 Berücksichtigung findet.
 Setzt man die Reihenentwicklung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-reihe1"

\end_inset

 in die Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdyn1"

\end_inset

 ein, so erhält man 
\begin_inset Formula 
\begin{equation}
\dot{\tilde{\xi}}=\left(A-b\d\kappa(x_{\text{ref}})\Psi^{\prime}(\xi_{\text{ref}})\right)\tilde{\xi}+b(\alpha(\xi)-\alpha(\xi_{\text{ref}}))+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right).\label{eq:var-al-fehlerdyn2}
\end{equation}

\end_inset

Den Gradienten 
\begin_inset Formula $\d\kappa$
\end_inset

 ersetzen wir durch ein allgemeines Kovektorfeld
\begin_inset Formula 
\begin{equation}
\sigma(x_{\text{ref}})=\d\kappa(x_{\text{ref}}).\label{eq:var-al-verstaerkung-als-gradient}
\end{equation}

\end_inset

Mit der Wahl 
\begin_inset Formula 
\begin{equation}
\sigma(x_{\text{ref}})=k^{T}\cdot\left(\Psi^{\prime}(\xi_{\text{ref}})\right)^{-1}\label{eq:var-al-verstaerkung-z}
\end{equation}

\end_inset

geht die Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdyn2"

\end_inset

 in die Differentialgleichung
\begin_inset Formula 
\begin{equation}
\dot{\tilde{\xi}}=\left(A-bk^{T}\right)\tilde{\xi}+b(\alpha(\xi)-\alpha(\xi_{\text{ref}}))+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right)\label{eq:var-al-fehlerdyn-ordnung-0}
\end{equation}

\end_inset

über.
 In der Reihenentwicklung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdyn-ordnung-0"

\end_inset

 liefert die Differenz 
\begin_inset Formula $\alpha(\xi)-\alpha(\xi_{\text{ref}})$
\end_inset

 den Beitrag 
\begin_inset Formula $\d\alpha(\xi_{\text{ref}})$
\end_inset

 zu den Termen erster Ordnung.
 Dieser Anteil wird nicht exakt kompensiert, sondern soll vom linearen Teil
 
\begin_inset Formula $A-bk^{T}$
\end_inset

 dominiert werden.
 Daher ist die Fehlerdynamik
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdyn-ordnung-0"

\end_inset

 nur als Approximation nullter Ordnung einer exakt linearen Fehlerdifferentialgl
eichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdynamik-linear"

\end_inset

 aufzufassen.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Darstellung in Originalkoordinaten
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Das aus der Steuerbarkeitsmatrix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-steuerbarkeitsmatrix"

\end_inset

 nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-startkovektor"

\end_inset

 berechnete Kovektorfeld
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

 erfüllt unter der Annahme
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-rel-grad-n-speziell"

\end_inset

 die Bedingung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-dh-omega"

\end_inset

.
 Das bedeutet, dass 
\begin_inset Formula $\omega$
\end_inset

 ein exaktes Differential ist.
 Nach Proposition
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "prop:Kovektorfelder"

\end_inset

 gilt somit 
\begin_inset Formula $\d L_{f}h(x)=L_{f}\d h(x)=L_{f}\omega(x)$
\end_inset

.
 Daher lässt sich die Jacobimatrix der Transformation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-transformation"

\end_inset

 ohne explizite Kenntnis des Ausgangs
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 darstellen:
\begin_inset Formula 
\[
\left(\Psi^{\prime}(\xi)\right)^{-1}=\Phi^{\prime}(x)=\frac{\partial}{\partial x}\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
\vdots\\
L_{f}^{n-1}h(x)
\end{array}\right)\!=\!\left(\begin{array}{c}
\d h(x)\\
\d L_{f}h(x)\\
\vdots\\
\d L_{f}^{n-1}h(x)
\end{array}\right)\!=\!\left(\begin{array}{c}
\omega(x)\\
L_{f}\omega(x)\\
\vdots\\
L_{f}^{n-1}\omega(x)
\end{array}\right).
\]

\end_inset

Die vom Referenzzustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 abhängige Verstärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-z"

\end_inset

 kann dann in Originalkoordinaten 
\begin_inset Formula 
\begin{equation}
\sigma(x_{\text{ref}})=a_{0}\omega(x_{\text{ref}})+a_{1}L_{f}\omega(x_{\text{ref}})+\cdots+a_{n-1}L_{f}^{n-1}\omega(x_{\text{ref}})\label{eq:var-al-verstaerkung-x}
\end{equation}

\end_inset

unter Verwendung der Koeffizienten des charakteristischen Polynoms
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-char-poly"

\end_inset

 angegeben werden.
 Die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-stab"

\end_inset

 nimmt unter Beachtung von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-reihe1"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-als-gradient"

\end_inset

 die Form 
\begin_inset Formula 
\[
\kappa(x)=\sigma(x_{\text{ref}})\,(x-x_{\text{ref}})=\sigma(x_{\text{ref}})\,\tilde{x}
\]

\end_inset

an.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Forsetzung Beispiel (Inverses Pendel mit Gleichstrommotor)
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Inverses-Pendel-Approx-0"

\end_inset

Für das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-inv-pend-system"

\end_inset

 aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Approx-Exakt"

\end_inset

 erhält man das in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-inv-pend-omega"

\end_inset

 angegebene Kovektorfeld
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

.
 Daraus berechnet man nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-x"

\end_inset

 mit 
\shape smallcaps
Maxima
\shape default
 unter Zuhilfenahme der in Alg.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Lie-Ableitung-Kovektor"

\end_inset

 beschriebenen Routine 
\family typewriter
LieCovector
\family default
 die folgende Reglerverstärkung:
\end_layout

\begin_layout Example
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{maxima}
\backslash
input{Inverses_Pendel_Approx_0.tex}
\backslash
end{maxima}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Approximation erster Ordnung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Approx-erster-Ordnung"

\end_inset


\end_layout

\begin_layout Standard
Das im letzten Abschnitt hergeleitete Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-x"

\end_inset

 soll dahingehend verbessert werden, dass man eine näherlungsweise lineare
 Fehlerdynamik und damit eine Approximation erster Ordnung erhält.
 Dazu führen wir eine Reihenentwicklung der Nichtlinearität
\begin_inset space ~
\end_inset


\begin_inset Formula $\alpha$
\end_inset

 entlang der Referenztrajektorie durch
\begin_inset Formula 
\[
\alpha(\xi)=\alpha(\xi_{\text{ref}})+\d\alpha(\xi_{\text{ref}})\,\tilde{\xi}+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right)
\]

\end_inset

und setzen diesen Ansatz in die Fehlerdifferentialgleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-fehlerdyn2"

\end_inset

 ein:
\begin_inset Formula 
\[
\dot{\tilde{\xi}}=\left(A-b\left(\d\kappa(x_{\text{ref}})\Psi^{\prime}(\xi_{\text{ref}})-\d\alpha(\xi_{\text{ref}})\right)\right)\tilde{\xi}+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right).
\]

\end_inset

Um eine näherungsweise lineare Fehlerdynamik
\begin_inset Formula 
\begin{equation}
\dot{\tilde{\xi}}=\left(A-bk^{T}\right)\tilde{\xi}+\mathcal{O}\left(\|\tilde{\xi}\|^{2}\right)\label{eq:var-al-fehlerdyn-ordnung-1}
\end{equation}

\end_inset

zu erzeugen, muss die Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-als-gradient"

\end_inset

 entsprechend
\begin_inset Formula 
\begin{equation}
\sigma(x_{\text{ref}})=k^{T}\left(\Psi^{\prime}(\xi_{\text{ref}})\right)^{-1}+\d\alpha(\xi_{\text{ref}})\left(\Psi^{\prime}(\xi_{\text{ref}})\right)^{-1}\label{eq:var-al-verstaerkung1-z}
\end{equation}

\end_inset

gewählt werden.
 Der erste Summand hat in Originalkoordinaten die Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-x"

\end_inset

.
 Zur Bestimmung des zweiten Summanden betrachten wir die Nichtlinearität
\begin_inset space ~
\end_inset


\begin_inset Formula $\alpha$
\end_inset

 in Originalkoordinaten:
\begin_inset Formula 
\[
\begin{array}{ccl}
\alpha(\xi) & = & L_{f}^{n}h(x)\\
 & = & \left\langle \d L_{f}^{n-1}h,f\right\rangle (x)\\
 & = & \left\langle L_{f}^{n-1}\d h,f\right\rangle (x)\\
 & = & \left\langle L_{f}^{n-1}\omega,f\right\rangle (x).
\end{array}
\]

\end_inset

Damit lässt sich der Gradient
\begin_inset space ~
\end_inset


\begin_inset Formula $\d\alpha$
\end_inset

 wie folgt darstellen:
\begin_inset Formula 
\[
\begin{array}{ccl}
\d\alpha(\xi) & = & \frac{\partial\left\langle L_{f}^{n-1}\omega,f\right\rangle (x)}{\partial x}\cdot\frac{\d x}{\d\xi}\\
 & = & \frac{\partial\left\langle L_{f}^{n-1}\omega,f\right\rangle (x)}{\partial x}\cdot\Psi^{\prime}(\xi).
\end{array}
\]

\end_inset

Die Differentiation des Skalarprodukts liefert 
\begin_inset Formula 
\[
\begin{array}{ccl}
\d\alpha(\xi)\left(\Psi^{\prime}(\xi)\right)^{-1} & = & \frac{\partial\left\langle L_{f}^{n-1}\omega,f\right\rangle (x)}{\partial x}\\
 & = & L_{f}^{n-1}\omega(x)f^{\prime}(x)+f^{T}(x)\frac{\partial\left(L_{f}^{n-1}\omega(x)\right)^{T}}{\partial x}\\
 & = & L_{f}^{n-1}\omega(x)f^{\prime}(x)+f^{T}(x)\left(\frac{\partial\left(L_{f}^{n-1}\omega(x)\right)^{T}}{\partial x}\right)^{T}\\
 & = & L_{f}^{n}\omega(x)
\end{array}
\]

\end_inset

unter Beachtung von Prop.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "pro:Ableitungsregeln-Felder"

\end_inset

.
 Dabei wurde zusätzlich ausgenutzt, dass das Kovektorfeld
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

 der Gradient des Skalarfeldes
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

 ist und die Ableitung von 
\begin_inset Formula $L_{f}\omega$
\end_inset

 somit eine Hessematrix darstellt (siehe Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Schwarz"

\end_inset

).
 Aus
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-z"

\end_inset

 ergibt sich somit in Originalkoordinaten die Reglerverstärkung 
\begin_inset Formula 
\begin{equation}
\sigma(x_{\text{ref}})=a_{0}\omega(x_{\text{ref}})+a_{1}L_{f}\omega(x_{\text{ref}})+\cdots+a_{n-1}L_{f}^{n-1}\omega(x_{\text{ref}})+L_{f}^{n}\omega(x_{\text{ref}}).\label{eq:var-al-verstaerkung1-x}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
CK: Ackermann-Formel für LTI einfügen, oder als Übungsaufgabe
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Bemerkungen
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

 kann man als Verallgemeinerung der Ackermann-Formel
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "acker77,ackermann77"

\end_inset

 für nichtlineare Systeme auffassen.
 Im Unterschied zur Ackermann-Formel für lineare zeitvariante Systeme
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "freund71,foellinger78"

\end_inset

, die sich auf das entlang der Referenztrajektorie linearisierte System
 anwenden lässt, kann der hier beschriebene Zugang unmittelbar auf Approximation
en höherer Ordnung erweitert werden.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Inverses-Pendel-Approx-1"

\end_inset

Wir betrachten wiederum das inverse Pendel aus den Beispielen
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Approx-Exakt"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Approx-0"

\end_inset

.
 Zur Berechnung der Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

 muss man das in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Approx-0"

\end_inset

 verwendete 
\shape smallcaps
Maxima
\shape default
-Skipt nur leicht modifizieren:
\end_layout

\begin_layout Example
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{maxima}
\backslash
input{Inverses_Pendel_Approx_1.tex}
\backslash
end{maxima}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Approximation zweiter Ordnung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Approx-zweiter-Ordnung"

\end_inset


\end_layout

\begin_layout Standard
Die Approximation erster Ordnung wurde in Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Approx-erster-Ordnung"

\end_inset

 über die spezielle Variante
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF-speziell"

\end_inset

 der Regelungsnormalform hergeleitet.
 In ähnlicher Weise lässt sich auch eine Approximation zweiter Ordnung erzielen.
 Allerdings ist auf diesem Weg die Berechnung der Reglerverstärkung vergleichswe
ise aufwendig
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "paschke2011da"

\end_inset

.
 Daher wird nachfolgend ein alternativer Ansatz vorgestellt, bei dem man
 das exakt linearisierende Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-regler-exakt"

\end_inset

 in den Originalkoordinaten entlang der Referenztrajektorie
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 in eine Reihe entwickelt
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "franke2015buch"

\end_inset

.
\end_layout

\begin_layout Standard
Zunächst betrachten wir von der Lie-Ableitung 
\begin_inset Formula $L_{f}h^{k}(x)$
\end_inset

 entlang
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{\text{ref}}$
\end_inset

 eine Reihenentwicklung erster Ordnung
\begin_inset Formula 
\begin{equation}
\begin{array}{ccl}
L_{f}^{k}h(x) & = & L_{f}^{k}h(x_{\text{ref}})+\d L_{f}^{k}h(x_{\text{ref}})\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{2}\right)\\
 & = & L_{f}^{k}h(x_{\text{ref}})+L_{f}^{k}\d h(x_{\text{ref}})\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{2}\right)\\
 & = & L_{f}^{k}h(x_{\text{ref}})+L_{f}^{k}\omega(x_{\text{ref}})\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{2}\right).
\end{array}\label{eq:var-al-reihe-lfh1}
\end{equation}

\end_inset

Setzt man diese Reihenentwicklung in das exakt linearisierende Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-regler-exakt"

\end_inset

 ein, so erhält man
\begin_inset Formula 
\[
\kappa(x)=\sum_{i=0}^{n}a_{i}L_{f}^{i}\omega(x_{\text{ref}})\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{2}\right)={\displaystyle \sigma(x_{\text{ref}})}\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{2}\right)
\]

\end_inset

mit 
\begin_inset Formula $a_{n}=1$
\end_inset

.
 Unter Vernachlässigung des Restgliedes entspricht dieses Ergebnis der Reglerver
stärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

, mit der man eine Approximation erster Ordnung erreicht.
 Erweitert man die Reihenentwicklung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-reihe-lfh1"

\end_inset

 um den nächsten Term zu
\begin_inset Formula 
\[
L_{f}^{k}h(x)=L_{f}^{k}h(x_{\text{ref}})+L_{f}^{k}\omega(x_{\text{ref}})\,\tilde{x}+\frac{1}{2}\tilde{x}^{T}\frac{\partial\left(L_{f}^{k}\omega(x_{\text{ref}})\right)^{T}}{\partial x_{\text{ref}}}\,\tilde{x}+\mathcal{O}\left(\|\tilde{x}\|^{3}\right),
\]

\end_inset

so erhält man das Regelgesetz
\begin_inset Formula 
\begin{equation}
\kappa(x)=\sum_{i=0}^{n}a_{i}\left(L_{f}^{i}\omega(x_{\text{ref}})\,\tilde{x}+\frac{1}{2}\tilde{x}^{T}\frac{\partial\left(L_{f}^{i}\omega(x_{\text{ref}})\right)^{T}}{\partial x_{\text{ref}}}\,\tilde{x}\right)+\mathcal{O}\left(\|\tilde{x}\|^{3}\right),\label{eq:var-al-verstaerkung2-x}
\end{equation}

\end_inset

mit dem eine Approximation zweiter Ordnung erzielt wird.
 Bei der Implementierung des Regelgesetzes entfällt das Restglied.
 Unter Zuhilfenahme von Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

 lässt sich das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung2-x"

\end_inset

 in der Form 
\begin_inset Formula 
\[
\kappa(x)=\sigma(x_{\text{ref}})\tilde{x}+\frac{1}{2}\tilde{x}^{T}\frac{\partial\sigma^{T}(x_{\text{ref}})}{\partial x_{\text{ref}}}\tilde{x}
\]

\end_inset

angeben.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Durchführbarkeit auch ohne Integrabilitätsbedingung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die Herleitung der vorgestellten Regelgesetze beruht auf der speziellen
 Variante
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF-speziell"

\end_inset

 der Regelungsnormalform und setzt daher die Existenzbedingungen nach Satz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Exakte-Eingangs-Zustands-Linearisierung-eingeschraenkt"

\end_inset

 voraus.
 Das bedeutet, dass die Steuerbarkeitsmatrix
\begin_inset space ~
\end_inset


\begin_inset Formula $Q_{S}$
\end_inset

 regulär sein muss und die Differentialform
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

 entsprechend Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-dh-omega"

\end_inset

 als exakt vorausgesetzt wird.
 Die Berechnung der Regelgesetze
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-x"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung2-x"

\end_inset

 ist jedoch auch im Fall einer nicht exakten Differentialform
\begin_inset space ~
\end_inset


\begin_inset Formula $\omega$
\end_inset

 möglich.
 In
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "roebenack2012pamm,roebenack2013ecc"

\end_inset

 wird am Beispiel des nicht eingangs-zustands-linearisierbaren Wagens mit
 Pendel (Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Wagen-mit-Pendel"

\end_inset

) die erfolgreiche Erprobung der Regelgesetze
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung-x"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-al-verstaerkung1-x"

\end_inset

 beschrieben.
\end_layout

\begin_layout Section
Modifizierte optimale Regelung
\begin_inset CommandInset label
LatexCommand label
name "sec:Modifizierte-optimale-Regelung"

\end_inset


\end_layout

\begin_layout Standard
Bei der exakten Linearisierung wird in Kapitel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:regler-grundlagen"

\end_inset

 nach der Kompensation der Nichtlinearitäten die Dynamik des resultierenden
 linearen Systems durch ein gegebenes charakteristischen Polynom und damit
 letztlich durch Eigenwertplazierung vorgegeben.
 In diesem Abschnitt werden mit der exakten Eingangs-Zustands-Linearisierung
 bzw.
 der damit verbundenen Regelungsnormalform zwei alternative Rückführungen
 auf Basis der optimalen Regelung vorgestellt.
\end_layout

\begin_layout Subsection
Optimale Regelung
\end_layout

\begin_layout Standard
Zunächst erfolgt eine kurze Beschreibung des Optimalsteuerproblems nach
 Bellman für eingangsaffine Eingrößensysteme
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sontag98"

\end_inset

.
 Anschließend wird der Spezialfall einer linear-quadratischen Regelung behandelt
 und auf eingangs-zustands-linearisierbare Systeme angewandt
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "anderson1989"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
...
 im Detail
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Wir betrachten ein nichtlineares Eingrößensystem
\begin_inset Formula 
\begin{equation}
\dot{x}=f(x)+g(x)u\label{eq:basissystem-optimierung}
\end{equation}

\end_inset

mit hinreichend glatten Vektorfeldern 
\begin_inset Formula $f,g:\R^{n}\to\R^{n}$
\end_inset

, die auf ganz
\begin_inset space ~
\end_inset


\begin_inset Formula $\R^{n}$
\end_inset

 definiert sind.
 Das System habe für 
\begin_inset Formula $u=0$
\end_inset

 eine Ruhelage im Ursprung 
\begin_inset Formula $x=0$
\end_inset

, d.
\begin_inset space \thinspace{}
\end_inset

h.
 es gilt 
\begin_inset Formula $f(0)=0$
\end_inset

.
 Gesucht ist eine Zustandsrückführung
\begin_inset Formula 
\begin{equation}
u=-\kappa(x)\label{eq:opt-kappa}
\end{equation}

\end_inset

mit dem Skalarfeld 
\begin_inset Formula $\kappa:\R^{n}\to\R$
\end_inset

, so dass das Kostenfunktional
\begin_inset Formula 
\begin{equation}
J=\int_{0}^{\infty}\left[q(x)+p(x)u^{2}\right]\d t\label{eq:opt-Kosten-nl}
\end{equation}

\end_inset

minimiert wird.
 Für die Funktionen 
\begin_inset Formula $q:\R^{n}\to\R$
\end_inset

 und 
\begin_inset Formula $p:\R^{n}\to\R$
\end_inset

 werden dabei die Bedingungen 
\begin_inset Formula $q(x)\geq0$
\end_inset

 und 
\begin_inset Formula $p(x)>0$
\end_inset

 für alle 
\begin_inset Formula $x\in\R^{n}$
\end_inset

 vorausgesetzt.
 Das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-kappa"

\end_inset

 ergibt sich nach dem Optimalitätsprinzip von Bellman
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sontag98"

\end_inset

 aus der Lösung von
\begin_inset Formula 
\begin{equation}
\min_{u}\{\underbrace{q(x)+p(x)u^{2}+V^{\prime}(x)\left(f(x)+g(x)u\right)}_{{\displaystyle =:\mu(x,u)}}\}=0.\label{eq:opt-Bellman}
\end{equation}

\end_inset

Zur Bestimmung eines lokalen Extremums wird der Term
\begin_inset space ~
\end_inset


\begin_inset Formula $\mu$
\end_inset

 nach dem Argument
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 differenziert und zu Null gesetzt:
\begin_inset Formula 
\begin{equation}
\frac{\partial\mu(x,u)}{\partial u}=2p(x)u+L_{g}V(x)\stackrel{!}{=}0.\label{eq:opt-notwendige-bedingung}
\end{equation}

\end_inset

Wegen 
\begin_inset Formula 
\[
\frac{\partial^{2}\mu(x,u)}{\partial u^{2}}=2p(x)>0
\]

\end_inset

liegt ein Minimum vor.
 Aus
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-notwendige-bedingung"

\end_inset

 erhält man den Eingang
\begin_inset Formula 
\begin{equation}
u=-\frac{1}{2p(x)}\,L_{g}V(x).\label{eq:opt-u-Regelgesetz}
\end{equation}

\end_inset

Setzt man diesen Eingang in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Bellman"

\end_inset

 ein, so erhält man die Gleichung
\begin_inset Formula 
\begin{equation}
q(x)+L_{f}V(x)-\frac{1}{4p(x)}\left[L_{g}V(x)\right]^{2}=0,\label{eq:HJB}
\end{equation}

\end_inset

die bezüglich einer stetig differenzierbaren, positiv definiten Funktion
 
\begin_inset Formula $V:\R^{n}\to\R$
\end_inset

 zu lösen ist
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
after "Abschnitt~{8.5}"
key "sontag98"

\end_inset

.
 Diese Gleichung stellt eine Variante der 
\emph on
Hamilton-Jacobi-Bellman-Gleichung
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Hamilton-Jacobi-Bellman-Gleichung
\end_layout

\end_inset

 dar
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sepulchre97"

\end_inset

.
 Falls eine derartige Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

, die man 
\emph on
Bellman-Funktion
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Bellman-Funktion
\end_layout

\end_inset

 oder 
\emph on
Wertfunktion
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Wertfunktion
\end_layout

\end_inset

 (engl.
 
\emph on
value function
\emph default
) nennt, existiert, hat die Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-kappa"

\end_inset

 nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-u-Regelgesetz"

\end_inset

 die Form
\begin_inset Formula 
\begin{equation}
\kappa(x)=\frac{1}{2p(x)}\,L_{g}V(x).\label{eq:opt-LgV-Regelgesetz}
\end{equation}

\end_inset

Wird die Ruhelage 
\begin_inset Formula $x=0$
\end_inset

 durch die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LgV-Regelgesetz"

\end_inset

 asymptotisch stabil, dann minimiert das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LgV-Regelgesetz"

\end_inset

 auch das Kostenfunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

, siehe
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
after "Theorem~{3.19}"
key "sepulchre97"

\end_inset

.
 Die Bellman-Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 ist in diesem Fall zugleich eine Ljapunov-Funktion für das rückgeführte
 System, also für den geschlossenen Regelkreis (siehe Anhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Stabilitaet-autonomer-Systeme"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Lösung HJB, partielle Dgl.
 ...
\end_layout

\end_inset


\end_layout

\begin_layout Remark
Die Hamilton-Jacobi-Bellman-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HJB"

\end_inset

 ist eine partielle Differentialgleichung, deren Lösung nur in Ausnahmefällen
 symbolisch angegeben werden kann.
 Für eine numerische Lösung geht man von dem unendlichen Zeitintervall 
\begin_inset Formula $[0,\infty)$
\end_inset

 beim Kostenfunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

 zu einem endlichen Zeitintervall 
\begin_inset Formula $[0,T]$
\end_inset

 mit 
\begin_inset Formula $T>0$
\end_inset

 über.
 Löst man zur Berechnung des Regelgesetzes für einen Zeitpunkt
\begin_inset space ~
\end_inset


\begin_inset Formula $t$
\end_inset

 jeweils ein Optimierungsproblem mit gleitendem Zeitintervall 
\begin_inset Formula $[t,t+T]$
\end_inset

, dann spricht man von einer 
\emph on
(nichtlinearen) modellprädiktiven Regelung
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
modellprädiktive Regelung
\end_layout

\end_inset

 (engl.
 
\emph on
nonlinear model predictive control
\emph default
, kurz 
\emph on
NMPC
\emph default
), siehe z.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
,
\end_layout

\end_inset

B.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "graichen2010nmpc,allgower2012nonlinear"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Lineares System
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Als Spezialfall betrachte man ein lineares zeitinvariantes System 
\begin_inset Formula 
\begin{equation}
\dot{x}=Ax+bu\label{eq:var-opt-LTI}
\end{equation}

\end_inset

mit 
\begin_inset Formula $A\in\R^{n\times n}$
\end_inset

 und 
\begin_inset Formula $b\in\R^{n}$
\end_inset

.
 Gesucht ist die Reglerverstärkung 
\begin_inset Formula $k\in\R^{n}$
\end_inset

 einer Zustandsrückführung
\begin_inset Formula 
\begin{equation}
u=-k^{T}x,\label{eq:opt-k}
\end{equation}

\end_inset

welche das quadratische Kostenfunktional
\begin_inset Formula 
\begin{equation}
J=\int_{0}^{\infty}\left[x^{T}Qx+Ru^{2}\right]\d t\label{eq:opt-quadr-kosten}
\end{equation}

\end_inset

mit einer positiv semidefiniten Matrix 
\begin_inset Formula $Q\in\R^{n\times n}$
\end_inset

 und einer positiven Zahl 
\begin_inset Formula $R>0$
\end_inset

 minimiert.
 Für die Lösung der Hamilton-Jacobi-Bellman-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HJB"

\end_inset

 setzen wir die Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 als quadratische Form 
\begin_inset Formula 
\[
V(x)=x^{T}Px
\]

\end_inset

mit einer (noch festzulegenden) positiv definiten Matrix 
\begin_inset Formula $P\in\R^{n\times n}$
\end_inset

 an (siehe Anhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Stabilitaet-autonomer-Systeme"

\end_inset

).
 Für das lineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-LTI"

\end_inset

, welches durch die Vektorfelder 
\begin_inset Formula $f(x)=Ax$
\end_inset

 und 
\begin_inset Formula $g(x)=b$
\end_inset

 beschrieben wird, erhält man die Lie-Ableitungen
\begin_inset Formula 
\begin{equation}
L_{f}V(x)=x^{T}\left(A^{T}P+PA\right)x\quad\text{und}\quad L_{g}V(x)=2x^{T}Pb.\label{eq:var-opt-Lf-Lg-V}
\end{equation}

\end_inset

Damit lässt sich die Hamilton-Jacobi-Bellman-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HJB"

\end_inset

 in der Form
\begin_inset Formula 
\begin{equation}
x^{T}\left(A^{T}P+PA-PbR^{-1}b^{T}P+Q\right)x=0\label{eq:HJB-ARE}
\end{equation}

\end_inset

angeben.
 Diese Gleichung ist für alle 
\begin_inset Formula $x\in\R^{n}$
\end_inset

 gelöst, wenn die 
\emph on
algebraische Riccati-Gleichung
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Riccati-Gleichung
\end_layout

\end_inset

 (engl.
 
\emph on
algebraic Riccati equation
\emph default
, kurz 
\emph on
ARE
\emph default
) 
\begin_inset Formula 
\begin{equation}
A^{T}P+PA-PbR^{-1}b^{T}P+Q=0\label{eq:var-opt-ARE}
\end{equation}

\end_inset

eine Lösung 
\begin_inset Formula $P\in\R^{n\times n}$
\end_inset

 besitzt.
 Ist das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-LTI"

\end_inset

, welches durch das Paar 
\begin_inset Formula $(A,b)$
\end_inset

 beschrieben wird, steuerbar und ist für eine Zerlegung 
\begin_inset Formula $Q=C^{T}C$
\end_inset

 das Paar 
\begin_inset Formula $(A,C)$
\end_inset

 beobachtbar
\begin_inset Foot
status open

\begin_layout Plain Layout
Tatsächlich besitzt die algebraische Riccati-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

 auch unter der schwächeren Voraussetzung, dass 
\begin_inset Formula $(A,b)$
\end_inset

 stabilisierbar und 
\begin_inset Formula $(A,C)$
\end_inset

 ermittelbar
\begin_inset Index idx
status open

\begin_layout Plain Layout
ermittelbar
\end_layout

\end_inset

 ist, eine positiv definite Lösung.
 Im Fall einer positiv definiten Matrix
\begin_inset space ~
\end_inset


\begin_inset Formula $Q$
\end_inset

 ist 
\begin_inset Formula $(A,C)$
\end_inset

 beobachtbar und damit auch ermittelbar.
\end_layout

\end_inset

, dann existiert eine positiv definite Lösung 
\begin_inset Formula $P\succ0$
\end_inset

 von Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

, siehe
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "anderson1989,ludyk1995-2,lunze-rt2"

\end_inset

.
 Für die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-k"

\end_inset

 ergibt sich die Reglerverstärkung aus
\begin_inset Formula 
\begin{equation}
k^{T}=R^{-1}b^{T}P.\label{eq:var-opt-k}
\end{equation}

\end_inset

Mit dieser Reglerverstärkung für das lineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-LTI"

\end_inset

 wird das quadratische Kostenfunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-quadr-kosten"

\end_inset

 minimiert.
 Man spricht dabei von einem 
\emph on
linear-quadratischen Regler
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Regler!linear-quadratischer
\end_layout

\end_inset

 (kurz 
\emph on
LQ-Regler
\emph default
, engl.
 
\emph on
linear quadratic regulator
\emph default
, kurz 
\emph on
LQR
\emph default
).
 Die Systemmatrix des geschlossenen Regelkreises 
\begin_inset Formula 
\[
\dot{x}=\left(A-bR^{-1}b^{T}P\right)x
\]

\end_inset

besitzt in diesem Fall nur Eigenwerte mit negativem Realteil, so dass die
 Ruhelage 
\begin_inset Formula $x=0$
\end_inset

 exponentiell (und damit asymptotisch) stabil ist.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Anwendung auf E/Z-Linearisierung
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Angenommen, das nichtlineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-basissystem-ohne-ausgang"

\end_inset

 ist eingangs-zustands-linearisierbar, d.
\begin_inset space \thinspace{}
\end_inset

h.
 es existiert eine Ausgangsabbildung 
\begin_inset Formula $h:\R^{n}\to\R$
\end_inset

, mit der das System den relativen Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $n$
\end_inset

 besitzt.
 Dann existiert eine Koordinatentransformation 
\begin_inset Formula $\xi=\Phi(x)$
\end_inset

, die das System in die Regelungsnormalform
\begin_inset Formula 
\begin{equation}
\dot{\xi}=A\xi+b\left(\alpha(\xi)+\beta(\xi)u\right)\label{eq:var-opt-RNF}
\end{equation}

\end_inset

überführt, siehe Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-Regelungs-NF"

\end_inset

.
 Nach der Kompensation der Nichtlinearitäten durch
\begin_inset Formula 
\begin{equation}
u=\frac{1}{\beta(\xi)}\left(v-\alpha(\xi)\right)=\frac{1}{L_{g}L_{f}^{n-1}h(x)}\left(v-L_{f}^{n}h(x)\right)\label{eq:opt-rueck-linearisierend}
\end{equation}

\end_inset

erhält man das lineare steuerbare System 
\begin_inset Formula 
\begin{equation}
\dot{\xi}=A\xi+bv\label{eq:opt-linearisiertes-system}
\end{equation}

\end_inset

mit dem Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $v$
\end_inset

.
 Für dieses System kann man einen linear-quadratischen Regler entwerfen,
 wobei das Kostenfunktional direkt in 
\begin_inset Formula $\xi$
\end_inset

-Koordinaten angesetzt wird.
 Zu einer Matrix 
\begin_inset Formula $Q\succeq0$
\end_inset

 und einer Zahl 
\begin_inset Formula $R>0$
\end_inset

 löst man die algebraische Riccatigleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

, wobei das Paar 
\begin_inset Formula $(A,b)$
\end_inset

 in der Brunovský-Normalform
\begin_inset Index idx
status open

\begin_layout Plain Layout
Normalform!Brunovský-
\end_layout

\end_inset

 vorliegt.
 Mit der Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset Formula $k$
\end_inset

 nach Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-k"

\end_inset

 und der stabiliserenden Rückführung 
\begin_inset Formula $v=-k^{T}\xi$
\end_inset

 erhält man insgesamt die Zustandsrückführung
\begin_inset Formula 
\begin{equation}
\begin{array}{ccl}
u & = & -\frac{1}{\beta(\xi)}\left(\alpha(\xi)+k^{T}\xi\right)\\
 & = & -\frac{1}{L_{g}L_{f}^{n-1}h(x)}\left(L_{f}^{n}h(x)+k^{T}\Phi(x)\right)\\
 & = & -\frac{1}{L_{g}L_{f}^{n-1}h(x)}\left(L_{f}^{n}h(x)+\sum_{i=0}^{n-1}k_{i+1}L_{f}^{i}h(x)\right).
\end{array}\label{eq:opt-LQR-EZ-lin}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Hinsichtlich der Struktur stimmt die Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 vollständig mit der des stabilisierenden Regelgesetzes aus Kapitel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:regler-grundlagen"

\end_inset

 überein.
 Der beschriebene Ansatz wird beispielsweise in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "palis2008"

\end_inset

 zur Regelung eines Magnet\SpecialChar softhyphen
lagers verwendet, wobei die in Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 benötigten Lie-Ableitungen mit Hilfe des algorithmischen Differenzierens
 berechnet werden.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel, Inverses_Pendel_Inv_Opt.wxmx, Inverses_Pendel_Inv_Opt.sce 
\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Inverses-Pendel-Motor-LQR"

\end_inset

Das inverse Pendel mit Gleichstromantrieb aus Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:inverses-pendel-gleichstrommotor"

\end_inset

 wird durch das nichtlineare Zustandsraummodell
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
\dot{x}_{1} & = & x_{2}\\
\dot{x}_{2} & = & \frac{mg\ell}{J}\sin x_{1}-\frac{d}{J}x_{2}+\frac{K}{J}x_{3}\\
\dot{x}_{3} & = & -\frac{K}{L}x_{2}-\frac{R}{L}x_{3}+\frac{1}{L}u\\
y & = & x_{1}
\end{array}\label{eq:opt-inverses-pendel-motor}
\end{equation}

\end_inset

beschrieben.
 Für den angegebenen Ausgang besitzt das System den relativen Grad 
\begin_inset Formula $r=n=3$
\end_inset

.
 Unter Zuhilfsnahme der Lie-Ableitungen 
\begin_inset Formula 
\begin{equation}
\begin{array}{lcl}
h(x) & = & x_{1}\\
L_{f}h(x) & = & x_{2}\\
L_{f}^{2}h(x) & = & \frac{-d{\it x_{2}}+mg\ell\sin{\it x_{1}}+K{\it x_{3}}}{J}\\
L_{f}^{3}h(x) & = & -\frac{JK^{2}x_{2}+\left(dKx_{3}-mg\ell Jx_{2}\cos x_{1}+dmg\ell\sin x_{1}-d^{2}x_{2}\right)L+JKRx_{3}}{J^{2}L}\\
L_{g}L_{f}^{2}h(x) & = & \frac{K}{JL}
\end{array}\label{eq:opt-inv-pendel-motor-lie}
\end{equation}

\end_inset

kann man das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-inverses-pendel-motor"

\end_inset

 mittels Zustandstransformation und Rückführung in die Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-linearisiertes-system"

\end_inset

 überführen.
 Das Paar 
\begin_inset Formula $(A,b)$
\end_inset

 liegt dabei in der Brunovský-Normalform vor.
 Für das Gütefunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-quadr-kosten"

\end_inset

 geben wir 
\begin_inset Formula $Q=I_{3}$
\end_inset

 und 
\begin_inset Formula $R=1$
\end_inset

 vor.
 Der LQR-Entwurf ist beispielsweise mit dem Programm 
\shape smallcaps
Scilab
\shape default

\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "scilabhomepage"

\end_inset

 möglich:
\end_layout

\begin_layout Example
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{maxima}
\backslash
input{LQR.sce}
\backslash
end{maxima}
\end_layout

\end_inset


\end_layout

\begin_layout Example
Damit erhält man die positiv definite Matrix
\begin_inset Formula 
\begin{equation}
P\approx\left(\begin{array}{ccc}
2,4142136 & 2,4142136 & 1\\
2,4142136 & 4.8284271 & 2,4142136\\
1 & 2,4142136 & 2,4142136
\end{array}\right)\label{eq:opt-inv-pendel-motor-P}
\end{equation}

\end_inset

als Lösung der Riccati-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

 und die Reglerverstärkung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-k"

\end_inset

 mit
\begin_inset Formula 
\[
k^{T}=\left(\begin{array}{ccc}
k_{1} & k_{2} & k_{3}\end{array}\right)\approx\left(\begin{array}{ccc}
1 & 2,4142136 & 2,4142136\end{array}\right),
\]

\end_inset

so dass man mit
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-inv-pendel-motor-lie"

\end_inset

 das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 implementieren kann.
 
\end_layout

\begin_layout Example
Für die numerische Simulation kommen die in
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "gomez1994"

\end_inset

 verwendeten (normierten) Paramterwerte 
\begin_inset Formula $R=1$
\end_inset

, 
\begin_inset Formula $L=0.002$
\end_inset

, 
\begin_inset Formula $K=10$
\end_inset

, 
\begin_inset Formula $J=4$
\end_inset

, 
\begin_inset Formula $d=1$
\end_inset

, 
\begin_inset Formula $l=1$
\end_inset

 und 
\begin_inset Formula $mg=20$
\end_inset

 zum Einsatz.
 Der Anfangswert 
\begin_inset Formula $x(0)=(\pi/6,0,0)^{T}$
\end_inset

 entspricht einer Anfangsauslenkung des Pendels um 
\begin_inset Formula $30\text{°}$
\end_inset

.
 Abb.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:opt-inv-pendel-motor-lqr"

\end_inset

 zeigt das Einschwingverhalten des geregelten Systems.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Inv_Pendel_Motor_LQR.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Einschwingverhalten des durch LQR-Entwurf in den transformierten Koordinaten
 geregelten Pendels
\begin_inset CommandInset label
LatexCommand label
name "fig:opt-inv-pendel-motor-lqr"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sontag-Formel
\end_layout

\begin_layout Standard
Die Optimalität des im vorangegangenen Abschnitt hergeleiteten Regelgesetzes
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 hinsichtlich eines quadratischen Gütekriteriums bezieht sich allerdings
 nicht auf das Originalsystem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

, sondern auf das transformierte und durch die Rückführung linearisierte
 System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-linearisiertes-system"

\end_inset

.
 In den Originalkoordinaten ist das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 in der Regel keine Lösung eines Optimierungsproblems
\begin_inset Foot
status open

\begin_layout Plain Layout
Die Aussage, dass das Regelgesetz
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 in der Regel nicht optimal im Sinne eines Kostenfunktionals
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

 ist, lässt dadurch veranschaulichen, dass die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LQR-EZ-lin"

\end_inset

 alle im System auftretenden Nichtlinearitäten kompensiert, auch jene, die
 die Stabilität begünstigen.
\end_layout

\end_inset

 mit einem Kostenfunktional der Form
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

.
 In diesem Abschnitt wird ein Regelgesetz angegeben, welches das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 stabilisiert und zugleich Lösung eines Optimierungsproblems ist.
 Dieser Zugang ist unter der Bezeichnung 
\emph on
invers-optimale
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
invers-optimale Regelung
\end_layout

\end_inset

 oder 
\emph on
modifizierte optimale Regelung
\emph default
 
\begin_inset Index idx
status open

\begin_layout Plain Layout
modifizierte optimale Regelung
\end_layout

\end_inset

 bekannt
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "freeman96control,freeman96siam,freeman1996buch,sepulchre97,sackmann2005modifizierte"

\end_inset

.
\end_layout

\begin_layout Standard
Zunächst verallgemeinern wir den Begriff der Ljapunov-Funktion auf Systeme
 mit Erregung.
 Sei 
\begin_inset Formula $V:\R^{n}\to\R$
\end_inset

 eine stetig differenzierbare, positiv definite Funktion (siehe Anhang
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Stabilitaet-autonomer-Systeme"

\end_inset

).
 Die Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 nennt man 
\emph on
Regelungs-Ljapunov-Funktion
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Regelungs-Ljapunov-Funktion
\end_layout

\end_inset

 (engl.
 
\emph on
control Lyapunov function
\emph default
, kurz 
\emph on
CLF
\emph default
) von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

, falls
\begin_inset Formula 
\begin{equation}
\forall x\neq0:\quad\inf_{u}\left(L_{f}V(x)+L_{g}V(x)u\right)<0.\label{eq:CLF-def1}
\end{equation}

\end_inset

Mit der Existenz einer Regelungs-Ljapunov-Funktion gibt es auch eine stabilisier
ende Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "artstein1983"

\end_inset

:
\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout

[Theorem von Artstein]
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "thm:Artstein"

\end_inset

Man betrachte das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 mit 
\begin_inset Formula $f(0)=0$
\end_inset

.
 Ferner sei
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 eine Regelungs-Ljapunov-Funktion.
 Dann gibt es eine Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-kappa"

\end_inset

 derart, dass 
\begin_inset Formula $x=0$
\end_inset

 eine asymptotisch stabile Ruhelage des geschlossenen Regelkreises ist.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{proofsketch}
\end_layout

\end_inset

Sie
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 eine Regelungs-Ljapunov-Funktion von System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

.
 Die Zeitableitung von
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 entlang der Systemdynamik von
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 hat die Form
\begin_inset Formula 
\begin{equation}
\begin{array}{ccl}
\dot{V}(x) & = & V^{\prime}(x)\cdot\dot{x}\\
 & = & V^{\prime}(x)\cdot f(x)+g(x)u\\
 & = & L_{f}V(x)+L_{g}V(x)u.
\end{array}\label{eq:opt-Vdot1}
\end{equation}

\end_inset

Bedingung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CLF-def1"

\end_inset

 bedeutet, dass man den Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 in Abhängigkeit vom Zustand
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

 immer so wählen kann, dass
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{V}$
\end_inset

 negativ definit ist.
 Damit ist
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 eine Ljapunov-Funktion des in dieser Weise rückgeführten Systems und die
 Ruhelage 
\begin_inset Formula $x=0$
\end_inset

 ist asymptotisch stabil.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{proofsketch}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die Bedingung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CLF-def1"

\end_inset

 ist gleichwertig mit 
\begin_inset Formula 
\begin{equation}
L_{g}V(x)=0\quad\Longrightarrow\quad L_{f}V(x)<0.\label{eq:CLF-def2}
\end{equation}

\end_inset

In den Punkten
\begin_inset space ~
\end_inset


\begin_inset Formula $x$
\end_inset

, wo die Ableitung
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{V}$
\end_inset

 wegen 
\begin_inset Formula $L_{g}V(x)=0$
\end_inset

 nicht über den Eingang
\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

 beeinflusst werden kann, muss das Vektorfeld
\begin_inset space ~
\end_inset


\begin_inset Formula $f$
\end_inset

 einen Beitrag zur Stabilität liefern.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Stabilisierung mit Sontags Formel
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Kennt man zu einem gegebenen System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 eine Regelungs-Lyapunov-Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

, dann stellt die 
\emph on
Sontag-Formel
\emph default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Sontag-Formel
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sontag89,sontag98"

\end_inset


\begin_inset Formula 
\begin{equation}
u=-\kappa(x)=\left\{ \begin{array}{ccc}
-\frac{L_{f}V(x)+\sqrt{\left[L_{f}V(x)\right]^{2}+\left[L_{g}V(x)\right]^{4}}}{L_{g}V(x)} & \text{falls} & L_{g}V(x)\neq0\\
0 & \text{falls} & L_{g}V(x)=0
\end{array}\right.\label{eq:sontag-formel}
\end{equation}

\end_inset

eine stabilisierende Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-kappa"

\end_inset

 bereit.
 Setzt man
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 in das System ein, dann ergibt sich aus
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Vdot1"

\end_inset

 die Zeitableitung
\begin_inset Formula 
\[
\dot{V}(x)=\left\{ \begin{array}{ccc}
-\sqrt{\left[L_{f}V(x)\right]^{2}+\left[L_{g}V(x)\right]^{4}} & \text{falls} & L_{g}V(x)\neq0,\\
L_{f}V(x) & \text{falls} & L_{g}V(x)=0.
\end{array}\right.
\]

\end_inset

Dadurch ist
\begin_inset space ~
\end_inset


\begin_inset Formula $\dot{V}$
\end_inset

 negativ definit und die Ruhelage 
\begin_inset Formula $x=0$
\end_inset

 des geschlossenen Regelkreis asymptotisch stabil.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Inverse Optimalität, Abschätzung: Sontag_Inv_Opt.wxmx
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Mit der Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 stabilisiert man nicht nur das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

, sondern minimiert auch ein Kostenfunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

.
 Stellt man die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-LgV-Regelgesetz"

\end_inset

 nach der Wichtungsfunktion
\begin_inset space ~
\end_inset


\begin_inset Formula $p$
\end_inset

 um, so erhält man 
\begin_inset Formula 
\begin{equation}
p(x)=\frac{1}{2\kappa(x)}\,L_{g}V(x).\label{eq:inv-opt-p}
\end{equation}

\end_inset

Durch Einsetzen dieser Funktion in die Hamilton-Jacobi-Bellman-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HJB"

\end_inset

 bekommt man die zweite Wichtungsfunktion:
\begin_inset Formula 
\begin{equation}
q(x)=\frac{1}{4p(x)}\left(L_{g}V(x)\right)^{2}-L_{f}V(x).\label{eq:inv-opt-q}
\end{equation}

\end_inset

Damit ist
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 die Lösung des durch das Kostenfunktional
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-Kosten-nl"

\end_inset

 mit
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inv-opt-p"

\end_inset

 und
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inv-opt-q"

\end_inset

 beschriebenen Optimierungsproblems.
 Die zur Stabiliserung herangezogene Regelungs-Ljapunov-Funktion
\begin_inset space ~
\end_inset


\begin_inset Formula $V$
\end_inset

 ist dann auch die zugehörige Bellman-Funktion.
 Die unterschiedlichen Herangehensweisen bei der optimalen bzw.
 der invers-optimalen Regelung werden im nachfolgenden Diagramm veranschaulicht:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
[
\end_layout

\begin_layout Plain Layout


\backslash
begin{CD}
\end_layout

\begin_layout Plain Layout


\backslash
text{Kostenfunktional} @.
 
\backslash
text{Kostenfunktional}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

@V{
\backslash
text{Gl.~
\backslash
eqref{eq:HJB}}}VV @ AA{
\backslash
text{Gln.~
\backslash
eqref{eq:inv-opt-p}, 
\backslash
eqref{eq:inv-opt-q}}}A
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
text{Bellman-Funktion}~V @= 
\backslash
text{Regelungs-Ljapunov-Funktion}~V
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

@V{
\backslash
text{Gl.~
\backslash
eqref{eq:opt-LgV-Regelgesetz}}}VV @VV{
\backslash
text{Gl.~
\backslash
eqref{eq:sontag-formel}}}V
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
text{Regelgesetz} @.
 
\backslash
text{Regelgesetz}
\end_layout

\begin_layout Plain Layout


\backslash
end{CD}
\end_layout

\begin_layout Plain Layout


\backslash
]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Eine wichtige Konsequenz aus der Optimalität der Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 ist die Robustheit des so geregelten System
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "freeman96control,freeman96siam,sepulchre97"

\end_inset

.
 Von der Sontag-Formel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 wurden auch zahlreiche Abwandlungen entwickelt bzw.
 erprobt
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "lin1991,malisoff2000scl,yu2001"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Anwendung auf EZ-linearisierbare Systeme
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In der Regel ist es sehr schwierig, für ein gegebenes System eine Regelungs-Ljap
unov-Funktion zu finden.
 Ist das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 eingangs-zustands-linearisierbar, dann kann es durch die Rückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-rueck-linearisierend"

\end_inset

 in das lineare System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-linearisiertes-system"

\end_inset

 überführt werden.
 Zu diesem System berechnet man für eine gegebene Matrix 
\begin_inset Formula $Q\succeq0$
\end_inset

 und eine Zahl 
\begin_inset Formula $R>0$
\end_inset

 eine positiv definite Lösung 
\begin_inset Formula $P\succ0$
\end_inset

 der algebraischen Riccati-Gleichung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

.
 Damit erhält man in den transformierten Koordinaten die Bellman-Funktion
 
\begin_inset Formula $\widetilde{V}(\xi)=\xi^{T}P\xi$
\end_inset

.
 Diese ist zugleich eine Regelungs-Ljapunov-Funktion des linearisierten
 Systems
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-linearisiertes-system"

\end_inset

, denn über die Rückführung 
\begin_inset Formula $v=-k^{T}\xi$
\end_inset

 mit
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-k"

\end_inset

 erhält man eine asymptotisch stabile Ruhelage 
\begin_inset Formula $\xi=0$
\end_inset

.
 Daraus ergibt sich in Originalkoordinaten die Regelungs-Ljapunov-Funktion
\begin_inset Formula 
\begin{equation}
V(x)=\widetilde{V}(\Phi(x))=\Phi^{T}(x)\,P\,\Phi(x).\label{eq:inv-opt-CLF-EZ}
\end{equation}

\end_inset

Mit der durch die Sontag-Formel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 gegebenen Rückführung erhält man ein robustes Regelgesetz.
 
\end_layout

\begin_layout Standard
Bei einem gegebenen System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 lässt sich das Vorgehen zum Entwurf der beschriebenen invers-optimalen
 Regelung folgendermaßen zusammenfassen:
\end_layout

\begin_layout Enumerate
Bestimmung einer Ausgangsabbildung
\begin_inset space ~
\end_inset


\begin_inset Formula $h$
\end_inset

, für die das System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basissystem-optimierung"

\end_inset

 den relativen Grad
\begin_inset space ~
\end_inset


\begin_inset Formula $n$
\end_inset

 besitzt (siehe Abschnitt
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exakte-Eingangs-Zustands-Linearisierung"

\end_inset

).
\end_layout

\begin_layout Enumerate
Berechnung der Lie-Ableitungen 
\begin_inset Formula $L_{f}h(x),\ldots L_{f}^{n-1}h(x)$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Berechnung einer positiv definiten Lösung
\begin_inset space ~
\end_inset


\begin_inset Formula $P$
\end_inset

 der algebraischen Riccati-Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:var-opt-ARE"

\end_inset

 für das linearisierte System
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-linearisiertes-system"

\end_inset

, z.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
,
\end_layout

\end_inset

B.
 mit 
\begin_inset Formula $Q=I$
\end_inset

 und 
\begin_inset Formula $R=1$
\end_inset

.
\end_layout

\begin_layout Enumerate
Berechnung der Regelungs-Ljapunov-Funktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inv-opt-CLF-EZ"

\end_inset

 mit 
\begin_inset Formula $\xi_{1}=h(x),\ldots,\xi_{n}=L_{f}^{n-1}h(x)$
\end_inset

.
\end_layout

\begin_layout Enumerate
Berechnung der Lie-Ableitungen 
\begin_inset Formula $L_{f}V(x)$
\end_inset

 und 
\begin_inset Formula $L_{g}V(x)$
\end_inset

.
\end_layout

\begin_layout Enumerate
Berechnung der Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Die Vorgehensweise zur Nutzung der Sontag-Formel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 für eingangs-zustands-linearisierbare Systeme wird an einem Beispiel vorgestell
t:
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Beispiel, Inverses_Pendel_Inv_Opt.wxmx, Inverses_Pendel_Inv_Opt.sce 
\end_layout

\end_inset


\end_layout

\begin_layout Example
Wir betrachten das bereits in Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Motor-LQR"

\end_inset

 behandelte inverse Pendel mit Gleichstrommotor.
 Aus
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-inv-pendel-motor-lie"

\end_inset

 liest man die Koordinatentransformation 
\begin_inset Formula 
\[
\Phi(x)=\left(\begin{array}{c}
h(x)\\
L_{f}h(x)\\
L_{f}^{2}h(x)
\end{array}\right)=\left(\begin{array}{c}
x_{1}\\
x_{2}\\
\frac{-d{\it x_{2}}+mg\ell\sin{\it x_{1}}+K{\it x_{3}}}{J}
\end{array}\right)
\]

\end_inset

ab.
 Zusammen mit der Matrix
\begin_inset space ~
\end_inset


\begin_inset Formula $P$
\end_inset

 aus Gl.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:opt-inv-pendel-motor-P"

\end_inset

 erhält man die Regelungs-Ljapunov-Funktion
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:inv-opt-CLF-EZ"

\end_inset

, mit deren Hilfe man die Zustandsrückführung
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sontag-formel"

\end_inset

 angeben kann.
 Zu Beginn der Simulation wird die Zustandskomponente
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{3}$
\end_inset

 sehr stark beeinflusst, so dass sie fast unmitelbar von 
\begin_inset Formula $x_{3}(0)=0$
\end_inset

 auf den Wert von ca.
 
\begin_inset Formula $1,09$
\end_inset

 übergeht.
 Bezogen auf die eigentliche Regelgröße
\begin_inset space ~
\end_inset


\begin_inset Formula $x_{1}$
\end_inset

 ist im Unterschied zu Beispiel
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Inverses-Pendel-Motor-LQR"

\end_inset

 kein Überschwingen zu erkennen.
\end_layout

\begin_layout Example
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Inv_Pendel_Motor_Sontag.svg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Einschwingverhalten des mit Hilfe der Sontag-Formel geregelten Pendels
\begin_inset CommandInset label
LatexCommand label
name "fig:opt-inv-pendel-motor-sontag"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "dynamic"
options "babalpha"

\end_inset


\end_layout

\end_body
\end_document
